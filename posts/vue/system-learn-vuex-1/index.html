<!doctype html><html lang=zh-cn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>系统学习 VueX 1 | 隶笔难书</title>
<meta name=keywords content="Vue,VueX"><meta name=description content="Vue 学习笔记-VueX"><meta name=author content="Waite Wang"><link rel=canonical href=https://waite.wang/posts/vue/system-learn-vuex-1/><link crossorigin=anonymous href=/assets/css/stylesheet.1f25c954b6964bfd120383618e0c76f5d98627118274109d51919206cab78c1e.css integrity="sha256-HyXJVLaWS/0SA4Nhjgx29dmGJxGCdBCdUZGSBsq3jB4=" rel="preload stylesheet" as=style><link rel=icon href=https://waite.wang/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://waite.wang/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://waite.wang/favicon-32x32.png><link rel=apple-touch-icon href=https://waite.wang/apple-touch-icon.png><link rel=mask-icon href=https://waite.wang/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-cn href=https://waite.wang/posts/vue/system-learn-vuex-1/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://waite.wang/posts/vue/system-learn-vuex-1/"><meta property="og:site_name" content="隶笔难书"><meta property="og:title" content="系统学习 VueX 1"><meta property="og:description" content="Vue 学习笔记-VueX"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-11-11T21:05:54+08:00"><meta property="article:modified_time" content="2023-11-22T21:05:54+08:00"><meta property="article:tag" content="Vue"><meta property="article:tag" content="VueX"><meta name=twitter:card content="summary"><meta name=twitter:title content="系统学习 VueX 1"><meta name=twitter:description content="Vue 学习笔记-VueX"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://waite.wang/posts/"},{"@type":"ListItem","position":2,"name":"系统学习 VueX 1","item":"https://waite.wang/posts/vue/system-learn-vuex-1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"系统学习 VueX 1","name":"系统学习 VueX 1","description":"Vue 学习笔记-VueX","keywords":["Vue","VueX"],"articleBody":"Vue2-VueX 1.vuex介绍 目标 什么是vuex 为什么学习vuex 通信方案 组件关系 数据通信 父子关系 父传子：props ； 子传父：$emit 非父子关系 vuex (一种组件通信方案) vuex是什么 Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用集中式存储管理数据，以相应的规则保证状态以一种可预测的方式发生变化\nvuex为何学 程序页面多, 数据变量多\n不同组件数据保持同步 数据的修改都是可追踪 一个户外商店有两名员工，张三和李四\n一天的早上，他们分别对帐篷的数量做了一次盘点，发现一共有三个帐篷\n张三卖出去俩个，他以为库存里还有一个\n李四卖出去一个，他以为库存里还有两个\n而事实上是，库存现在已经为零\n如果他们再接受客户的预订，就会出现库存不足的情况\n张三和李四因为没有保持库存的数量的同步导致了尴尬，这个就是所谓的数据保持同步\n店长需要知道, 谁卖出了多少个帐篷，这个行为我们称之为数据修改是可追踪的\n图示:\nvuex中存什么 多个组件共享状态，才存储在vuex中\n某个组件中的私有数据，依旧存储在data中\n例如：\n登陆的用户名需要在首页, 个人中心, 结算页面使用, 用户名存在vuex中\n文章详情数据, 只有在文章详情页查看, 在自身data中声明\n小结 什么是vuex vuex是Vue官方推荐的集中式状态管理机制 为何学vuex 数据同步, 集中管理 vuex中存什么 多个组件共享的值 2.vuex学习内容 目标 知道vuex要学习什么 核心概念 官网地址: https://vuex.vuejs.org/zh/\n安装(固定)\n配置项(固定)\n配置项 含义 注意 state 单一状态树 类似data mutations 数据管家(同步) 唯一修改state地方 actions 异步请求 要改state需要提交给mutations getters vuex计算属性 类似computed modules 模块拆分 图示关系 单一定义store对象, 里面5个配置项, 在任意组件可以使用\n小结 vuex五个核心概念是? state / mutations / actions / getters / modules 3.vuex例子准备 目标 创建项目, 为学习准备 需求1: App.vue(作为根组件)\n需求2: 子组件Add和子组件Sub, 嵌入在App.vue里\n需求3: 三个组件共享库存数据(保持同步)\n工程准备 初始化新的工程 vuex-demo\nvue create vuex-demo 清空欢迎界面\n并设置如下三个组件, 目录如下：\n|-components |---AddItem.vue |---SubItem.vue |-App.vue App.vue 复制标签和样式, 引入AddItem和SubItem2个子组件显示\n\u003ctemplate\u003e \u003cdiv id=\"app\"\u003e \u003ch1\u003e根组件\u003c/h1\u003e \u003cspan\u003e库存总数:\u003c/span\u003e \u003cinput type=\"text\"\u003e \u003cdiv style=\"border:1px solid black; width: 300px;\"\u003e \u003cAddItem\u003e\u003c/AddItem\u003e \u003c/div\u003e \u003chr\u003e \u003cdiv style=\"border:1px solid black; width: 300px;\"\u003e \u003cSubItem\u003e\u003c/SubItem\u003e \u003c/div\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript\u003e import AddItem from '@/components/AddItem' import SubItem from '@/components/SubItem' export default { components: { AddItem, SubItem } } \u003c/script\u003e \u003cstyle\u003e #app { width: 300px; margin: 20px auto; border:1px solid #ccc; padding:4px; } \u003c/style\u003e AddItem.vue \u003ctemplate\u003e \u003cdiv\u003e \u003ch3\u003eAddItem组件\u003c/h3\u003e \u003cp\u003e已知库存数: 0\u003c/p\u003e \u003cbutton\u003e库存+1\u003c/button\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript\u003e export default { } \u003c/script\u003e SubItem.vue \u003ctemplate\u003e \u003cdiv\u003e \u003ch3\u003eSubItem组件\u003c/h3\u003e \u003cp\u003e已知库存数: 0\u003c/p\u003e \u003cbutton\u003e库存-1\u003c/button\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript\u003e export default { } \u003c/script\u003e 小结 App下套用了AddItem和SubItem, 要在3个组件共享一个数据 4.vuex-store准备 目标 创建store仓库 注入到Vue项目中 store概念 每个 Vuex 应用的核心 store（仓库）, 包含5个核心概念\nvuex目录 和路由模块router/index.js - 类似, 维护项目目录的整洁，新建src/store/index.js文件\n当然， 这个步骤并不是必需的\n使用步骤 工程中 - 下载vuex\nyarn add vuex store/index.js - 创建定义导出store对象\n// 目标: 创建store仓库对象 // 1. 下载vuex: 终端命令(yarn add vuex) // 2. 引入vuex import Vue from 'vue' import Vuex from 'vuex' // 3. 注册 Vue.use(Vuex) // 4. 实例化store对象 const store = new Vuex.Store({}) // 5. 导出store对象 export default store main.js - 导入注入到Vue中\nimport Vue from 'vue' import App from './App.vue' import store from '@/store' // 导入store对象 Vue.config.productionTip = false new Vue({ // 6. 注入到Vue实例中(确保组件this.$store使用) // this.$store = store store, render: h =\u003e h(App), }).$mount('#app') 请再次回忆一下vue-router的用法，是不是很像？\n小结 vuex的核心是什么?\nstore对象(包含5个核心属性) 如何创建store对象?\n工程下载vuex模块 store/index.js 引入注册 生成store对象导出 main.js - 导入注入 5.vuex-state数据源 目标 定义state 直接使用state 辅助函数mapState state是唯一的公共数据源，统一存储\n定义state 在store/index.js定义state\n语法:\n/* const store = new Vuex.Store({ state: { 变量名: 初始值 } }) */ 具体代码:\nconst store = new Vuex.Store({ state: { count: 100 // 库存 } }) 使用state2种方式 方式1: 组件内 - 直接使用\n语法:\nthis.$store.state.变量名 方式2: 组件内 - 映射使用 (推荐)\n语法:\n// 1. 拿到mapState辅助函数 import { mapState } from 'vuex' export default { computed: { // 2. 把state里变量映射到计算属性中 ...mapState(['state里的变量名']) } } AddItem直接用 \u003ctemplate\u003e \u003cdiv\u003e \u003ch3\u003eAddItem组件\u003c/h3\u003e \u003cp\u003e已知库存数: {{ $store.state.count }}\u003c/p\u003e \u003cbutton\u003e库存+1\u003c/button\u003e \u003c/div\u003e \u003c/template\u003e App.vue直接用 计算属性count, 和输入框的v-model双向绑定\n\u003cinput type=\"text\" v-model=\"count\"\u003e \u003cscript\u003e export default { computed: { count: { set(){}, get(){ return this.$store.state.count } } } } \u003c/script\u003e SubItem映射用 \u003ctemplate\u003e \u003cdiv\u003e \u003ch3\u003eSubItem组件\u003c/h3\u003e \u003cp\u003e已知库存数: {{ count }}\u003c/p\u003e \u003cbutton\u003e库存-1\u003c/button\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript\u003e // 需求1: 映射state到计算属性 // 1. 拿到辅助函数 mapState // 2. 在computed内, ...mapState(['state变量名']) // 3. 当计算属性使用 import { mapState } from 'vuex' // let r = mapState(['count']) // 提取store里的state叫count的变量 // console.log(r); // 返回值: {count: 函数体(return state里count的值)} export default { computed: { // 映射count, 得到对象展开, 合并到计算属性中 ...mapState(['count']) }, } \u003c/script\u003e 整个过程的示意图如下\n注意 state是响应式的, 只要state值变化, 页面上使用的地方会自动更新同步\n小结 state作用?\n定义全局状态数据源\nstate如何定义?\n在store内, state: {变量名: 初始值}\nstate的值如何用到具体vue组件内?\n直接使用 this.$store.state.变量名 映射使用 …mapState([‘state的变量名’]) 6.vuex-mutations定义-同步修改 目标 定义mutations 定义mutations mutations类似数据管家, 操作state里的数据\n在store/index.js定义mutations\n语法:\n/* const store = new Vuex.Store({ mutations: { 函数名 (state, 可选值) { // 同步修改state值代码 } } }) */ 具体代码\nconst store = new Vuex.Store({ state: { count: 100 // 库存 }, mutations: { addCount (state, value) { // 负责增加库存的管家 state.count += value }, subCount (state, value) { // 负责减少库存的管家 state.count -= value }, setCount (state, value) { // 负责直接修改库存的管家 state.count = value; } } }) 注意 mutations是唯一能修改state的地方, 确保调试工具可以追踪变化 mutations函数内, 只能写同步代码, 调试工具可追踪变化过程 因为调试工具要立刻产生一次记录, 所以必须是同步的 小结 mutations里函数作用?\n负责修改state里的数据 mutations只能写什么样的代码?\n同步流程的代码 7.vuex-mutations使用 目标 使用mutations2种方式 mutations注意事项 使用mutations的2种方式 方式1: 组件内 - 直接使用\n语法:\nthis.$store.commit(\"mutations里的函数名\", 具体值) 方式2: 组件内 - 映射使用\n语法:\n// 1. 拿到mapMutations辅助函数 import { mapMutations } from 'vuex' export default { methods: { // 2. 把mutations里方法映射到原地 ...mapMutations(['mutations里的函数名']) } } AddItem直接用 点击事件绑定 提交mutations传入值 \u003cbutton @click=\"addFn\"\u003e库存+1\u003c/button\u003e \u003cscript\u003e export default { methods: { addFn(){ this.$store.commit('addCount', 1) } } } \u003c/script\u003e App.vue直接用 触发计算属性的set方法 提交mutations传入值 \u003cspan\u003e库存总数: \u003c/span\u003e \u003cinput type=\"text\" v-model=\"count\"\u003e \u003cscript\u003e export default { computed: { count: { set(val){ this.$store.commit('setCount', val) // 把表单值提交给store下的mutations }, get(){ return this.$store.state.count } } } } \u003c/script\u003e SubItem映射用 点击事件 映射mutations的方法 调用mutations方法传值 \u003cbutton @click=\"subFn\"\u003e库存-1\u003c/button\u003e \u003cscript\u003e // 需求2: 映射mutations到方法里 // 1. 拿到辅助函数 mapMutations // 2. 在methods内, ...mapMutations(['mutations函数名']) // 3. 当普通方法使用 import { mapMutations } from 'vuex' export default { methods: { ...mapMutations(['subCount']), subFn(){ this.subCount(1) } } } \u003c/script\u003e 注意 mutations函数上, 只能接收一个参数值, 如果传对个, 请传一个对象\n小结 mutations有哪2种使用方式?\n直接使用 this.$store.commit()\n映射使用 mapMutations把方法映射到组件内直接调用\nstate, mutations, 视图组件, 3个关系是什么?\n8.vuex-actions定义-异步修改 目标 定义actions 定义actions 在store/index.js定义actions\n语法:\n/* const store = new Vuex.Store({ actions: { 函数名 (store, 可选值) { // 异步代码, 把结果commit给mutations给state赋值 } } }) */ 具体代码:\nconst store = new Vuex.Store({ // ...省略state和mutations此处 actions: { asyncAddCount(store, num){ setTimeout(() =\u003e { // 1秒后, 异步提交给add的mutations store.commit('addCount', num) }, 1000) }, asyncSubCount(store, num) { setTimeout(() =\u003e { // 1秒后, 异步提交给sub的mutations store.commit('subCount', num) }, 1000) } } }) 小结 actions和mutations区别?\nmutations里同步修改state\nactions里放入异步操作\nactions是否能操作state?\n不建议, 要commit给mutations(为调试工具可追踪)\nactions和mutations里函数, 第一个形参分别是什么?\nmutations的是state\nactions的是store\n9.vuex-actions使用 目标 使用actions 使用actions的2种方式 方式1: 组件内 - 直接使用\n语法:\nthis.$store.dispatch('actions函数名', 具体值) 方式2: 组件内 - 映射使用\n语法:\n// 1. 拿到mapActions辅助函数 import { mapActions } from 'vuex' export default { methods: { // 2. 把actions里方法映射到原地 ...mapActions(['actions里的函数名']) } } AddItem直接用 点击事件 dispatch触发action \u003cbutton @click=\"asyncAddFn\"\u003e延迟1秒, 库存+5\u003c/button\u003e \u003cscript\u003e export default { methods: { asyncAddFn(){ this.$store.dispatch('asyncAddCount', 5) } } } \u003c/script\u003e SubItem映射用 点击事件 映射actions的方法 调用actions的方法传值 \u003cbutton @click=\"asyncSubFn\"\u003e延迟1秒, 库存-5\u003c/button\u003e \u003cscript\u003e // 需求3: 映射actions到方法里 // 1. 拿到辅助函数 mapActions // 2. 在methods内, ...mapActions(['actions函数名']) // 3. 当普通方法使用 import { mapActions } from 'vuex' export default { methods: { ...mapActions(['asyncSubCount']), asyncSubFn(){ this.asyncSubCount(5) } } } \u003c/script\u003e 小结 actions使用方式?\n方式1: this.$store.dispatch(‘actions方法名字’, 值)\n方式2: …mapActions([‘actions里的方法名’]) 映射到原地使用\n视图组件, state, mutations, actions的关系是?\n10.vuex-重构购物车-准备Store 目标 在现有项目如何集成vuex store准备 复制预习资料到自己今天文件夹下 下载vuex store/index.js创建导出store对象 main.js把store引入, 然后注入到Vue实例 小结 现有项目如何集成vuex\n下载vuex\n创建store对象并注入到Vue实例中\n11.vuex-重构购物车-配置项(上午结束) 目标 准备state和mutations还有actions 配置项准备 定义state - 保存商品列表数组 state: { goodsList: [] // 列表 } 定义mutations - 给state里变量赋值 mutations: { setGoodsList(state, newList) { state.goodsList = newList } } 定义actions - 异步请求数据提交给mutations actions: { async asyncGetGoodsList(store) { const url = `https://www.escook.cn/api/cart` // 发送异步请求 const res = await axios({ url: url }); store.commit('setGoodsList', res.data.list) // 提交mutation修改state中的数据 } } App.vue使用vuex 把vuex商品数组映射回来使用 网络请求调用actions方法 \u003cscript\u003e import { mapState, mapActions } from 'vuex' export default { computed: { ...mapState({list: 'goodsList'}) // 自定义原地属性名list, 映射vuex里的goodsList变量值 }, created(){ this.asyncGetGoodsList() }, methods: { ...mapActions(['asyncGetGoodsList']), allFn(bool){ this.list.forEach(obj =\u003e obj.goods_state = bool) } } } \u003c/script\u003e 小结 mapState可以改变映射到原地的计算属性名吗?\n可以的, 格式…mapState({‘‘计算属性名’, ‘state里要映射的变量名’})\n12.vuex-getters定义-计算属性 目标 getters概念 定义getters getters概念 vuex身上的全局状态-计算属性, 类似于computed\ngetters 依赖于 state中原始数据的变化，并返回计算后的新数据\n定义getters 在store/index.js定义getters\n语法:\n/* const store = new Vuex.Store({ getters: { 计算属性名 (state) { return 值给计算属性 } } }) */ 具体代码\nconst store = new Vuex.Store({ // ...省略其他 getters: { allCount(state) { return state.goodsList.reduce((sum, obj) =\u003e { if (obj.goods_state === true) { // 选中商品才累加数量 sum += obj.goods_count; } return sum; }, 0) }, allPrice(state) { return state.goodsList.reduce((sum, obj) =\u003e { if (obj.goods_state) { sum += obj.goods_count * obj.goods_price } return sum; }, 0) } } }) 小结 getters有什么用?\nvuex里的计算属性, 属于全局计算属性, 类似computed\n13.vuex-getters使用 目标 组件内使用getters 使用getters的2种方式 方式1: 组件内 - 直接使用\n语法:\nthis.$store.getters.计算属性名 方式2: 组件内 - 映射使用\n语法:\n// 1. 拿到mapGetters辅助函数 import { mapGetters } from 'vuex' export default { computed: { // 2. 把getters里属性映射到原地 ...mapGetters(['getters里的计算属性名']) } } MyFooter.vue里使用 使用2种方式给计算属性值 \u003cscript\u003e import { mapGetters } from 'vuex' export default { computed: { allCount(){ return this.$store.getters.allCount; }, ...mapGetters(['allPrice']) } } \u003c/script\u003e 小结 getters如何使用?\n方式1: this.$store.getters.计算属性名\n方式2: …mapGetters([‘getters里计算属性名’])\n14.vuex-modules定义-分模块 目标 为何要分模块 modules定义 为何分模块 代码上的对比 创建modules模块对象 新建store/modules/user.js 新建store/modules/cart.js 语法: 对象里包含5个核心概念, 只有state变成函数形式\nuser.js - 用户模块对象\n// 用户模块对象 const userModule = { state(){ return { name: \"\", age: 0, sex: '' } }, mutations: {}, actions: {}, getters: {} } export default userModule cart.js - 购物车模块对象\n// 购物车模块对象 import axios from 'axios' const cartModule = { state() { return { goodsList: [] } }, mutations: { setGoodsList(state, newList) { state.goodsList = newList } }, actions: { async asyncGetGoodsList(store) { const url = `https://www.escook.cn/api/cart` // 发送异步请求 const res = await axios({ url: url }); store.commit('setGoodsList', res.data.list) // 提交mutation修改state中的数据 } }, getters: { allCount(state) { return state.goodsList.reduce((sum, obj) =\u003e { if (obj.goods_state === true) { // 选中商品才累加数量 sum += obj.goods_count; } return sum; }, 0) }, allPrice(state) { return state.goodsList.reduce((sum, obj) =\u003e { if (obj.goods_state) { sum += obj.goods_count * obj.goods_price } return sum; }, 0) } } } export default cartModule 定义modules 语法:\nmodules: { 模块名: 模块对象 } 把2个模块对象, 引回到store里注册 import Vue from 'vue' import Vuex from 'vuex' import cartModule from './modules/cart' import userModule from './modules/user' Vue.use(Vuex) const store = new Vuex.Store({ modules: { user: userModule, cart: cartModule } }) export default store 小结 为什么分模块?\n集中式管理项目过大, 变量过多, 会导致state臃肿, 难以维护\n如何分模块?\n定义模块对象, state变成函数返回对象形式, 每个模块都有state/mutations/actions/getters/modules\n根store如何注册?\nmodules里 { 模块名: 模块对象 }\n15.分模块-影响state取值方式 目的 只要分模块, state取值方式改变, 其他暂时不变 state使用方式修改 方式1: 组件内 - 直接使用\n原语法:\nthis.$store.state.变量名 分模块后语法:\nthis.$store.state.模块名.变量名 方式2: 组件内 - 映射使用\n原语法:\n...mapState(['state里变量名']) ...mapState({'变量名': \"state里变量名\"}) // 给映射过来的state起别的名字 分模块后语法:\n...mapState({ '变量名': state =\u003e state.模块名.变量名 }) App.vue-修改 computed: { // ...mapState({list: 'goodsList'}) // 本地属性名list, 映射vuex里的goodsList变量值 // 方式1: 直接用 // list(){ // 这个list就是组件内普通的计算属性名 // return this.$store.state.cart.goodsList // }. // 方式2: 映射方式改变 ...mapState({'list': state =\u003e state.cart.goodsList}) }, 小结 分模块对什么有影响?\n对state的取值方式有影响, 对其他暂无影响\nstate如何取值?\n在组件使用的时候, 要state.模块名.变量名\n16.分模块-命名空间 目标 防止多个模块之间, mutations/actions/getters的名字冲突 开启命名空间 在模块对象内设置namespaced: true\nconst moduleShopCar = { namespaced: true, state () {}, mutations: {}, actions: {}, getters: {}, modules: {} } state使用方式修改 直接使用无变化: this.$store.state.模块名.变量名\n辅助函数需要遵守格式\n...mapState(\"模块名\", ['state变量名']) mutations使用方式修改 方式1: 组件内 - 直接使用\n原语法:\nthis.$store.commit(\"mutations里的函数名\", 具体值) 开命名空间后语法:\nthis.$store.commit(\"模块名/mutations里的函数名\", 具体值) 方式2: 组件内 - 映射使用\n原语法:\n...mapMutations(['mutations里方法名']) 开命名空间后语法:\n...mapMutations(\"模块名\", ['mutations里方法名']) actions使用方式修改 方式1: 组件内 - 直接使用\n原语法:\nthis.$store.dispatch(\"actions里的函数名\", 具体值) 开命名空间后语法:\nthis.$store.dispatch(\"模块名/actions里的函数名\", 具体值) 方式2: 组件内 - 映射使用\n原语法:\n...mapActions(['actions里方法名']) 开命名空间后语法:\n...mapActions(\"模块名\", ['actions里方法名']) getters使用方式修改 方式1: 组件内 - 直接使用\n原语法:\nthis.$store.getters.计算属性名 开命名空间后语法:\nthis.$store.getters['模块名/计算属性名'] 方式2: 组件内 - 映射使用\n原语法:\n...mapGetters(['getters里计算属性名']) 开命名空间后语法:\n...mapGetters(\"模块名\", ['getters里计算属性名']) 小结 state和mutations, 在根store和开启命名空间里的区别? 整个vuex的体系是? 扩展: 使用Devtools调试vuex数据 优秀的调试工具可以使我们写程序事半功倍，最后我们再学习一下如果使用dev-tools来调试vuex中的数据，这也是数据可预测特性里不可缺少的一环\n目标 掌握dev-tools调试vuex 理解什么是数据状态是可追踪的 Vue3-Vuex Vuex介绍 Vuex是什么 Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用集中式存储管理数据，以相应的规则保证状态以一种可预测的方式发生变化 优点：\n能够在Vuex中集中管理共享的数居，易于开发和后期维护 能够高效地实现组件之间的数据共享，提高开发效率 存储在vuex中的数据都是响应式的，能够实时保持数据与页面的同步 vuex为何学 程序页面多, 数据变量多\n不同组件数据保持同步 数据的修改都是可追踪 一个户外商店有两名员工，张三和李四\n一天的早上，他们分别对帐篷的数量做了一次盘点，发现一共有三个帐篷\n张三卖出去俩个，他以为库存里还有一个\n李四卖出去一个，他以为库存里还有两个\n而事实上是，库存现在已经为零\n如果他们再接受客户的预订，就会出现库存不足的情况\n张三和李四因为没有保持库存的数量的同步导致了尴尬，这个就是所谓的数据保持同步\n店长需要知道, 谁卖出了多少个帐篷，这个行为我们称之为数据修改是可追踪的\nvuex中存什么 多个组件共享状态，才存储在vuex中\n某个组件中的私有数据，依旧存储在data中\n例如：\n登陆的用户名需要在首页, 个人中心, 结算页面使用, 用户名存在vuex中 文章详情数据, 只有在文章详情页查看, 在自身data中声明 基本使用 安装 vuex 依赖包 npm install vuex --save 导入 import Vuex from 'vuex' app.use(Vuex) 创建 store 对象 const store = new Vuex.Store({ // state 中存放的就是全局共享的数据 state: { count: 0 } }) 将 store 对象挂载到 vue 实例中 new Vue({ el: '#app', render: h =\u003e h(App), router // 将创建的共享数据对象挂载到 Vue 实例中 // 所有的组件, 就可以直接从 store 中获取全局的数据 }).$mount('#app') // Vue3 import { createApp } from 'vue' import { createStore } from 'vuex' // 创建一个新的 store 实例 const store = createStore({ state () { return { count: 0 } }, mutations: { increment (state) { state.count++ } } }) const app = createApp({ /* 根组件 */ }) // 将 store 实例作为插件安装 app.use(store) state state是唯一的公共数据源，统一存储\n// store/index.js import { createStore } from 'vuex' // 配置 Vuex const store = createStore({ state() { return { text: '我的博客 www.misterma.com', num: 12 } }, mutations: { changeText(state) { state.text = 'github https://github.com/changbin1997'; }, changeNum(state) { state.num ++; } } }); export default store 使用 方式1: 组件内 - 直接使用 this.$store.state.变量名 import {useStore} from 'vuex'; const store = useStore(); console.log(store.state.变量名); 方式2: 组件内 - 映射使用 (推荐) import {computed} from 'vue'; const text = computed(() =\u003e store.state.text); const num = computed(() =\u003e store.state.num); state是响应式的, 只要state值变化, 页面上使用的地方会自动更新同步\nmutations Vuex Mutations 则是用于修改状态的函数。在 Vuex 中，状态是通过 store 对象进行管理的，而 Mutations 则是通过提交（commit）来执行的。每个 Mutation 都是一个纯函数，它接收 state 对象作为第一个参数，并且可以接收额外的参数作为载荷（payload）。Mutation 函数用于同步地改变状态，它们在开发过程中可以帮助我们跟踪状态的变化。\n在 Vue 3 中，Mutations 并不是唯一能修改 state 的地方。实际上，在 Vue 3 中，可以通过使用 Mutations、Actions 或直接操作 state 来修改状态。这是与 Vue 2 中的 Vuex 不同的地方。\n在 Vue 3 中，可以使用 Mutations 来同步地改变状态，Actions 用于处理异步操作并提交 Mutations，而直接操作 state 则是为了简单的状态变化。这种方式使得状态管理更加灵活，并且能够更好地处理异步操作。\n因此，在 Vue 3 中，Mutations 并不是唯一能修改 state 的地方，而是状态管理中的一部分，开发者可以根据具体情况选择合适的方式来修改状态。\n以下是一个 mutations 与 store 结合的例子\n\u003ctemplate\u003e \u003cdiv\u003e \u003cp\u003e{{ store.state.text }}\u003c/p\u003e \u003cp\u003e{{ store.state.num }}\u003c/p\u003e \u003cbutton type=\"button\" @click=\"buttonClick\"\u003e更改 text 和 num\u003c/button\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript setup\u003e import {useStore} from 'vuex'; const store = useStore(); function buttonClick() { // 更改 text 和 num store.commit('changeText'); store.commit('changeNum'); } \u003c/script\u003e // store/index.js import { createRouter, createWebHistory } from 'vue-router' const routes = [ { path: '/login', name: 'login', component: () =\u003e import('@/components/login.vue') }, { path: '/main', name: 'main', component: () =\u003e import('@/components/main.vue') } ] const router = createRouter({ history: createWebHistory(), routes }) export default router actions 在 Vue 3 中，使用 Vuex 的 Actions 是一种处理异步操作并提交 Mutations 的方式。Actions 允许您在应用程序中执行异步操作，例如从服务器获取数据，然后再提交 Mutations 来修改状态。以下是在 Vue 3 中使用 Vuex Actions 的基本方法：\nconst store = new Vuex.Store({ // ...省略state和mutations此处 actions: { asyncAddCount(store, num){ setTimeout(() =\u003e { // 1秒后, 异步提交给add的mutations store.commit('addCount', num) }, 1000) }, asyncSubCount(store, num) { setTimeout(() =\u003e { // 1秒后, 异步提交给sub的mutations store.commit('subCount', num) }, 1000) } } }) getters Vuex Getters 是用于从 store 中获取状态的函数。Getters 允许您在 store 中计算状态或过滤数据，并且可以在组件中像计算属性一样使用。以下是在 Vue 3 中定义和使用 Vuex Getters 的基本方法：\nconst store = new Vuex.Store({ // ...省略其他 getters: { allCount(state) { return state.goodsList.reduce((sum, obj) =\u003e { if (obj.goods_state === true) { // 选中商品才累加数量 sum += obj.goods_count; } return sum; }, 0) }, allPrice(state) { return state.goodsList.reduce((sum, obj) =\u003e { if (obj.goods_state) { sum += obj.goods_count * obj.goods_price } return sum; }, 0) } } }) 用getters的2种方式 方式1: 组件内 - 直接使用\n语法:\nthis.$store.getters.计算属性名 方式2: 组件内 - 映射使用\n语法:\n// 1. 拿到mapGetters辅助函数 import { mapGetters } from 'vuex' export default { computed: { // 2. 把getters里属性映射到原地 ...mapGetters(['getters里的计算属性名']) } } MyFooter.vue里使用 使用2种方式给计算属性值 \u003cscript\u003e import { mapGetters } from 'vuex' export default { computed: { allCount(){ return this.$store.getters.allCount; }, ...mapGetters(['allPrice']) } } \u003c/script\u003e ","wordCount":"9985","inLanguage":"zh-cn","datePublished":"2023-11-11T21:05:54+08:00","dateModified":"2023-11-22T21:05:54+08:00","author":{"@type":"Person","name":"Waite Wang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://waite.wang/posts/vue/system-learn-vuex-1/"},"publisher":{"@type":"Organization","name":"隶笔难书","logo":{"@type":"ImageObject","url":"https://waite.wang/images/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://waite.wang/ accesskey=h title="隶笔难书 (Alt + H)">隶笔难书</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://waite.wang/ title=首页><span>首页</span></a></li><li><a href=https://waite.wang/search title=搜索><span>搜索</span></a></li><li><a href=https://waite.wang/categories title=分类><span>分类</span></a></li><li><a href=https://waite.wang/tags title=标签><span>标签</span></a></li><li><a href=https://waite.wang/archives title=归档><span>归档</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://waite.wang/>Home</a>&nbsp;»&nbsp;<a href=https://waite.wang/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">系统学习 VueX 1</h1><div class=post-description>Vue 学习笔记-VueX</div><div class=post-meta>Created: &nbsp;<span title='2023-11-11 21:05:54 +0800 +0800'>2023-11-11</span>&nbsp;·&nbsp;20 min&nbsp;·&nbsp;9985 words&nbsp;·&nbsp;Waite Wang&nbsp;|&nbsp;<a href=https://github.com/Waite0603/HugoBlog/edit/main/content/posts/vue/system-learn-vuex-1.md rel="noopener noreferrer" target=_blank>在 GitHub 编辑</a>
&nbsp; | Last Updated:&nbsp;2023-11-22</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#vue2-vuex aria-label=Vue2-VueX>Vue2-VueX</a><ul><li><a href=#1vuex%e4%bb%8b%e7%bb%8d aria-label=1.vuex介绍>1.vuex介绍</a><ul><li><a href=#%e7%9b%ae%e6%a0%87 aria-label=目标>目标</a></li><li><a href=#%e9%80%9a%e4%bf%a1%e6%96%b9%e6%a1%88 aria-label=通信方案>通信方案</a></li><li><a href=#vuex%e6%98%af%e4%bb%80%e4%b9%88 aria-label=vuex是什么>vuex是什么</a></li><li><a href=#vuex%e4%b8%ba%e4%bd%95%e5%ad%a6 aria-label=vuex为何学>vuex为何学</a></li><li><a href=#vuex%e4%b8%ad%e5%ad%98%e4%bb%80%e4%b9%88 aria-label=vuex中存什么>vuex中存什么</a></li><li><a href=#%e5%b0%8f%e7%bb%93 aria-label=小结>小结</a></li></ul></li><li><a href=#2vuex%e5%ad%a6%e4%b9%a0%e5%86%85%e5%ae%b9 aria-label=2.vuex学习内容>2.vuex学习内容</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-1 aria-label=目标>目标</a></li><li><a href=#%e6%a0%b8%e5%bf%83%e6%a6%82%e5%bf%b5 aria-label=核心概念>核心概念</a></li><li><a href=#%e5%9b%be%e7%a4%ba%e5%85%b3%e7%b3%bb aria-label=图示关系>图示关系</a></li><li><a href=#%e5%b0%8f%e7%bb%93-1 aria-label=小结>小结</a></li></ul></li><li><a href=#3vuex%e4%be%8b%e5%ad%90%e5%87%86%e5%a4%87 aria-label=3.vuex例子准备>3.vuex例子准备</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-2 aria-label=目标>目标</a></li><li><a href=#%e5%b7%a5%e7%a8%8b%e5%87%86%e5%a4%87 aria-label=工程准备>工程准备</a></li><li><a href=#appvue aria-label=App.vue>App.vue</a></li><li><a href=#additemvue aria-label=AddItem.vue>AddItem.vue</a></li><li><a href=#subitemvue aria-label=SubItem.vue>SubItem.vue</a></li><li><a href=#%e5%b0%8f%e7%bb%93-2 aria-label=小结>小结</a></li></ul></li><li><a href=#4vuex-store%e5%87%86%e5%a4%87 aria-label=4.vuex-store准备>4.vuex-store准备</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-3 aria-label=目标>目标</a></li><li><a href=#store%e6%a6%82%e5%bf%b5 aria-label=store概念>store概念</a></li><li><a href=#vuex%e7%9b%ae%e5%bd%95 aria-label=vuex目录>vuex目录</a></li><li><a href=#%e4%bd%bf%e7%94%a8%e6%ad%a5%e9%aa%a4 aria-label=使用步骤>使用步骤</a></li><li><a href=#%e5%b0%8f%e7%bb%93-3 aria-label=小结>小结</a></li></ul></li><li><a href=#5vuex-state%e6%95%b0%e6%8d%ae%e6%ba%90 aria-label=5.vuex-state数据源>5.vuex-state数据源</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-4 aria-label=目标>目标</a></li><li><a href=#%e5%ae%9a%e4%b9%89state aria-label=定义state>定义state</a></li><li><a href=#%e4%bd%bf%e7%94%a8state2%e7%a7%8d%e6%96%b9%e5%bc%8f aria-label=使用state2种方式>使用state2种方式</a></li><li><a href=#additem%e7%9b%b4%e6%8e%a5%e7%94%a8 aria-label=AddItem直接用>AddItem直接用</a></li><li><a href=#appvue%e7%9b%b4%e6%8e%a5%e7%94%a8 aria-label=App.vue直接用>App.vue直接用</a></li><li><a href=#subitem%e6%98%a0%e5%b0%84%e7%94%a8 aria-label=SubItem映射用>SubItem映射用</a></li><li><a href=#%e6%b3%a8%e6%84%8f aria-label=注意>注意</a></li><li><a href=#%e5%b0%8f%e7%bb%93-4 aria-label=小结>小结</a></li></ul></li><li><a href=#6vuex-mutations%e5%ae%9a%e4%b9%89-%e5%90%8c%e6%ad%a5%e4%bf%ae%e6%94%b9 aria-label=6.vuex-mutations定义-同步修改>6.vuex-mutations定义-同步修改</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-5 aria-label=目标>目标</a></li><li><a href=#%e5%ae%9a%e4%b9%89mutations aria-label=定义mutations>定义mutations</a></li><li><a href=#%e6%b3%a8%e6%84%8f-1 aria-label=注意>注意</a></li><li><a href=#%e5%b0%8f%e7%bb%93-5 aria-label=小结>小结</a></li></ul></li><li><a href=#7vuex-mutations%e4%bd%bf%e7%94%a8 aria-label=7.vuex-mutations使用>7.vuex-mutations使用</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-6 aria-label=目标>目标</a></li><li><a href=#%e4%bd%bf%e7%94%a8mutations%e7%9a%842%e7%a7%8d%e6%96%b9%e5%bc%8f aria-label=使用mutations的2种方式>使用mutations的2种方式</a></li><li><a href=#additem%e7%9b%b4%e6%8e%a5%e7%94%a8-1 aria-label=AddItem直接用>AddItem直接用</a></li><li><a href=#appvue%e7%9b%b4%e6%8e%a5%e7%94%a8-1 aria-label=App.vue直接用>App.vue直接用</a></li><li><a href=#subitem%e6%98%a0%e5%b0%84%e7%94%a8-1 aria-label=SubItem映射用>SubItem映射用</a></li><li><a href=#%e6%b3%a8%e6%84%8f-2 aria-label=注意>注意</a></li><li><a href=#%e5%b0%8f%e7%bb%93-6 aria-label=小结>小结</a></li></ul></li><li><a href=#8vuex-actions%e5%ae%9a%e4%b9%89-%e5%bc%82%e6%ad%a5%e4%bf%ae%e6%94%b9 aria-label=8.vuex-actions定义-异步修改>8.vuex-actions定义-异步修改</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-7 aria-label=目标>目标</a></li><li><a href=#%e5%ae%9a%e4%b9%89actions aria-label=定义actions>定义actions</a></li><li><a href=#%e5%b0%8f%e7%bb%93-7 aria-label=小结>小结</a></li></ul></li><li><a href=#9vuex-actions%e4%bd%bf%e7%94%a8 aria-label=9.vuex-actions使用>9.vuex-actions使用</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-8 aria-label=目标>目标</a></li><li><a href=#%e4%bd%bf%e7%94%a8actions%e7%9a%842%e7%a7%8d%e6%96%b9%e5%bc%8f aria-label=使用actions的2种方式>使用actions的2种方式</a></li><li><a href=#additem%e7%9b%b4%e6%8e%a5%e7%94%a8-2 aria-label=AddItem直接用>AddItem直接用</a></li><li><a href=#subitem%e6%98%a0%e5%b0%84%e7%94%a8-2 aria-label=SubItem映射用>SubItem映射用</a></li><li><a href=#%e5%b0%8f%e7%bb%93-8 aria-label=小结>小结</a></li></ul></li><li><a href=#10vuex-%e9%87%8d%e6%9e%84%e8%b4%ad%e7%89%a9%e8%bd%a6-%e5%87%86%e5%a4%87store aria-label=10.vuex-重构购物车-准备Store>10.vuex-重构购物车-准备Store</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-9 aria-label=目标>目标</a></li><li><a href=#store%e5%87%86%e5%a4%87 aria-label=store准备>store准备</a></li><li><a href=#%e5%b0%8f%e7%bb%93-9 aria-label=小结>小结</a></li></ul></li><li><a href=#11vuex-%e9%87%8d%e6%9e%84%e8%b4%ad%e7%89%a9%e8%bd%a6-%e9%85%8d%e7%bd%ae%e9%a1%b9%e4%b8%8a%e5%8d%88%e7%bb%93%e6%9d%9f aria-label=11.vuex-重构购物车-配置项(上午结束)>11.vuex-重构购物车-配置项(上午结束)</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-10 aria-label=目标>目标</a></li><li><a href=#%e9%85%8d%e7%bd%ae%e9%a1%b9%e5%87%86%e5%a4%87 aria-label=配置项准备>配置项准备</a></li><li><a href=#appvue%e4%bd%bf%e7%94%a8vuex aria-label=App.vue使用vuex>App.vue使用vuex</a></li><li><a href=#%e5%b0%8f%e7%bb%93-10 aria-label=小结>小结</a></li></ul></li><li><a href=#12vuex-getters%e5%ae%9a%e4%b9%89-%e8%ae%a1%e7%ae%97%e5%b1%9e%e6%80%a7 aria-label=12.vuex-getters定义-计算属性>12.vuex-getters定义-计算属性</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-11 aria-label=目标>目标</a></li><li><a href=#getters%e6%a6%82%e5%bf%b5 aria-label=getters概念>getters概念</a></li><li><a href=#%e5%ae%9a%e4%b9%89getters aria-label=定义getters>定义getters</a></li><li><a href=#%e5%b0%8f%e7%bb%93-11 aria-label=小结>小结</a></li></ul></li><li><a href=#13vuex-getters%e4%bd%bf%e7%94%a8 aria-label=13.vuex-getters使用>13.vuex-getters使用</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-12 aria-label=目标>目标</a></li><li><a href=#%e4%bd%bf%e7%94%a8getters%e7%9a%842%e7%a7%8d%e6%96%b9%e5%bc%8f aria-label=使用getters的2种方式>使用getters的2种方式</a></li><li><a href=#myfootervue%e9%87%8c%e4%bd%bf%e7%94%a8 aria-label=MyFooter.vue里使用>MyFooter.vue里使用</a></li><li><a href=#%e5%b0%8f%e7%bb%93-12 aria-label=小结>小结</a></li></ul></li><li><a href=#14vuex-modules%e5%ae%9a%e4%b9%89-%e5%88%86%e6%a8%a1%e5%9d%97 aria-label=14.vuex-modules定义-分模块>14.vuex-modules定义-分模块</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-13 aria-label=目标>目标</a></li><li><a href=#%e4%b8%ba%e4%bd%95%e5%88%86%e6%a8%a1%e5%9d%97 aria-label=为何分模块>为何分模块</a></li><li><a href=#%e4%bb%a3%e7%a0%81%e4%b8%8a%e7%9a%84%e5%af%b9%e6%af%94 aria-label=代码上的对比>代码上的对比</a></li><li><a href=#%e5%88%9b%e5%bb%bamodules%e6%a8%a1%e5%9d%97%e5%af%b9%e8%b1%a1 aria-label=创建modules模块对象>创建modules模块对象</a></li><li><a href=#%e5%ae%9a%e4%b9%89modules aria-label=定义modules>定义modules</a></li><li><a href=#%e5%b0%8f%e7%bb%93-13 aria-label=小结>小结</a></li></ul></li><li><a href=#15%e5%88%86%e6%a8%a1%e5%9d%97-%e5%bd%b1%e5%93%8dstate%e5%8f%96%e5%80%bc%e6%96%b9%e5%bc%8f aria-label=15.分模块-影响state取值方式>15.分模块-影响state取值方式</a><ul><li><a href=#%e7%9b%ae%e7%9a%84 aria-label=目的>目的</a></li><li><a href=#state%e4%bd%bf%e7%94%a8%e6%96%b9%e5%bc%8f%e4%bf%ae%e6%94%b9 aria-label=state使用方式修改>state使用方式修改</a></li><li><a href=#appvue-%e4%bf%ae%e6%94%b9 aria-label=App.vue-修改>App.vue-修改</a></li><li><a href=#%e5%b0%8f%e7%bb%93-14 aria-label=小结>小结</a></li></ul></li><li><a href=#16%e5%88%86%e6%a8%a1%e5%9d%97-%e5%91%bd%e5%90%8d%e7%a9%ba%e9%97%b4 aria-label=16.分模块-命名空间>16.分模块-命名空间</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-14 aria-label=目标>目标</a></li><li><a href=#%e5%bc%80%e5%90%af%e5%91%bd%e5%90%8d%e7%a9%ba%e9%97%b4 aria-label=开启命名空间>开启命名空间</a></li><li><a href=#state%e4%bd%bf%e7%94%a8%e6%96%b9%e5%bc%8f%e4%bf%ae%e6%94%b9-1 aria-label=state使用方式修改>state使用方式修改</a></li><li><a href=#mutations%e4%bd%bf%e7%94%a8%e6%96%b9%e5%bc%8f%e4%bf%ae%e6%94%b9 aria-label=mutations使用方式修改>mutations使用方式修改</a></li><li><a href=#actions%e4%bd%bf%e7%94%a8%e6%96%b9%e5%bc%8f%e4%bf%ae%e6%94%b9 aria-label=actions使用方式修改>actions使用方式修改</a></li><li><a href=#getters%e4%bd%bf%e7%94%a8%e6%96%b9%e5%bc%8f%e4%bf%ae%e6%94%b9 aria-label=getters使用方式修改>getters使用方式修改</a></li><li><a href=#%e5%b0%8f%e7%bb%93-15 aria-label=小结>小结</a></li></ul></li><li><a href=#%e6%89%a9%e5%b1%95-%e4%bd%bf%e7%94%a8devtools%e8%b0%83%e8%af%95vuex%e6%95%b0%e6%8d%ae aria-label="扩展: 使用Devtools调试vuex数据">扩展: 使用Devtools调试vuex数据</a><ul><li><a href=#%e7%9b%ae%e6%a0%87-15 aria-label=目标>目标</a></li></ul></li></ul></li><li><a href=#vue3-vuex aria-label=Vue3-Vuex>Vue3-Vuex</a><ul><li><a href=#vuex%e4%bb%8b%e7%bb%8d aria-label=Vuex介绍>Vuex介绍</a><ul><li><a href=#vuex%e6%98%af%e4%bb%80%e4%b9%88-1 aria-label=Vuex是什么>Vuex是什么</a></li><li><a href=#vuex%e4%b8%ba%e4%bd%95%e5%ad%a6-1 aria-label=vuex为何学>vuex为何学</a></li><li><a href=#vuex%e4%b8%ad%e5%ad%98%e4%bb%80%e4%b9%88-1 aria-label=vuex中存什么>vuex中存什么</a></li></ul></li><li><a href=#%e5%9f%ba%e6%9c%ac%e4%bd%bf%e7%94%a8 aria-label=基本使用>基本使用</a></li><li><a href=#state aria-label=state>state</a><ul><li><a href=#%e4%bd%bf%e7%94%a8 aria-label=使用>使用</a></li></ul></li><li><a href=#mutations aria-label=mutations>mutations</a></li><li><a href=#actions aria-label=actions>actions</a></li><li><a href=#getters aria-label=getters>getters</a><ul><li><a href=#%e7%94%a8getters%e7%9a%842%e7%a7%8d%e6%96%b9%e5%bc%8f aria-label=用getters的2种方式>用getters的2种方式</a></li><li><a href=#myfootervue%e9%87%8c%e4%bd%bf%e7%94%a8-1 aria-label=MyFooter.vue里使用>MyFooter.vue里使用</a></li></ul></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=vue2-vuex>Vue2-VueX<a hidden class=anchor aria-hidden=true href=#vue2-vuex>#</a></h2><h3 id=1vuex介绍>1.vuex介绍<a hidden class=anchor aria-hidden=true href=#1vuex介绍>#</a></h3><h4 id=目标>目标<a hidden class=anchor aria-hidden=true href=#目标>#</a></h4><ul><li>什么是vuex</li><li>为什么学习vuex</li></ul><h4 id=通信方案>通信方案<a hidden class=anchor aria-hidden=true href=#通信方案>#</a></h4><p><img loading=lazy src=https://qiniu.waite.wang/202312242346950.png></p><table><thead><tr><th>组件关系</th><th>数据通信</th></tr></thead><tbody><tr><td>父子关系</td><td>父传子：props ； 子传父：$emit</td></tr><tr><td>非父子关系</td><td>vuex (一种组件通信方案)</td></tr></tbody></table><h4 id=vuex是什么>vuex是什么<a hidden class=anchor aria-hidden=true href=#vuex是什么>#</a></h4><p>Vuex 是一个专为 Vue.js 应用程序开发的<strong>状态管理模式</strong>。它采用<strong>集中式</strong>存储管理数据，以相应的规则保证状态以一种可预测的方式发生变化</p><p><img loading=lazy src=https://qiniu.waite.wang/202312242347862.png></p><h4 id=vuex为何学>vuex为何学<a hidden class=anchor aria-hidden=true href=#vuex为何学>#</a></h4><p>程序页面多, 数据变量多</p><ol><li>不同组件数据<strong>保持同步</strong></li><li>数据的修改都是<strong>可追踪</strong></li></ol><p>一个户外商店有两名员工，张三和李四</p><p>一天的早上，他们分别对<strong>帐篷的数量</strong>做了一次盘点，发现一共有三个帐篷</p><p>张三卖出去俩个，他以为库存里还有<strong>一个</strong></p><p>李四卖出去一个，他以为库存里还有<strong>两个</strong></p><p>而事实上是，库存现在已经为<strong>零</strong></p><p>如果他们再接受客户的预订，就会出现库存<strong>不足</strong>的情况</p><blockquote><p>张三和李四因为没有保持库存的数量的同步导致了尴尬，这个就是所谓的<code>数据保持同步</code></p><p>店长需要知道, 谁卖出了多少个帐篷，这个行为我们称之为<code>数据修改是可追踪的</code></p></blockquote><p>图示:</p><p><img loading=lazy src=https://qiniu.waite.wang/202312242348361.png></p><h4 id=vuex中存什么>vuex中存什么<a hidden class=anchor aria-hidden=true href=#vuex中存什么>#</a></h4><p><strong>多个组件共享状态</strong>，才存储在vuex中</p><p>某个组件中的私有数据，依旧存储在data中</p><p>例如：</p><ul><li><p>登陆的用户名需要在<strong>首页</strong>, <strong>个人中心</strong>, <strong>结算</strong>页面使用, 用户名存在vuex中</p></li><li><p>文章详情数据, 只有在文章详情页查看, 在自身data中声明</p></li></ul><h4 id=小结>小结<a hidden class=anchor aria-hidden=true href=#小结>#</a></h4><ol><li>什么是vuex<ul><li>vuex是Vue官方推荐的集中式状态管理机制</li></ul></li><li>为何学vuex<ul><li>数据同步, 集中管理</li></ul></li><li>vuex中存什么<ul><li>多个组件共享的值</li></ul></li></ol><h3 id=2vuex学习内容>2.vuex学习内容<a hidden class=anchor aria-hidden=true href=#2vuex学习内容>#</a></h3><h4 id=目标-1>目标<a hidden class=anchor aria-hidden=true href=#目标-1>#</a></h4><ul><li>知道vuex要学习什么</li></ul><h4 id=核心概念>核心概念<a hidden class=anchor aria-hidden=true href=#核心概念>#</a></h4><ol><li><p>官网地址:
<a href=https://vuex.vuejs.org/zh/ target=_blank>https://vuex.vuejs.org/zh/</a></p></li><li><p>安装(固定)</p></li><li><p>配置项(固定)</p><table><thead><tr><th>配置项</th><th>含义</th><th>注意</th></tr></thead><tbody><tr><td><strong>state</strong></td><td>单一状态树</td><td>类似data</td></tr><tr><td><strong>mutations</strong></td><td>数据管家(同步)</td><td>唯一修改state地方</td></tr><tr><td>actions</td><td>异步请求</td><td>要改state需要提交给mutations</td></tr><tr><td>getters</td><td>vuex计算属性</td><td>类似computed</td></tr><tr><td>modules</td><td>模块拆分</td><td></td></tr></tbody></table></li></ol><h4 id=图示关系>图示关系<a hidden class=anchor aria-hidden=true href=#图示关系>#</a></h4><p>单一定义store对象, 里面5个配置项, 在任意组件可以使用</p><p><img loading=lazy src=https://qiniu.waite.wang/202312242348351.png></p><h4 id=小结-1>小结<a hidden class=anchor aria-hidden=true href=#小结-1>#</a></h4><ol><li>vuex五个核心概念是?<ul><li>state / mutations / actions / getters / modules</li></ul></li></ol><h3 id=3vuex例子准备>3.vuex例子准备<a hidden class=anchor aria-hidden=true href=#3vuex例子准备>#</a></h3><h4 id=目标-2>目标<a hidden class=anchor aria-hidden=true href=#目标-2>#</a></h4><ul><li>创建项目, 为学习准备<ul><li><p>需求1: App.vue(作为根组件)</p></li><li><p>需求2: 子组件Add和子组件Sub, 嵌入在App.vue里</p></li><li><p>需求3: 三个组件共享库存数据(<strong>保持同步</strong>)</p><p><img loading=lazy src=https://qiniu.waite.wang/202312242348672.png></p></li></ul></li></ul><h4 id=工程准备>工程准备<a hidden class=anchor aria-hidden=true href=#工程准备>#</a></h4><ol><li><p>初始化新的工程 vuex-demo</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>vue</span> <span class=nx>create</span> <span class=nx>vuex</span><span class=o>-</span><span class=nx>demo</span>
</span></span></code></pre></div></li><li><p>清空欢迎界面</p></li><li><p>并设置如下三个组件, 目录如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=o>|-</span><span class=nx>components</span>
</span></span><span class=line><span class=cl><span class=o>|---</span><span class=nx>AddItem</span><span class=p>.</span><span class=nx>vue</span>
</span></span><span class=line><span class=cl><span class=o>|---</span><span class=nx>SubItem</span><span class=p>.</span><span class=nx>vue</span>
</span></span><span class=line><span class=cl><span class=o>|-</span><span class=nx>App</span><span class=p>.</span><span class=nx>vue</span>
</span></span></code></pre></div></li></ol><h4 id=appvue>App.vue<a hidden class=anchor aria-hidden=true href=#appvue>#</a></h4><blockquote><p>复制标签和样式, 引入AddItem和SubItem2个子组件显示</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;app&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span><span class=nx>根组件</span><span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>span</span><span class=p>&gt;</span><span class=nx>库存总数</span><span class=o>:</span><span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;border:1px solid black; width: 300px;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>AddItem</span><span class=p>&gt;&lt;/</span><span class=nt>AddItem</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>hr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;border:1px solid black; width: 300px;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>SubItem</span><span class=p>&gt;&lt;/</span><span class=nt>SubItem</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>AddItem</span> <span class=nx>from</span> <span class=s1>&#39;@/components/AddItem&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>SubItem</span> <span class=nx>from</span> <span class=s1>&#39;@/components/SubItem&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>components</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>AddItem</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>SubItem</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=err>#</span><span class=nx>app</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>width</span><span class=o>:</span> <span class=mi>300</span><span class=nx>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>margin</span><span class=o>:</span> <span class=mi>20</span><span class=nx>px</span> <span class=nx>auto</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>border</span><span class=o>:</span><span class=mi>1</span><span class=nx>px</span> <span class=nx>solid</span> <span class=err>#</span><span class=nx>ccc</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>padding</span><span class=o>:</span><span class=mi>4</span><span class=nx>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=additemvue>AddItem.vue<a hidden class=anchor aria-hidden=true href=#additemvue>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>h3</span><span class=p>&gt;</span><span class=nx>AddItem组件</span><span class=p>&lt;/</span><span class=nt>h3</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>已知库存数</span><span class=o>:</span> <span class=mi>0</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span><span class=p>&gt;</span><span class=nx>库存</span><span class=o>+</span><span class=mi>1</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=subitemvue>SubItem.vue<a hidden class=anchor aria-hidden=true href=#subitemvue>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>h3</span><span class=p>&gt;</span><span class=nx>SubItem组件</span><span class=p>&lt;/</span><span class=nt>h3</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>已知库存数</span><span class=o>:</span> <span class=mi>0</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span><span class=p>&gt;</span><span class=nx>库存</span><span class=o>-</span><span class=mi>1</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=小结-2>小结<a hidden class=anchor aria-hidden=true href=#小结-2>#</a></h4><ol><li>App下套用了AddItem和SubItem, 要在3个组件共享一个数据</li></ol><h3 id=4vuex-store准备>4.vuex-store准备<a hidden class=anchor aria-hidden=true href=#4vuex-store准备>#</a></h3><h4 id=目标-3>目标<a hidden class=anchor aria-hidden=true href=#目标-3>#</a></h4><ul><li>创建store仓库</li><li>注入到Vue项目中</li></ul><h4 id=store概念>store概念<a hidden class=anchor aria-hidden=true href=#store概念>#</a></h4><p>每个 Vuex 应用的核心 store（仓库）, 包含5个核心概念</p><p><img loading=lazy src=https://qiniu.waite.wang/202312242351180.png></p><h4 id=vuex目录>vuex目录<a hidden class=anchor aria-hidden=true href=#vuex目录>#</a></h4><p>和路由模块router/index.js - 类似, 维护项目目录的整洁，新建src/store/index.js文件</p><blockquote><p>当然， 这个步骤并不是必需的</p></blockquote><p><img loading=lazy src=https://qiniu.waite.wang/202312242353021.png></p><h4 id=使用步骤>使用步骤<a hidden class=anchor aria-hidden=true href=#使用步骤>#</a></h4><ol><li><p>工程中 - 下载vuex</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>yarn add vuex
</span></span></code></pre></div></li><li><p>store/index.js - 创建定义导出store对象</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// 目标: 创建store仓库对象
</span></span></span><span class=line><span class=cl><span class=c1>// 1. 下载vuex: 终端命令(yarn add vuex)
</span></span></span><span class=line><span class=cl><span class=c1>// 2. 引入vuex
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=nx>Vue</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Vuex</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>// 3. 注册
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>Vue</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>Vuex</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>// 4. 实例化store对象
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Vuex</span><span class=p>.</span><span class=nx>Store</span><span class=p>({})</span>
</span></span><span class=line><span class=cl><span class=c1>// 5. 导出store对象
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=k>default</span> <span class=nx>store</span>
</span></span></code></pre></div></li><li><p>main.js - 导入注入到Vue中</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Vue</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>App</span> <span class=nx>from</span> <span class=s1>&#39;./App.vue&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>store</span> <span class=nx>from</span> <span class=s1>&#39;@/store&#39;</span> <span class=c1>// 导入store对象
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>Vue</span><span class=p>.</span><span class=nx>config</span><span class=p>.</span><span class=nx>productionTip</span> <span class=o>=</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>new</span> <span class=nx>Vue</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 6. 注入到Vue实例中(确保组件this.$store使用) // this.$store = store
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>store</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>render</span><span class=o>:</span> <span class=nx>h</span> <span class=p>=&gt;</span> <span class=nx>h</span><span class=p>(</span><span class=nx>App</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>}).</span><span class=nx>$mount</span><span class=p>(</span><span class=s1>&#39;#app&#39;</span><span class=p>)</span>
</span></span></code></pre></div></li></ol><p>请再次回忆一下vue-router的用法，是不是很像？</p><h4 id=小结-3>小结<a hidden class=anchor aria-hidden=true href=#小结-3>#</a></h4><ol><li><p>vuex的核心是什么?</p><ul><li>store对象(包含5个核心属性)</li></ul></li><li><p>如何创建store对象?</p><ul><li>工程下载vuex模块</li><li>store/index.js<ul><li>引入注册</li><li>生成store对象导出</li><li>main.js - 导入注入</li></ul></li></ul></li></ol><h3 id=5vuex-state数据源>5.vuex-state数据源<a hidden class=anchor aria-hidden=true href=#5vuex-state数据源>#</a></h3><h4 id=目标-4>目标<a hidden class=anchor aria-hidden=true href=#目标-4>#</a></h4><ul><li>定义state</li><li>直接使用state</li><li>辅助函数mapState</li></ul><blockquote><p>state是唯一的公共数据源，统一存储</p></blockquote><h4 id=定义state>定义state<a hidden class=anchor aria-hidden=true href=#定义state>#</a></h4><p>在store/index.js定义state</p><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>const store = new Vuex.Store({
</span></span></span><span class=line><span class=cl><span class=cm>    state: {
</span></span></span><span class=line><span class=cl><span class=cm>        变量名: 初始值
</span></span></span><span class=line><span class=cl><span class=cm>    }
</span></span></span><span class=line><span class=cl><span class=cm>}) 
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>具体代码:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Vuex</span><span class=p>.</span><span class=nx>Store</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>state</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>count</span><span class=o>:</span> <span class=mi>100</span> <span class=c1>// 库存
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h4 id=使用state2种方式>使用state2种方式<a hidden class=anchor aria-hidden=true href=#使用state2种方式>#</a></h4><ul><li><p>方式1: 组件内 - <strong>直接</strong>使用</p><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>变量名</span>
</span></span></code></pre></div></li><li><p>方式2: 组件内 - <strong>映射</strong>使用 (推荐)</p><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// 1. 拿到mapState辅助函数
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>mapState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>computed</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 2. 把state里变量映射到计算属性中
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>...</span><span class=nx>mapState</span><span class=p>([</span><span class=s1>&#39;state里的变量名&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul><h4 id=additem直接用>AddItem直接用<a hidden class=anchor aria-hidden=true href=#additem直接用>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>h3</span><span class=p>&gt;</span><span class=nx>AddItem组件</span><span class=p>&lt;/</span><span class=nt>h3</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>已知库存数</span><span class=o>:</span> <span class=p>{{</span> <span class=nx>$store</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>count</span> <span class=p>}}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span><span class=p>&gt;</span><span class=nx>库存</span><span class=o>+</span><span class=mi>1</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=appvue直接用>App.vue直接用<a hidden class=anchor aria-hidden=true href=#appvue直接用>#</a></h4><p>计算属性count, 和输入框的v-model双向绑定</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=nt>v-model</span><span class=o>=</span><span class=s>&#34;count&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>computed</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>count</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>set</span><span class=p>(){},</span>
</span></span><span class=line><span class=cl>      <span class=nx>get</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>count</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=subitem映射用>SubItem映射用<a hidden class=anchor aria-hidden=true href=#subitem映射用>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>h3</span><span class=p>&gt;</span><span class=nx>SubItem组件</span><span class=p>&lt;/</span><span class=nt>h3</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>已知库存数</span><span class=o>:</span> <span class=p>{{</span> <span class=nx>count</span> <span class=p>}}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>button</span><span class=p>&gt;</span><span class=nx>库存</span><span class=o>-</span><span class=mi>1</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>// 需求1: 映射state到计算属性
</span></span></span><span class=line><span class=cl><span class=c1>// 1. 拿到辅助函数 mapState
</span></span></span><span class=line><span class=cl><span class=c1>// 2. 在computed内, ...mapState([&#39;state变量名&#39;])
</span></span></span><span class=line><span class=cl><span class=c1>// 3. 当计算属性使用
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>mapState</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>// let r = mapState([&#39;count&#39;]) // 提取store里的state叫count的变量
</span></span></span><span class=line><span class=cl><span class=c1>// console.log(r); // 返回值: {count: 函数体(return state里count的值)}
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>computed</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 映射count, 得到对象展开, 合并到计算属性中
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>...</span><span class=nx>mapState</span><span class=p>([</span><span class=s1>&#39;count&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>整个过程的示意图如下</p><p><img loading=lazy src=https://qiniu.waite.wang/202312242355459.png></p><h4 id=注意>注意<a hidden class=anchor aria-hidden=true href=#注意>#</a></h4><p>state是响应式的, 只要state值变化, 页面上使用的地方会自动更新同步</p><h4 id=小结-4>小结<a hidden class=anchor aria-hidden=true href=#小结-4>#</a></h4><ol><li><p>state作用?</p><p>定义全局状态数据源</p></li><li><p>state如何定义?</p><p>在store内, state: {变量名: 初始值}</p></li><li><p>state的值如何用到具体vue组件内?</p><ul><li>直接使用 this.$store.state.变量名</li><li>映射使用 &mldr;mapState([&lsquo;state的变量名&rsquo;])</li></ul></li></ol><h3 id=6vuex-mutations定义-同步修改>6.vuex-mutations定义-同步修改<a hidden class=anchor aria-hidden=true href=#6vuex-mutations定义-同步修改>#</a></h3><h4 id=目标-5>目标<a hidden class=anchor aria-hidden=true href=#目标-5>#</a></h4><ul><li>定义mutations</li></ul><h4 id=定义mutations>定义mutations<a hidden class=anchor aria-hidden=true href=#定义mutations>#</a></h4><blockquote><p>mutations类似数据管家, 操作state里的数据</p></blockquote><p>在store/index.js定义mutations</p><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>const store  = new Vuex.Store({
</span></span></span><span class=line><span class=cl><span class=cm> mutations: {
</span></span></span><span class=line><span class=cl><span class=cm>  函数名 (state, 可选值) {
</span></span></span><span class=line><span class=cl><span class=cm>   // 同步修改state值代码
</span></span></span><span class=line><span class=cl><span class=cm>  }
</span></span></span><span class=line><span class=cl><span class=cm> }
</span></span></span><span class=line><span class=cl><span class=cm>})
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>具体代码</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>store</span>  <span class=o>=</span> <span class=k>new</span> <span class=nx>Vuex</span><span class=p>.</span><span class=nx>Store</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>state</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>count</span><span class=o>:</span> <span class=mi>100</span> <span class=c1>// 库存
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>},</span>
</span></span><span class=line><span class=cl> <span class=nx>mutations</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>addCount</span> <span class=p>(</span><span class=nx>state</span><span class=p>,</span> <span class=nx>value</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// 负责增加库存的管家
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=nx>state</span><span class=p>.</span><span class=nx>count</span> <span class=o>+=</span> <span class=nx>value</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nx>subCount</span> <span class=p>(</span><span class=nx>state</span><span class=p>,</span> <span class=nx>value</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// 负责减少库存的管家
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>state</span><span class=p>.</span><span class=nx>count</span> <span class=o>-=</span> <span class=nx>value</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nx>setCount</span> <span class=p>(</span><span class=nx>state</span><span class=p>,</span> <span class=nx>value</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// 负责直接修改库存的管家
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>state</span><span class=p>.</span><span class=nx>count</span> <span class=o>=</span> <span class=nx>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h4 id=注意-1>注意<a hidden class=anchor aria-hidden=true href=#注意-1>#</a></h4><blockquote><ol><li>mutations是<strong>唯一</strong>能修改state的地方, 确保<strong>调试工具</strong>可以追踪变化</li><li>mutations函数内, 只能写同步代码, 调试工具可追踪变化过程<ul><li>因为调试工具要<strong>立刻</strong>产生一次记录, 所以必须是同步的</li></ul></li></ol></blockquote><h4 id=小结-5>小结<a hidden class=anchor aria-hidden=true href=#小结-5>#</a></h4><ol><li><p>mutations里函数作用?</p><ul><li>负责修改state里的数据</li></ul></li><li><p>mutations只能写什么样的代码?</p><ul><li>同步流程的代码</li></ul></li></ol><h3 id=7vuex-mutations使用>7.vuex-mutations使用<a hidden class=anchor aria-hidden=true href=#7vuex-mutations使用>#</a></h3><h4 id=目标-6>目标<a hidden class=anchor aria-hidden=true href=#目标-6>#</a></h4><ul><li>使用mutations2种方式</li><li>mutations注意事项</li></ul><h4 id=使用mutations的2种方式>使用mutations的2种方式<a hidden class=anchor aria-hidden=true href=#使用mutations的2种方式>#</a></h4><ul><li><p>方式1: 组件内 - <strong>直接</strong>使用</p><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>commit</span><span class=p>(</span><span class=s2>&#34;mutations里的函数名&#34;</span><span class=p>,</span> <span class=nx>具体值</span><span class=p>)</span>
</span></span></code></pre></div></li><li><p>方式2: 组件内 - <strong>映射</strong>使用</p><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// 1. 拿到mapMutations辅助函数
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>mapMutations</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 2. 把mutations里方法映射到原地
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>...</span><span class=nx>mapMutations</span><span class=p>([</span><span class=s1>&#39;mutations里的函数名&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul><h4 id=additem直接用-1>AddItem直接用<a hidden class=anchor aria-hidden=true href=#additem直接用-1>#</a></h4><ul><li>点击事件绑定</li><li>提交mutations传入值</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;addFn&#34;</span><span class=p>&gt;</span><span class=na>库存</span><span class=err>+</span><span class=na>1</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>addFn</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>commit</span><span class=p>(</span><span class=s1>&#39;addCount&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=appvue直接用-1>App.vue直接用<a hidden class=anchor aria-hidden=true href=#appvue直接用-1>#</a></h4><ul><li>触发计算属性的set方法</li><li>提交mutations传入值</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>span</span><span class=p>&gt;</span><span class=nx>库存总数</span><span class=o>:</span> <span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=nt>v-model</span><span class=o>=</span><span class=s>&#34;count&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>computed</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>count</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>set</span><span class=p>(</span><span class=nx>val</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>commit</span><span class=p>(</span><span class=s1>&#39;setCount&#39;</span><span class=p>,</span> <span class=nx>val</span><span class=p>)</span> <span class=c1>// 把表单值提交给store下的mutations
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>get</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>count</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=subitem映射用-1>SubItem映射用<a hidden class=anchor aria-hidden=true href=#subitem映射用-1>#</a></h4><ul><li>点击事件</li><li>映射mutations的方法</li><li>调用mutations方法传值</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;subFn&#34;</span><span class=p>&gt;</span><span class=na>库存</span><span class=nt>-1</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>// 需求2: 映射mutations到方法里
</span></span></span><span class=line><span class=cl><span class=c1>// 1. 拿到辅助函数 mapMutations
</span></span></span><span class=line><span class=cl><span class=c1>// 2. 在methods内, ...mapMutations([&#39;mutations函数名&#39;])
</span></span></span><span class=line><span class=cl><span class=c1>// 3. 当普通方法使用
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>mapMutations</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span><span class=nx>mapMutations</span><span class=p>([</span><span class=s1>&#39;subCount&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>    <span class=nx>subFn</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>subCount</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=注意-2>注意<a hidden class=anchor aria-hidden=true href=#注意-2>#</a></h4><blockquote><p>mutations函数上, 只能接收<strong>一个参数值</strong>, 如果传对个, 请传一个对象</p></blockquote><h4 id=小结-6>小结<a hidden class=anchor aria-hidden=true href=#小结-6>#</a></h4><ol><li><p>mutations有哪2种使用方式?</p><p>直接使用 this.$store.commit()</p><p>映射使用 mapMutations把方法映射到组件内直接调用</p></li><li><p>state, mutations, 视图组件, 3个关系是什么?</p></li></ol><p><img loading=lazy src=https://qiniu.waite.wang/202312242355165.png></p><h3 id=8vuex-actions定义-异步修改>8.vuex-actions定义-异步修改<a hidden class=anchor aria-hidden=true href=#8vuex-actions定义-异步修改>#</a></h3><h4 id=目标-7>目标<a hidden class=anchor aria-hidden=true href=#目标-7>#</a></h4><ul><li>定义actions</li></ul><h4 id=定义actions>定义actions<a hidden class=anchor aria-hidden=true href=#定义actions>#</a></h4><p>在store/index.js定义actions</p><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>const store = new Vuex.Store({
</span></span></span><span class=line><span class=cl><span class=cm> actions: {
</span></span></span><span class=line><span class=cl><span class=cm>  函数名 (store, 可选值) {
</span></span></span><span class=line><span class=cl><span class=cm>   // 异步代码, 把结果commit给mutations给state赋值
</span></span></span><span class=line><span class=cl><span class=cm>  }
</span></span></span><span class=line><span class=cl><span class=cm> }
</span></span></span><span class=line><span class=cl><span class=cm>})
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>具体代码:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>store</span>  <span class=o>=</span> <span class=k>new</span> <span class=nx>Vuex</span><span class=p>.</span><span class=nx>Store</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...省略state和mutations此处
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>actions</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>asyncAddCount</span><span class=p>(</span><span class=nx>store</span><span class=p>,</span> <span class=nx>num</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=c1>// 1秒后, 异步提交给add的mutations
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>store</span><span class=p>.</span><span class=nx>commit</span><span class=p>(</span><span class=s1>&#39;addCount&#39;</span><span class=p>,</span> <span class=nx>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nx>asyncSubCount</span><span class=p>(</span><span class=nx>store</span><span class=p>,</span> <span class=nx>num</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=c1>// 1秒后, 异步提交给sub的mutations
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>store</span><span class=p>.</span><span class=nx>commit</span><span class=p>(</span><span class=s1>&#39;subCount&#39;</span><span class=p>,</span> <span class=nx>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h4 id=小结-7>小结<a hidden class=anchor aria-hidden=true href=#小结-7>#</a></h4><ol><li><p>actions和mutations区别?</p><p>mutations里同步修改state</p><p>actions里放入异步操作</p></li><li><p>actions是否能操作state?</p><p>不建议, 要commit给mutations(为调试工具可追踪)</p></li><li><p>actions和mutations里函数, 第一个形参分别是什么?</p><p>mutations的是state</p><p>actions的是store</p></li></ol><h3 id=9vuex-actions使用>9.vuex-actions使用<a hidden class=anchor aria-hidden=true href=#9vuex-actions使用>#</a></h3><h4 id=目标-8>目标<a hidden class=anchor aria-hidden=true href=#目标-8>#</a></h4><ul><li>使用actions</li></ul><h4 id=使用actions的2种方式>使用actions的2种方式<a hidden class=anchor aria-hidden=true href=#使用actions的2种方式>#</a></h4><ul><li><p>方式1: 组件内 - <strong>直接</strong>使用</p><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>dispatch</span><span class=p>(</span><span class=s1>&#39;actions函数名&#39;</span><span class=p>,</span> <span class=nx>具体值</span><span class=p>)</span>
</span></span></code></pre></div></li><li><p>方式2: 组件内 - <strong>映射</strong>使用</p><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// 1. 拿到mapActions辅助函数
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>mapActions</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 2. 把actions里方法映射到原地
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>...</span><span class=nx>mapActions</span><span class=p>([</span><span class=s1>&#39;actions里的函数名&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul><h4 id=additem直接用-2>AddItem直接用<a hidden class=anchor aria-hidden=true href=#additem直接用-2>#</a></h4><ul><li>点击事件</li><li>dispatch触发action</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;asyncAddFn&#34;</span><span class=p>&gt;</span><span class=na>延迟1秒</span><span class=err>,</span> <span class=na>库存</span><span class=err>+</span><span class=na>5</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>asyncAddFn</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>dispatch</span><span class=p>(</span><span class=s1>&#39;asyncAddCount&#39;</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=subitem映射用-2>SubItem映射用<a hidden class=anchor aria-hidden=true href=#subitem映射用-2>#</a></h4><ul><li>点击事件</li><li>映射actions的方法</li><li>调用actions的方法传值</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;asyncSubFn&#34;</span><span class=p>&gt;</span><span class=na>延迟1秒</span><span class=err>,</span> <span class=na>库存</span><span class=nt>-5</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>// 需求3: 映射actions到方法里
</span></span></span><span class=line><span class=cl><span class=c1>// 1. 拿到辅助函数 mapActions
</span></span></span><span class=line><span class=cl><span class=c1>// 2. 在methods内, ...mapActions([&#39;actions函数名&#39;])
</span></span></span><span class=line><span class=cl><span class=c1>// 3. 当普通方法使用
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>mapActions</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span><span class=nx>mapActions</span><span class=p>([</span><span class=s1>&#39;asyncSubCount&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>    <span class=nx>asyncSubFn</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>asyncSubCount</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=小结-8>小结<a hidden class=anchor aria-hidden=true href=#小结-8>#</a></h4><ol><li><p>actions使用方式?</p><p>方式1: this.$store.dispatch(&lsquo;actions方法名字&rsquo;, 值)</p><p>方式2: &mldr;mapActions([&lsquo;actions里的方法名&rsquo;]) 映射到原地使用</p></li><li><p>视图组件, state, mutations, actions的关系是?</p></li></ol><p><img loading=lazy src=https://qiniu.waite.wang/202312242356106.png></p><h3 id=10vuex-重构购物车-准备store>10.vuex-重构购物车-准备Store<a hidden class=anchor aria-hidden=true href=#10vuex-重构购物车-准备store>#</a></h3><h4 id=目标-9>目标<a hidden class=anchor aria-hidden=true href=#目标-9>#</a></h4><ul><li>在现有项目如何集成vuex</li></ul><h4 id=store准备>store准备<a hidden class=anchor aria-hidden=true href=#store准备>#</a></h4><ol><li>复制预习资料&lt;shopcar-模板>到自己今天文件夹下</li><li>下载vuex</li><li>store/index.js创建导出store对象</li><li>main.js把store引入, 然后注入到Vue实例</li></ol><h4 id=小结-9>小结<a hidden class=anchor aria-hidden=true href=#小结-9>#</a></h4><ol><li><p>现有项目如何集成vuex</p><p>下载vuex</p><p>创建store对象并注入到Vue实例中</p></li></ol><h3 id=11vuex-重构购物车-配置项上午结束>11.vuex-重构购物车-配置项(上午结束)<a hidden class=anchor aria-hidden=true href=#11vuex-重构购物车-配置项上午结束>#</a></h3><h4 id=目标-10>目标<a hidden class=anchor aria-hidden=true href=#目标-10>#</a></h4><ul><li>准备state和mutations还有actions</li></ul><h4 id=配置项准备>配置项准备<a hidden class=anchor aria-hidden=true href=#配置项准备>#</a></h4><ol><li>定义state - 保存商品列表数组</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>state</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>goodsList</span><span class=o>:</span> <span class=p>[]</span> <span class=c1>// 列表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><ol start=2><li>定义mutations - 给state里变量赋值</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>mutations</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>setGoodsList</span><span class=p>(</span><span class=nx>state</span><span class=p>,</span> <span class=nx>newList</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>state</span><span class=p>.</span><span class=nx>goodsList</span> <span class=o>=</span> <span class=nx>newList</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ol start=3><li>定义actions - 异步请求数据提交给mutations</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>actions</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>asyncGetGoodsList</span><span class=p>(</span><span class=nx>store</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=sb>`https://www.escook.cn/api/cart`</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 发送异步请求
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>res</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>({</span> <span class=nx>url</span><span class=o>:</span> <span class=nx>url</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=nx>store</span><span class=p>.</span><span class=nx>commit</span><span class=p>(</span><span class=s1>&#39;setGoodsList&#39;</span><span class=p>,</span> <span class=nx>res</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>list</span><span class=p>)</span> <span class=c1>// 提交mutation修改state中的数据
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=appvue使用vuex>App.vue使用vuex<a hidden class=anchor aria-hidden=true href=#appvue使用vuex>#</a></h4><ul><li>把vuex商品数组映射回来使用</li><li>网络请求调用actions方法</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>mapState</span><span class=p>,</span> <span class=nx>mapActions</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>computed</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span><span class=nx>mapState</span><span class=p>({</span><span class=nx>list</span><span class=o>:</span> <span class=s1>&#39;goodsList&#39;</span><span class=p>})</span> <span class=c1>// 自定义原地属性名list, 映射vuex里的goodsList变量值
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>created</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>asyncGetGoodsList</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span><span class=nx>mapActions</span><span class=p>([</span><span class=s1>&#39;asyncGetGoodsList&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>    <span class=nx>allFn</span><span class=p>(</span><span class=nx>bool</span><span class=p>){</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>list</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>obj</span> <span class=p>=&gt;</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>goods_state</span> <span class=o>=</span> <span class=nx>bool</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=小结-10>小结<a hidden class=anchor aria-hidden=true href=#小结-10>#</a></h4><ol><li><p>mapState可以改变映射到原地的计算属性名吗?</p><p>可以的, 格式&mldr;mapState({&lsquo;&lsquo;计算属性名&rsquo;, &lsquo;state里要映射的变量名&rsquo;})</p></li></ol><h3 id=12vuex-getters定义-计算属性>12.vuex-getters定义-计算属性<a hidden class=anchor aria-hidden=true href=#12vuex-getters定义-计算属性>#</a></h3><h4 id=目标-11>目标<a hidden class=anchor aria-hidden=true href=#目标-11>#</a></h4><ul><li>getters概念</li><li>定义getters</li></ul><h4 id=getters概念>getters概念<a hidden class=anchor aria-hidden=true href=#getters概念>#</a></h4><p>vuex身上的全局状态-计算属性, 类似于computed</p><p>getters 依赖于 state中原始数据的变化，并返回计算后的新数据</p><h4 id=定义getters>定义getters<a hidden class=anchor aria-hidden=true href=#定义getters>#</a></h4><p>在store/index.js定义getters</p><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>const store = new Vuex.Store({
</span></span></span><span class=line><span class=cl><span class=cm> getters: {
</span></span></span><span class=line><span class=cl><span class=cm>  计算属性名 (state) {
</span></span></span><span class=line><span class=cl><span class=cm>   return 值给计算属性
</span></span></span><span class=line><span class=cl><span class=cm>  }
</span></span></span><span class=line><span class=cl><span class=cm> }
</span></span></span><span class=line><span class=cl><span class=cm>})
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></div><p>具体代码</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Vuex</span><span class=p>.</span><span class=nx>Store</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...省略其他
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>getters</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>allCount</span><span class=p>(</span><span class=nx>state</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>state</span><span class=p>.</span><span class=nx>goodsList</span><span class=p>.</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>sum</span><span class=p>,</span> <span class=nx>obj</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>obj</span><span class=p>.</span><span class=nx>goods_state</span> <span class=o>===</span> <span class=kc>true</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// 选中商品才累加数量
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=nx>sum</span> <span class=o>+=</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>goods_count</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>sum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nx>allPrice</span><span class=p>(</span><span class=nx>state</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>state</span><span class=p>.</span><span class=nx>goodsList</span><span class=p>.</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>sum</span><span class=p>,</span> <span class=nx>obj</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>obj</span><span class=p>.</span><span class=nx>goods_state</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>sum</span> <span class=o>+=</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>goods_count</span> <span class=o>*</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>goods_price</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>sum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h4 id=小结-11>小结<a hidden class=anchor aria-hidden=true href=#小结-11>#</a></h4><ol><li><p>getters有什么用?</p><p>vuex里的计算属性, 属于全局计算属性, 类似computed</p></li></ol><h3 id=13vuex-getters使用>13.vuex-getters使用<a hidden class=anchor aria-hidden=true href=#13vuex-getters使用>#</a></h3><h4 id=目标-12>目标<a hidden class=anchor aria-hidden=true href=#目标-12>#</a></h4><ul><li>组件内使用getters</li></ul><h4 id=使用getters的2种方式>使用getters的2种方式<a hidden class=anchor aria-hidden=true href=#使用getters的2种方式>#</a></h4><ul><li><p>方式1: 组件内 - <strong>直接</strong>使用</p><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>getters</span><span class=p>.</span><span class=nx>计算属性名</span>
</span></span></code></pre></div></li><li><p>方式2: 组件内 - <strong>映射</strong>使用</p><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// 1. 拿到mapGetters辅助函数
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>mapGetters</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>computed</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 2. 把getters里属性映射到原地
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=p>...</span><span class=nx>mapGetters</span><span class=p>([</span><span class=s1>&#39;getters里的计算属性名&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>   
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul><h4 id=myfootervue里使用>MyFooter.vue里使用<a hidden class=anchor aria-hidden=true href=#myfootervue里使用>#</a></h4><ul><li>使用2种方式给计算属性值</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>mapGetters</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>computed</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>allCount</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>     <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>getters</span><span class=p>.</span><span class=nx>allCount</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span><span class=nx>mapGetters</span><span class=p>([</span><span class=s1>&#39;allPrice&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=小结-12>小结<a hidden class=anchor aria-hidden=true href=#小结-12>#</a></h4><ol><li><p>getters如何使用?</p><p>方式1: this.$store.getters.计算属性名</p><p>方式2: &mldr;mapGetters([&lsquo;getters里计算属性名&rsquo;])</p></li></ol><h3 id=14vuex-modules定义-分模块>14.vuex-modules定义-分模块<a hidden class=anchor aria-hidden=true href=#14vuex-modules定义-分模块>#</a></h3><h4 id=目标-13>目标<a hidden class=anchor aria-hidden=true href=#目标-13>#</a></h4><ul><li>为何要分模块</li><li>modules定义</li></ul><h4 id=为何分模块>为何分模块<a hidden class=anchor aria-hidden=true href=#为何分模块>#</a></h4><p><img loading=lazy src=https://qiniu.waite.wang/202312242359431.png></p><h4 id=代码上的对比>代码上的对比<a hidden class=anchor aria-hidden=true href=#代码上的对比>#</a></h4><p><img loading=lazy src=https://qiniu.waite.wang/202312242357170.png></p><h4 id=创建modules模块对象>创建modules模块对象<a hidden class=anchor aria-hidden=true href=#创建modules模块对象>#</a></h4><ul><li>新建store/modules/user.js</li><li>新建store/modules/cart.js</li></ul><p>语法: 对象里包含5个核心概念, 只有state变成函数形式</p><p>user.js - 用户模块对象</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// 用户模块对象
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>userModule</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>state</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>age</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>sex</span><span class=o>:</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>mutations</span><span class=o>:</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>    <span class=nx>actions</span><span class=o>:</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>    <span class=nx>getters</span><span class=o>:</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>userModule</span>
</span></span></code></pre></div><p>cart.js - 购物车模块对象</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// 购物车模块对象
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=nx>axios</span> <span class=nx>from</span> <span class=s1>&#39;axios&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cartModule</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>state</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>goodsList</span><span class=o>:</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>mutations</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>setGoodsList</span><span class=p>(</span><span class=nx>state</span><span class=p>,</span> <span class=nx>newList</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>state</span><span class=p>.</span><span class=nx>goodsList</span> <span class=o>=</span> <span class=nx>newList</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>actions</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>async</span> <span class=nx>asyncGetGoodsList</span><span class=p>(</span><span class=nx>store</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=sb>`https://www.escook.cn/api/cart`</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 发送异步请求
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kr>const</span> <span class=nx>res</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>({</span> <span class=nx>url</span><span class=o>:</span> <span class=nx>url</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=nx>store</span><span class=p>.</span><span class=nx>commit</span><span class=p>(</span><span class=s1>&#39;setGoodsList&#39;</span><span class=p>,</span> <span class=nx>res</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>list</span><span class=p>)</span> <span class=c1>// 提交mutation修改state中的数据
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>getters</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>allCount</span><span class=p>(</span><span class=nx>state</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>state</span><span class=p>.</span><span class=nx>goodsList</span><span class=p>.</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>sum</span><span class=p>,</span> <span class=nx>obj</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>obj</span><span class=p>.</span><span class=nx>goods_state</span> <span class=o>===</span> <span class=kc>true</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// 选中商品才累加数量
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=nx>sum</span> <span class=o>+=</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>goods_count</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>sum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nx>allPrice</span><span class=p>(</span><span class=nx>state</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>state</span><span class=p>.</span><span class=nx>goodsList</span><span class=p>.</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>sum</span><span class=p>,</span> <span class=nx>obj</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>obj</span><span class=p>.</span><span class=nx>goods_state</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>sum</span> <span class=o>+=</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>goods_count</span> <span class=o>*</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>goods_price</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>sum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>cartModule</span>
</span></span></code></pre></div><h4 id=定义modules>定义modules<a hidden class=anchor aria-hidden=true href=#定义modules>#</a></h4><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>modules</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>模块名</span><span class=o>:</span> <span class=nx>模块对象</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>把2个模块对象, 引回到store里注册</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Vue</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Vuex</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>cartModule</span> <span class=nx>from</span> <span class=s1>&#39;./modules/cart&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>userModule</span> <span class=nx>from</span> <span class=s1>&#39;./modules/user&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>Vue</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>Vuex</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Vuex</span><span class=p>.</span><span class=nx>Store</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>modules</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>user</span><span class=o>:</span> <span class=nx>userModule</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>cart</span><span class=o>:</span> <span class=nx>cartModule</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>store</span>
</span></span></code></pre></div><h4 id=小结-13>小结<a hidden class=anchor aria-hidden=true href=#小结-13>#</a></h4><ol><li><p>为什么分模块?</p><p>集中式管理项目过大, 变量过多, 会导致state臃肿, 难以维护</p></li><li><p>如何分模块?</p><p>定义<strong>模块对象</strong>, state变成函数返回对象形式, 每个模块都有state/mutations/actions/getters/modules</p></li><li><p>根store如何注册?</p><p>modules里 { 模块名: <strong>模块对象</strong> }</p></li></ol><h3 id=15分模块-影响state取值方式>15.分模块-影响state取值方式<a hidden class=anchor aria-hidden=true href=#15分模块-影响state取值方式>#</a></h3><h4 id=目的>目的<a hidden class=anchor aria-hidden=true href=#目的>#</a></h4><ul><li>只要分模块, state取值方式改变, 其他暂时不变</li></ul><h4 id=state使用方式修改>state使用方式修改<a hidden class=anchor aria-hidden=true href=#state使用方式修改>#</a></h4><ul><li><p>方式1: 组件内 - <strong>直接</strong>使用</p><p>原语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>变量名</span>
</span></span></code></pre></div><p>分模块后语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>模块名</span><span class=p>.</span><span class=nx>变量名</span>
</span></span></code></pre></div></li><li><p>方式2: 组件内 - <strong>映射</strong>使用</p><p>原语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>...</span><span class=nx>mapState</span><span class=p>([</span><span class=s1>&#39;state里变量名&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=p>...</span><span class=nx>mapState</span><span class=p>({</span><span class=s1>&#39;变量名&#39;</span><span class=o>:</span> <span class=s2>&#34;state里变量名&#34;</span><span class=p>})</span> <span class=c1>// 给映射过来的state起别的名字
</span></span></span></code></pre></div><p>分模块后语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>...</span><span class=nx>mapState</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;变量名&#39;</span><span class=o>:</span> <span class=nx>state</span> <span class=p>=&gt;</span> <span class=nx>state</span><span class=p>.</span><span class=nx>模块名</span><span class=p>.</span><span class=nx>变量名</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div></li></ul><h4 id=appvue-修改>App.vue-修改<a hidden class=anchor aria-hidden=true href=#appvue-修改>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>computed</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...mapState({list: &#39;goodsList&#39;}) // 本地属性名list, 映射vuex里的goodsList变量值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 方式1: 直接用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// list(){ // 这个list就是组件内普通的计算属性名
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//     return this.$store.state.cart.goodsList 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// }.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 方式2: 映射方式改变
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>...</span><span class=nx>mapState</span><span class=p>({</span><span class=s1>&#39;list&#39;</span><span class=o>:</span> <span class=nx>state</span> <span class=p>=&gt;</span> <span class=nx>state</span><span class=p>.</span><span class=nx>cart</span><span class=p>.</span><span class=nx>goodsList</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>},</span>
</span></span></code></pre></div><h4 id=小结-14>小结<a hidden class=anchor aria-hidden=true href=#小结-14>#</a></h4><ol><li><p>分模块对什么有影响?</p><p>对state的取值方式有影响, 对其他暂无影响</p></li><li><p>state如何取值?</p><p>在组件使用的时候, 要state.模块名.变量名</p></li></ol><h3 id=16分模块-命名空间>16.分模块-命名空间<a hidden class=anchor aria-hidden=true href=#16分模块-命名空间>#</a></h3><h4 id=目标-14>目标<a hidden class=anchor aria-hidden=true href=#目标-14>#</a></h4><ul><li>防止多个模块之间, mutations/actions/getters的名字冲突</li></ul><h4 id=开启命名空间>开启命名空间<a hidden class=anchor aria-hidden=true href=#开启命名空间>#</a></h4><p>在模块对象内设置<code>namespaced: true</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>moduleShopCar</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>namespaced</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>state</span> <span class=p>()</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>    <span class=nx>mutations</span><span class=o>:</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>    <span class=nx>actions</span><span class=o>:</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>    <span class=nx>getters</span><span class=o>:</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>    <span class=nx>modules</span><span class=o>:</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=state使用方式修改-1>state使用方式修改<a hidden class=anchor aria-hidden=true href=#state使用方式修改-1>#</a></h4><ul><li><p>直接使用无变化: this.$store.state.模块名.变量名</p></li><li><p>辅助函数需要遵守格式</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>...</span><span class=nx>mapState</span><span class=p>(</span><span class=s2>&#34;模块名&#34;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;state变量名&#39;</span><span class=p>])</span>
</span></span></code></pre></div></li></ul><h4 id=mutations使用方式修改>mutations使用方式修改<a hidden class=anchor aria-hidden=true href=#mutations使用方式修改>#</a></h4><ul><li><p>方式1: 组件内 - <strong>直接</strong>使用</p><ul><li><p>原语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>commit</span><span class=p>(</span><span class=s2>&#34;mutations里的函数名&#34;</span><span class=p>,</span> <span class=nx>具体值</span><span class=p>)</span>
</span></span></code></pre></div></li><li><p>开命名空间后语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>commit</span><span class=p>(</span><span class=s2>&#34;模块名/mutations里的函数名&#34;</span><span class=p>,</span> <span class=nx>具体值</span><span class=p>)</span>
</span></span></code></pre></div></li></ul></li><li><p>方式2: 组件内 - <strong>映射</strong>使用</p><ul><li><p>原语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>...</span><span class=nx>mapMutations</span><span class=p>([</span><span class=s1>&#39;mutations里方法名&#39;</span><span class=p>])</span>
</span></span></code></pre></div></li><li><p>开命名空间后语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>...</span><span class=nx>mapMutations</span><span class=p>(</span><span class=s2>&#34;模块名&#34;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;mutations里方法名&#39;</span><span class=p>])</span>
</span></span></code></pre></div></li></ul></li></ul><h4 id=actions使用方式修改>actions使用方式修改<a hidden class=anchor aria-hidden=true href=#actions使用方式修改>#</a></h4><ul><li><p>方式1: 组件内 - <strong>直接</strong>使用</p><ul><li><p>原语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>dispatch</span><span class=p>(</span><span class=s2>&#34;actions里的函数名&#34;</span><span class=p>,</span> <span class=nx>具体值</span><span class=p>)</span>
</span></span></code></pre></div></li><li><p>开命名空间后语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>dispatch</span><span class=p>(</span><span class=s2>&#34;模块名/actions里的函数名&#34;</span><span class=p>,</span> <span class=nx>具体值</span><span class=p>)</span>
</span></span></code></pre></div></li></ul></li><li><p>方式2: 组件内 - <strong>映射</strong>使用</p><ul><li><p>原语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>...</span><span class=nx>mapActions</span><span class=p>([</span><span class=s1>&#39;actions里方法名&#39;</span><span class=p>])</span>
</span></span></code></pre></div></li><li><p>开命名空间后语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>...</span><span class=nx>mapActions</span><span class=p>(</span><span class=s2>&#34;模块名&#34;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;actions里方法名&#39;</span><span class=p>])</span>
</span></span></code></pre></div></li></ul></li></ul><h4 id=getters使用方式修改>getters使用方式修改<a hidden class=anchor aria-hidden=true href=#getters使用方式修改>#</a></h4><ul><li><p>方式1: 组件内 - <strong>直接</strong>使用</p><ul><li><p>原语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>getters</span><span class=p>.</span><span class=nx>计算属性名</span>
</span></span></code></pre></div></li><li><p>开命名空间后语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>getters</span><span class=p>[</span><span class=s1>&#39;模块名/计算属性名&#39;</span><span class=p>]</span>
</span></span></code></pre></div></li></ul></li><li><p>方式2: 组件内 - <strong>映射</strong>使用</p><ul><li><p>原语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>...</span><span class=nx>mapGetters</span><span class=p>([</span><span class=s1>&#39;getters里计算属性名&#39;</span><span class=p>])</span>
</span></span></code></pre></div></li><li><p>开命名空间后语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>...</span><span class=nx>mapGetters</span><span class=p>(</span><span class=s2>&#34;模块名&#34;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;getters里计算属性名&#39;</span><span class=p>])</span>
</span></span></code></pre></div></li></ul></li></ul><h4 id=小结-15>小结<a hidden class=anchor aria-hidden=true href=#小结-15>#</a></h4><ol><li>state和mutations, 在根store和开启命名空间里的区别?</li></ol><p><img loading=lazy src=https://qiniu.waite.wang/202312250000713.png></p><ol start=2><li>整个vuex的体系是?</li></ol><p><img loading=lazy src=https://qiniu.waite.wang/202312250000731.png></p><h3 id=扩展-使用devtools调试vuex数据>扩展: 使用Devtools调试vuex数据<a hidden class=anchor aria-hidden=true href=#扩展-使用devtools调试vuex数据>#</a></h3><blockquote><p>优秀的调试工具可以使我们写程序事半功倍，最后我们再学习一下如果使用dev-tools来调试vuex中的数据，这也是数据可预测特性里不可缺少的一环</p></blockquote><h4 id=目标-15>目标<a hidden class=anchor aria-hidden=true href=#目标-15>#</a></h4><ul><li>掌握dev-tools调试vuex</li><li>理解什么是数据状态是可追踪的</li></ul><h2 id=vue3-vuex>Vue3-Vuex<a hidden class=anchor aria-hidden=true href=#vue3-vuex>#</a></h2><h3 id=vuex介绍>Vuex介绍<a hidden class=anchor aria-hidden=true href=#vuex介绍>#</a></h3><h4 id=vuex是什么-1>Vuex是什么<a hidden class=anchor aria-hidden=true href=#vuex是什么-1>#</a></h4><p>Vuex 是一个专为 Vue.js 应用程序开发的<strong>状态管理模式</strong>。它采用<strong>集中式</strong>存储管理数据，以相应的规则保证状态以一种可预测的方式发生变化
<img alt=在这里插入图片描述 loading=lazy src=https://qiniu.waite.wang/202312232248202.png></p><p>优点：</p><ol><li>能够在Vuex中集中管理共享的数居，易于开发和后期维护</li><li>能够高效地实现组件之间的数据共享，提高开发效率</li><li>存储在vuex中的数据都是响应式的，能够实时保持数据与页面的同步</li></ol><h4 id=vuex为何学-1>vuex为何学<a hidden class=anchor aria-hidden=true href=#vuex为何学-1>#</a></h4><p>程序页面多, 数据变量多</p><ol><li>不同组件数据<strong>保持同步</strong></li><li>数据的修改都是<strong>可追踪</strong></li></ol><p>一个户外商店有两名员工，张三和李四</p><p>一天的早上，他们分别对<strong>帐篷的数量</strong>做了一次盘点，发现一共有三个帐篷</p><p>张三卖出去俩个，他以为库存里还有<strong>一个</strong></p><p>李四卖出去一个，他以为库存里还有<strong>两个</strong></p><p>而事实上是，库存现在已经为<strong>零</strong></p><p>如果他们再接受客户的预订，就会出现库存<strong>不足</strong>的情况</p><blockquote><p>张三和李四因为没有保持库存的数量的同步导致了尴尬，这个就是所谓的<code>数据保持同步</code></p><p>店长需要知道, 谁卖出了多少个帐篷，这个行为我们称之为<code>数据修改是可追踪的</code></p></blockquote><p><img alt=image-20210601212946879 loading=lazy src=https://qiniu.waite.wang/202312241613856.png></p><h4 id=vuex中存什么-1>vuex中存什么<a hidden class=anchor aria-hidden=true href=#vuex中存什么-1>#</a></h4><p><strong>多个组件共享状态</strong>，才存储在vuex中</p><p>某个组件中的私有数据，依旧存储在data中</p><p>例如：</p><ul><li>登陆的用户名需要在<strong>首页</strong>, <strong>个人中心</strong>, <strong>结算</strong>页面使用, 用户名存在vuex中</li><li>文章详情数据, 只有在文章详情页查看, 在自身data中声明</li></ul><h3 id=基本使用>基本使用<a hidden class=anchor aria-hidden=true href=#基本使用>#</a></h3><ol><li>安装 vuex 依赖包</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>  npm install vuex --save
</span></span></code></pre></div><ol start=2><li>导入</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Vuex</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>Vuex</span><span class=p>)</span>
</span></span></code></pre></div><ol start=3><li>创建 store 对象</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Vuex</span><span class=p>.</span><span class=nx>Store</span><span class=p>({</span>
</span></span><span class=line><span class=cl> <span class=c1>// state 中存放的就是全局共享的数据
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>state</span><span class=o>:</span> <span class=p>{</span> <span class=nx>count</span><span class=o>:</span> <span class=mi>0</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><ol start=4><li>将 store 对象挂载到 vue 实例中</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>new</span> <span class=nx>Vue</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>el</span><span class=o>:</span> <span class=s1>&#39;#app&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>render</span><span class=o>:</span> <span class=nx>h</span> <span class=p>=&gt;</span> <span class=nx>h</span><span class=p>(</span><span class=nx>App</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>router</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 将创建的共享数据对象挂载到 Vue 实例中
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 所有的组件, 就可以直接从 store 中获取全局的数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}).</span><span class=nx>$mount</span><span class=p>(</span><span class=s1>&#39;#app&#39;</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Vue3
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>createApp</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>createStore</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 创建一个新的 store 实例
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span> <span class=nx>createStore</span><span class=p>({</span>
</span></span><span class=line><span class=cl> <span class=nx>state</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=nx>count</span><span class=o>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=p>},</span>
</span></span><span class=line><span class=cl> <span class=nx>mutations</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nx>increment</span> <span class=p>(</span><span class=nx>state</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=nx>state</span><span class=p>.</span><span class=nx>count</span><span class=o>++</span>
</span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>createApp</span><span class=p>({</span> <span class=cm>/* 根组件 */</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 将 store 实例作为插件安装
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>store</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=state>state<a hidden class=anchor aria-hidden=true href=#state>#</a></h3><blockquote><p>state是唯一的公共数据源，统一存储</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// store/index.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>createStore</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>// 配置 Vuex
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span> <span class=nx>createStore</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>state</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>text</span><span class=o>:</span> <span class=s1>&#39;我的博客 www.misterma.com&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>num</span><span class=o>:</span> <span class=mi>12</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>mutations</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>changeText</span><span class=p>(</span><span class=nx>state</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>state</span><span class=p>.</span><span class=nx>text</span> <span class=o>=</span> <span class=s1>&#39;github https://github.com/changbin1997&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>changeNum</span><span class=p>(</span><span class=nx>state</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>state</span><span class=p>.</span><span class=nx>num</span> <span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>store</span>
</span></span></code></pre></div><h4 id=使用>使用<a hidden class=anchor aria-hidden=true href=#使用>#</a></h4><ul><li>方式1: 组件内 - <strong>直接</strong>使用</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>变量名</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span><span class=nx>useStore</span><span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span> <span class=nx>useStore</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>store</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>变量名</span><span class=p>);</span>
</span></span></code></pre></div><ul><li>方式2: 组件内 - <strong>映射</strong>使用 (推荐)</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span><span class=nx>computed</span><span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>text</span> <span class=o>=</span> <span class=nx>computed</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>store</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>text</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>num</span> <span class=o>=</span> <span class=nx>computed</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>store</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>num</span><span class=p>);</span>
</span></span></code></pre></div><blockquote><p>state是响应式的, 只要state值变化, 页面上使用的地方会自动更新同步</p></blockquote><h3 id=mutations>mutations<a hidden class=anchor aria-hidden=true href=#mutations>#</a></h3><blockquote><p>Vuex Mutations 则是用于修改状态的函数。在 Vuex 中，状态是通过 store 对象进行管理的，而 Mutations 则是通过提交（commit）来执行的。每个 Mutation 都是一个纯函数，它接收 state 对象作为第一个参数，并且可以接收额外的参数作为载荷（payload）。Mutation 函数用于同步地改变状态，它们在开发过程中可以帮助我们跟踪状态的变化。</p></blockquote><p>在 Vue 3 中，Mutations 并不是唯一能修改 state 的地方。实际上，在 Vue 3 中，可以通过使用 Mutations、Actions 或直接操作 state 来修改状态。这是与 Vue 2 中的 Vuex 不同的地方。</p><p>在 Vue 3 中，可以使用 Mutations 来同步地改变状态，Actions 用于处理异步操作并提交 Mutations，而直接操作 state 则是为了简单的状态变化。这种方式使得状态管理更加灵活，并且能够更好地处理异步操作。</p><p>因此，在 Vue 3 中，Mutations 并不是唯一能修改 state 的地方，而是状态管理中的一部分，开发者可以根据具体情况选择合适的方式来修改状态。</p><blockquote><p>以下是一个 mutations 与 store 结合的例子</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=c>&lt;!--</span> <span class=nx>App</span><span class=p>.</span><span class=nx>vue</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--</span><span class=nx>输出</span> <span class=nx>store</span> <span class=nx>配置的</span> <span class=nx>text</span> <span class=nx>和</span> <span class=nx>num</span><span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;{{</span> <span class=nx>store</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>text</span> <span class=p>}}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;{{</span> <span class=nx>store</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>num</span> <span class=p>}}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>button</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;button&#34;</span> <span class=nt>@click</span><span class=s>=&#34;buttonClick&#34;</span><span class=p>&gt;</span><span class=na>更改</span> <span class=na>text</span> <span class=na>和</span> <span class=na>num</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>setup</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span><span class=nx>useStore</span><span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span> <span class=nx>useStore</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>buttonClick</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 更改 text 和 num
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>store</span><span class=p>.</span><span class=nx>commit</span><span class=p>(</span><span class=s1>&#39;changeText&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>store</span><span class=p>.</span><span class=nx>commit</span><span class=p>(</span><span class=s1>&#39;changeNum&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// store/index.js
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>createRouter</span><span class=p>,</span> <span class=nx>createWebHistory</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue-router&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/login&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;login&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;@/components/login.vue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/main&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;main&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;@/components/main.vue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>history</span><span class=o>:</span> <span class=nx>createWebHistory</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>  <span class=nx>routes</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>router</span>
</span></span></code></pre></div><h3 id=actions>actions<a hidden class=anchor aria-hidden=true href=#actions>#</a></h3><p>在 Vue 3 中，使用 Vuex 的 Actions 是一种处理异步操作并提交 Mutations 的方式。Actions 允许您在应用程序中执行异步操作，例如从服务器获取数据，然后再提交 Mutations 来修改状态。以下是在 Vue 3 中使用 Vuex Actions 的基本方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>store</span>  <span class=o>=</span> <span class=k>new</span> <span class=nx>Vuex</span><span class=p>.</span><span class=nx>Store</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...省略state和mutations此处
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>actions</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>asyncAddCount</span><span class=p>(</span><span class=nx>store</span><span class=p>,</span> <span class=nx>num</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=c1>// 1秒后, 异步提交给add的mutations
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>store</span><span class=p>.</span><span class=nx>commit</span><span class=p>(</span><span class=s1>&#39;addCount&#39;</span><span class=p>,</span> <span class=nx>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nx>asyncSubCount</span><span class=p>(</span><span class=nx>store</span><span class=p>,</span> <span class=nx>num</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=c1>// 1秒后, 异步提交给sub的mutations
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>store</span><span class=p>.</span><span class=nx>commit</span><span class=p>(</span><span class=s1>&#39;subCount&#39;</span><span class=p>,</span> <span class=nx>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h3 id=getters>getters<a hidden class=anchor aria-hidden=true href=#getters>#</a></h3><p>Vuex Getters 是用于从 store 中获取状态的函数。Getters 允许您在 store 中计算状态或过滤数据，并且可以在组件中像计算属性一样使用。以下是在 Vue 3 中定义和使用 Vuex Getters 的基本方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Vuex</span><span class=p>.</span><span class=nx>Store</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...省略其他
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>getters</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>allCount</span><span class=p>(</span><span class=nx>state</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>state</span><span class=p>.</span><span class=nx>goodsList</span><span class=p>.</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>sum</span><span class=p>,</span> <span class=nx>obj</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>obj</span><span class=p>.</span><span class=nx>goods_state</span> <span class=o>===</span> <span class=kc>true</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// 选中商品才累加数量
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=nx>sum</span> <span class=o>+=</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>goods_count</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>sum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nx>allPrice</span><span class=p>(</span><span class=nx>state</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>state</span><span class=p>.</span><span class=nx>goodsList</span><span class=p>.</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>sum</span><span class=p>,</span> <span class=nx>obj</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>obj</span><span class=p>.</span><span class=nx>goods_state</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>sum</span> <span class=o>+=</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>goods_count</span> <span class=o>*</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>goods_price</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>sum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h4 id=用getters的2种方式>用getters的2种方式<a hidden class=anchor aria-hidden=true href=#用getters的2种方式>#</a></h4><ul><li><p>方式1: 组件内 - <strong>直接</strong>使用</p><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>getters</span><span class=p>.</span><span class=nx>计算属性名</span>
</span></span></code></pre></div></li><li><p>方式2: 组件内 - <strong>映射</strong>使用</p><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 1. 拿到mapGetters辅助函数
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>mapGetters</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>computed</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 2. 把getters里属性映射到原地
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=p>...</span><span class=nx>mapGetters</span><span class=p>([</span><span class=s1>&#39;getters里的计算属性名&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>   
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul><h4 id=myfootervue里使用-1>MyFooter.vue里使用<a hidden class=anchor aria-hidden=true href=#myfootervue里使用-1>#</a></h4><ul><li>使用2种方式给计算属性值</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>script</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>mapGetters</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vuex&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>computed</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>allCount</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>     <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>$store</span><span class=p>.</span><span class=nx>getters</span><span class=p>.</span><span class=nx>allCount</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span><span class=nx>mapGetters</span><span class=p>([</span><span class=s1>&#39;allPrice&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=err>/script&gt;</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://waite.wang/tags/vue/>Vue</a></li><li><a href=https://waite.wang/tags/vuex/>VueX</a></li></ul><nav class=paginav><a class=prev href=https://waite.wang/posts/vue/system-learn-pinia-1/><span class=title>« 上一页</span><br><span>系统学习 Pinia</span>
</a><a class=next href=https://waite.wang/posts/vue/vue3-learn-2/><span class=title>下一页 »</span><br><span>Vue3 基本指令(二)</span></a></nav></footer><script src=https://utteranc.es/client.js repo=Waite0603/HugoBlog issue-term=pathname theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span><a href=https://beian.miit.gov.cn/ target=_blank rel="noopener noreferrer">粤ICP备2022028437号-1</a></span><br><span>Copyright &copy; 2018 - 2025 By <a href=https://waite.wang/>Waite</a>, All Rights
Reserved.</span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script src=/js/jquery-3.5.1.min.js></script><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery.fancybox.min.js></script></body></html>