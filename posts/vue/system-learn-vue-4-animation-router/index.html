<!doctype html><html lang=zh-cn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>系统学习 Vue -- 4. 动画和路由 | 隶笔难书</title><meta name=keywords content="Vue"><meta name=description content="Vue 学习笔记-Vue 动画和路由"><meta name=author content="Waite Wang"><link rel=canonical href=https://waite.wang/posts/vue/system-learn-vue-4-animation-router/><link crossorigin=anonymous href=/assets/css/stylesheet.1f25c954b6964bfd120383618e0c76f5d98627118274109d51919206cab78c1e.css integrity="sha256-HyXJVLaWS/0SA4Nhjgx29dmGJxGCdBCdUZGSBsq3jB4=" rel="preload stylesheet" as=style><link rel=icon href=https://waite.wang/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://waite.wang/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://waite.wang/favicon-32x32.png><link rel=apple-touch-icon href=https://waite.wang/apple-touch-icon.png><link rel=mask-icon href=https://waite.wang/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-cn href=https://waite.wang/posts/vue/system-learn-vue-4-animation-router/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://waite.wang/posts/vue/system-learn-vue-4-animation-router/"><meta property="og:site_name" content="隶笔难书"><meta property="og:title" content="系统学习 Vue -- 4. 动画和路由"><meta property="og:description" content="Vue 学习笔记-Vue 动画和路由"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-11T21:05:54+08:00"><meta property="article:modified_time" content="2023-03-22T21:05:54+08:00"><meta property="article:tag" content="Vue"><meta name=twitter:card content="summary"><meta name=twitter:title content="系统学习 Vue -- 4. 动画和路由"><meta name=twitter:description content="Vue 学习笔记-Vue 动画和路由"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://waite.wang/posts/"},{"@type":"ListItem","position":2,"name":"系统学习 Vue -- 4. 动画和路由","item":"https://waite.wang/posts/vue/system-learn-vue-4-animation-router/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"系统学习 Vue -- 4. 动画和路由","name":"系统学习 Vue -- 4. 动画和路由","description":"Vue 学习笔记-Vue 动画和路由","keywords":["Vue"],"articleBody":"Vue 过渡与动画初体验 认识动画 在开发中，我们想要给一个组件的显示和消失添加某种过渡动画，可以很好的增加用户体验： React框架本身并没有提供任何动画相关的API，所以在React中使用过渡动画我们需要使用一个第三方库 react-transition-group； Vue中为我们提供一些内置组件和对应的API来完成动画，利用它们我们可以方便的实现过渡动画效果； 我们来看一个案例： Hello World的显示和隐藏； 通过下面的代码实现，是不会有任何动画效果的； \u003ctemplate\u003e \u003cdiv\u003e \u003cbutton @click=\"toggle\"\u003e显示/隐藏\u003c/button\u003e \u003ch2 v-if=\"show\"\u003eApp组件\u003c/h2\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript\u003e export default { data() { return { show: true } }, methods: { toggle() { this.show = !this.show; } } } \u003c/script\u003e 没有动画的情况下，整个内容的显示和隐藏会非常的生硬： 如果我们希望给单元素或者组件实现过渡动画，可以使用 transition内置组件来完成动画； Vue的 transition 动画 https://cn.vuejs.org/guide/built-ins/transition.html#transition\n会在一个元素或组件进入和离开 DOM 时应用动画。\n是一个内置组件，这意味着它在任意别的组件中都可以被使用，无需注册。它可以将进入和离开动画应用到通过默认插槽传递给它的元素或组件上。进入或离开可以由以下的条件之一触发：\n由 v-if 所触发的切换 由 v-show 所触发的切换 由特殊元素 切换的动态组件 改变特殊的 key 属性 以下是最基本用法的示例：\n\u003cbutton @click=\"show = !show\"\u003eToggle\u003c/button\u003e \u003cTransition\u003e \u003cp v-if=\"show\"\u003ehello\u003c/p\u003e \u003c/Transition\u003e /* 下面我们会解释这些 class 是做什么的 */ .v-enter-active, .v-leave-active { transition: opacity 0.5s ease; } .v-enter-from, .v-leave-to { opacity: 0; } 仅支持单个元素或组件作为其插槽内容。如果内容是一个组件，这个组件必须仅有一个根元素。\n当一个 组件中的元素被插入或移除时，会发生下面这些事情：\nVue 会自动检测目标元素是否应用了 CSS 过渡或动画。如果是，则一些 CSS 过渡 class 会在适当的时机被添加和移除。 如果有作为监听器的 JavaScript 钩子，这些钩子函数会在适当时机被调用。 如果没有探测到 CSS 过渡或动画、也没有提供 JavaScript 钩子，那么 DOM 的插入、删除操作将在浏览器的下一个动画帧后执行。 基于 CSS 的过渡效果 CSS 过渡 class 一共有 6 个应用于进入与离开过渡效果的 CSS class。\nv-enter-from：进入动画的起始状态。在元素插入之前添加，在元素插入完成后的下一帧移除。 v-enter-active：进入动画的生效状态。应用于整个进入动画阶段。在元素被插入之前添加，在过渡或动画完成之后移除。这个 class 可以被用来定义进入动画的持续时间、延迟与速度曲线类型。 v-enter-to：进入动画的结束状态。在元素插入完成后的下一帧被添加 (也就是 v-enter-from 被移除的同时)，在过渡或动画完成之后移除。 v-leave-from：离开动画的起始状态。在离开过渡效果被触发时立即添加，在一帧后被移除。 v-leave-active：离开动画的生效状态。应用于整个离开动画阶段。在离开过渡效果被触发时立即添加，在过渡或动画完成之后移除。这个 class 可以被用来定义离开动画的持续时间、延迟与速度曲线类型。 v-leave-to：离开动画的结束状态。在一个离开动画被触发后的下一帧被添加 (也就是 v-leave-from 被移除的同时)，在过渡或动画完成之后移除。 为过渡效果命名 我们可以给 组件传一个 name prop 来声明一个过渡效果名：\n\u003cTransition name=\"fade\"\u003e ... \u003c/Transition\u003e 对于一个有名字的过渡效果，对它起作用的过渡 class 会以其名字而不是 v 作为前缀。比如，上方例子中被应用的 class 将会是 fade-enter-active 而不是 v-enter-active。这个“fade”过渡的 class 应该是这样：\n.fade-enter-active, .fade-leave-active { transition: opacity 0.5s ease; } .fade-enter-from, .fade-leave-to { opacity: 0; } CSS 的 transition 一般都会搭配 原生 CSS 过渡一起使用，正如你在上面的例子中所看到的那样。这个 transition CSS 属性是一个简写形式，使我们可以一次定义一个过渡的各个方面，包括需要执行动画的属性、持续时间和 速度曲线。\n下面是一个更高级的例子，它使用了不同的持续时间和速度曲线来过渡多个属性：\n\u003cTransition name=\"slide-fade\"\u003e \u003cp v-if=\"show\"\u003ehello\u003c/p\u003e \u003c/Transition\u003e /* 进入和离开动画可以使用不同 持续时间和速度曲线。 */ .slide-fade-enter-active { transition: all 0.3s ease-out; } .slide-fade-leave-active { transition: all 0.8s cubic-bezier(1, 0.5, 0.8, 1); } .slide-fade-enter-from, .slide-fade-leave-to { transform: translateX(20px); opacity: 0; } CSS 的 animation 帧动画, 可以指定在什么时间是什么状态!\n原生 CSS 动画和 CSS transition 的应用方式基本上是相同的，只有一点不同，那就是 *-enter-from 不是在元素插入后立即移除，而是在一个 animationend 事件触发时被移除。\n对于大多数的 CSS 动画，我们可以简单地在 *-enter-active 和 *-leave-active class 下声明它们。下面是一个示例：\n\u003cTransition name=\"bounce\"\u003e \u003cp v-if=\"show\" style=\"text-align: center;\"\u003e Hello here is some bouncy text! \u003c/p\u003e \u003c/Transition\u003e .bounce-enter-active { animation: bounce-in 0.5s; } .bounce-leave-active { animation: bounce-in 0.5s reverse; } @keyframes bounce-in { 0% { transform: scale(0); } 50% { transform: scale(1.25); } 100% { transform: scale(1); } } 自定义过渡 class 你也可以向 传递以下的 props 来指定自定义的过渡 class：\nenter-from-class enter-active-class enter-to-class leave-from-class leave-active-class leave-to-class 他们的优先级高于普通的类名，这对于 Vue 的过渡系统和其他第三方 CSS 动画库，如 Animate.css.\n你传入的这些 class 会覆盖相应阶段的默认 class 名。这个功能在你想要在 Vue 的动画机制下集成其他的第三方 CSS 动画库时非常有用，比如 Animate.css：\n\u003cscript\u003e export default { data() { return { show: true } } } \u003c/script\u003e \u003ctemplate\u003e \u003cbutton @click=\"show = !show\"\u003eToggle\u003c/button\u003e \u003cTransition name=\"custom-classes\" enter-active-class=\"animate__animated animate__tada\" leave-active-class=\"animate__animated animate__bounceOutRight\" \u003e \u003cp v-if=\"show\"\u003ehello\u003c/p\u003e \u003c/Transition\u003e \u003c/template\u003e \u003cstyle\u003e @import \"https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css\"; \u003c/style\u003e 同时设置过渡和动画 Vue为了知道过渡的完成，内部是在监听 transitionend或 animationend，到底使用哪一个取决于元素应用的 CSS规则： 如果我们只是使用了其中的一个，那么Vue能自动识别类型并设置监听； 但是如果我们同时使用了过渡和动画呢？ 并且在这个情况下可能某一个动画执行结束时，另外一个动画还没有结束； 在这种情况下，我们可以设置 type 属性为 animation 或者 transition 来明确的告知Vue监听的类型； \u003cTransition type=\"animation\"\u003e...\u003c/Transition\u003e 深层级过渡与显式过渡时长 尽管过渡 class 仅能应用在 的直接子元素上，我们还是可以使用深层级的 CSS 选择器，在深层级的元素上触发过渡效果。\n\u003cTransition name=\"nested\"\u003e \u003cdiv v-if=\"show\" class=\"outer\"\u003e \u003cdiv class=\"inner\"\u003e Hello \u003c/div\u003e \u003c/div\u003e \u003c/Transition\u003e /* 应用于嵌套元素的规则 */ .nested-enter-active .inner, .nested-leave-active .inner { transition: all 0.3s ease-in-out; } .nested-enter-from .inner, .nested-leave-to .inner { transform: translateX(30px); opacity: 0; } /* ... 省略了其他必要的 CSS */ 我们甚至可以在深层元素上添加一个过渡延迟，从而创建一个带渐进延迟的动画序列：\n/* 延迟嵌套元素的进入以获得交错效果 */ .nested-enter-active .inner { transition-delay: 0.25s; } 然而，这会带来一个小问题。默认情况下， 组件会通过监听过渡根元素上的第一个 transitionend 或者 animationend 事件来尝试自动判断过渡何时结束。而在嵌套的过渡中，期望的行为应该是等待所有内部元素的过渡完成。\n在这种情况下，你可以通过向 组件传入 duration prop 来显式指定过渡的持续时间 (以毫秒为单位)。总持续时间应该匹配延迟加上内部元素的过渡持续时间：\n\u003cTransition :duration=\"550\"\u003e...\u003c/Transition\u003e 如果有必要的话，你也可以用对象的形式传入，分开指定进入和离开所需的时间：\n\u003cTransition :duration=\"{ enter: 500, leave: 800 }\"\u003e...\u003c/Transition\u003e 过渡模式 在之前的例子中，进入和离开的元素都是在同时开始动画的，因此我们不得不将它们设为 position: absolute 以避免二者同时存在时出现的布局问题。\n然而，很多情况下这可能并不符合需求。我们可能想要先执行离开动画，然后在其完成之后再执行元素的进入动画。手动编排这样的动画是非常复杂的，好在我们可以通过向 传入一个 mode prop 来实现这个行为：\n\u003cTransition mode=\"out-in\"\u003e ... \u003c/Transition\u003e 也支持 mode=\"in-out\"，虽然这并不常用。\n也可以作用于 动态组件之间的切换：\n\u003cTransition name=\"fade\" mode=\"out-in\"\u003e \u003ccomponent :is=\"activeComponent\"\u003e\u003c/component\u003e \u003c/Transition\u003e 出现时过渡 如果你想在某个节点初次渲染时应用一个过渡效果，你可以添加 appear prop：\n\u003cTransition appear\u003e ... \u003c/Transition\u003e 元素间过渡 除了通过 v-if / v-show 切换一个元素，我们也可以通过 v-if / v-else / v-else-if 在几个组件间进行切换，只要确保任一时刻只会有一个元素被渲染即可：\n\u003cTransition\u003e \u003cbutton v-if=\"docState === 'saved'\"\u003eEdit\u003c/button\u003e \u003cbutton v-else-if=\"docState === 'edited'\"\u003eSave\u003c/button\u003e \u003cbutton v-else-if=\"docState === 'editing'\"\u003eCancel\u003c/button\u003e \u003c/Transition\u003e 示例 \u003ctemplate\u003e \u003cdiv class=\"app\"\u003e \u003cdiv\u003e\u003cbutton @click=\"isShow = !isShow\"\u003e显示/隐藏\u003c/button\u003e\u003c/div\u003e \u003ctransition name=\"why\" mode=\"out-in\" appear\u003e \u003ccomponent :is=\"isShow ? 'home': 'about'\"\u003e\u003c/component\u003e \u003c/transition\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript\u003e import Home from './pages/Home.vue'; import About from './pages/About.vue'; export default { components: { Home, About }, data() { return { isShow: true } } } \u003c/script\u003e \u003cstyle scoped\u003e .app { width: 200px; margin: 0 auto; } .title { display: inline-block; } .why-enter-from, .why-leave-to { opacity: 0; } .why-enter-active, .why-leave-active { transition: opacity 1s ease; } .why-enter-active { animation: bounce 1s ease; } .why-leave-active { animation: bounce 1s ease reverse; } @keyframes bounce { 0% { transform: scale(0) } 50% { transform: scale(1.2); } 100% { transform: scale(1); } } \u003c/style\u003e JavaScript 钩子 你可以通过监听 组件事件的方式在过渡过程中挂上钩子函数：\n\u003cTransition @before-enter=\"onBeforeEnter\" @enter=\"onEnter\" @after-enter=\"onAfterEnter\" @enter-cancelled=\"onEnterCancelled\" @before-leave=\"onBeforeLeave\" @leave=\"onLeave\" @after-leave=\"onAfterLeave\" @leave-cancelled=\"onLeaveCancelled\" \u003e \u003c/Transition\u003e export default { // ... methods: { // 在元素被插入到 DOM 之前被调用 // 用这个来设置元素的 \"enter-from\" 状态 onBeforeEnter(el) {}, // 在元素被插入到 DOM 之后的下一帧被调用 // 用这个来开始进入动画 onEnter(el, done) { // 调用回调函数 done 表示过渡结束 // 如果与 CSS 结合使用，则这个回调是可选参数 done() }, // 当进入过渡完成时调用。 onAfterEnter(el) {}, onEnterCancelled(el) {}, // 在 leave 钩子之前调用 // 大多数时候，你应该只会用到 leave 钩子 onBeforeLeave(el) {}, // 在离开过渡开始时调用 // 用这个来开始离开动画 onLeave(el, done) { // 调用回调函数 done 表示过渡结束 // 如果与 CSS 结合使用，则这个回调是可选参数 done() }, // 在离开过渡完成、 // 且元素已从 DOM 中移除时调用 onAfterLeave(el) {}, // 仅在 v-show 过渡中可用 onLeaveCancelled(el) {} } } \u003ctemplate\u003e \u003cdiv class=\"app\"\u003e \u003cdiv\u003e\u003cbutton @click=\"isShow = !isShow\"\u003e显示/隐藏\u003c/button\u003e\u003c/div\u003e \u003ctransition @before-enter=\"beforeEnter\" @enter=\"enter\" @after-enter=\"afterEnter\" @before-leave=\"beforeLeave\" @leave=\"leave\" @afterLeave=\"afterLeave\"\u003e \u003ch2 class=\"title\" v-if=\"isShow\"\u003eHello World\u003c/h2\u003e \u003c/transition\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript\u003e export default { data() { return { isShow: true } }, methods: { beforeEnter() { console.log(\"beforeEnter\"); }, enter() { console.log(\"enter\"); }, afterEnter() { console.log(\"afterEnter\"); }, beforeLeave() { console.log(\"beforeLeave\"); }, leave() { console.log(\"leave\"); }, afterLeave() { console.log(\"afterLeave\"); } } } \u003c/script\u003e \u003cstyle scoped\u003e .title { display: inline-block; } \u003c/style\u003e 这些钩子可以与 CSS 过渡或动画结合使用，也可以单独使用。\n在使用仅由 JavaScript 执行的动画时，最好是添加一个 :css=\"false\" prop。这显式地向 Vue 表明可以跳过对 CSS 过渡的自动探测。除了性能稍好一些之外，还可以防止 CSS 规则意外地干扰过渡效果。\n\u003cTransition ... :css=\"false\" \u003e ... \u003c/Transition\u003e 在有了 :css=\"false\" 后，我们就自己全权负责控制什么时候过渡结束了。这种情况下对于 @enter 和 @leave 钩子来说，回调函数 done 就是必须的。否则，钩子将被同步调用，过渡将立即完成。\n这里是使用 GreenSock 库执行动画的一个示例，你也可以使用任何你想要的库，比如 Anime.js 或者 Motion One。\n第三方库的使用 animate.css https://animate.style/\n如果我们手动一个个来编写这些动画，那么效率是比较低的，所以在开发中我们可能会引用一些第三方库的动画库， 比如animate.css。 Animate.css是一个已经准备好的、跨平台的动画库为我们的web项目，对于强调、主页、滑动、注意力引导 非常有用； 如何使用?\n安装animate.css：\nnpm install animate.css 在main.js中导入animate.css：\nimport { createApp } from 'vue' import App from './test/App.vue' import 'animate.css' createApp(App).mount('#app') 接下来在使用的时候我们有两种用法：\n用法一：直接使用animate库中定义的 keyframes 动画； 用法二：直接使用animate库提供给我们的类； 使用参考: 自定义过渡 class\n\u003ctransition enter-active-class=\"animate__animated animate__backInDown\" leave-active-class=\"animate__animated animate__bounceOutDown\"\u003e \u003ch2 class=\"title\" v-if=\"isShow\"\u003eHello World\u003c/h2\u003e \u003c/transition\u003e gsap https://gsap.com/docs/v3/Installation/\nhttps://gsap.framer.wiki/stated – 中文文档\n某些情况下我们希望通过JavaScript来实现一些动画的效果，这个时候我们可以选择使用gsap库来完成。 什么是gsap呢？ GSAP是The GreenSock Animation latform（GreenSock动画平台）的缩写； 它可以通过JavaScript为CSS属性、SVG、Canvas等设置动画，并且是浏览器兼容的； 如何使用\n安装 npm install gsap 调用 api \u003ctemplate\u003e \u003cdiv class=\"app\"\u003e \u003cdiv\u003e\u003cbutton @click=\"isShow = !isShow\"\u003e显示/隐藏\u003c/button\u003e\u003c/div\u003e \u003ctransition @enter=\"enter\" @leave=\"leave\" :css=\"false\"\u003e \u003ch2 class=\"title\" v-if=\"isShow\"\u003eHello World\u003c/h2\u003e \u003c/transition\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript\u003e import gsap from 'gsap'; export default { data() { return { isShow: true, } }, methods: { enter(el, done) { console.log(\"enter\"); gsap.from(el, { scale: 0, x: 200, onComplete: done }) }, leave(el, done) { console.log(\"leave\"); gsap.to(el, { scale: 0, x: 200, onComplete: done }) } } } \u003c/script\u003e \u003cstyle scoped\u003e .title { display: inline-block; } \u003c/style\u003e enter函数接收两个参数：el和done。el是正在进入的元素，done是一个在进入过渡完成时应该被调用的函数。 onComplete: done部分在动画完成时调用done函数。这是必要的，以便让Vue知道过渡已经完成。如果不调用done，Vue可能无法正确地确定过渡的结束，这可能会导致意外的行为。 在使用仅由 JavaScript 执行的动画时，最好是添加一个 :css=\"false\" prop。这显式地向 Vue 表明可以跳过对 CSS 过渡的自动探测。除了性能稍好一些之外，还可以防止 CSS 规则意外地干扰过渡效果。 gsap 数字递增效果 \u003ctemplate\u003e \u003cdiv class=\"app\"\u003e \u003cinput type=\"number\" step=\"100\" v-model=\"counter\"\u003e \u003ch2\u003e当前计数: {{showNumber.toFixed(0)}}\u003c/h2\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript\u003e import { gsap } from 'gsap'; export default { data() { return { counter: 0, showNumber: 0 }; }, watch: { counter(newValue) { gsap.to(this, { duration: 1, showNumber: newValue }); } } }; \u003c/script\u003e 认识列表的过渡 目前为止，过渡动画我们只要是针对单个元素或者组件的： 要么是单个节点； 要么是同一时间渲染多个节点中的一个； 那么如果希望渲染的是一个列表，并且该列表中添加删除数据也希望有动画执行呢？ 这个时候我们要使用 组件来完成； 使用 有如下的特点： 默认情况下，它不会渲染一个元素的包裹器，但是你可以指定一个元素并以 tag attribute 进行渲染； 过渡模式不可用，因为我们不再相互切换特有的元素； 内部元素总是需要提供唯一的 key attribute 值； CSS 过渡的类将会应用在内部的元素中，而不是这个组/容器本身； 基本使用 \u003ctemplate\u003e \u003cdiv\u003e \u003cbutton @click=\"addNum\"\u003e添加数字\u003c/button\u003e \u003cbutton @click=\"removeNum\"\u003e删除数字\u003c/button\u003e \u003cbutton @click=\"shuffleNum\"\u003e数字洗牌\u003c/button\u003e \u003ctransition-group tag=\"p\" name=\"why\"\u003e \u003cspan v-for=\"item in numbers\" :key=\"item\" class=\"item\"\u003e {{item}} \u003c/span\u003e \u003c/transition-group\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript\u003e import _ from 'lodash'; export default { data() { return { numbers: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], numCounter: 10 } }, methods: { addNum() { // this.numbers.push(this.numCounter++) this.numbers.splice(this.randomIndex(), 0, this.numCounter++) }, removeNum() { this.numbers.splice(this.randomIndex(), 1) }, shuffleNum() { this.numbers = _.shuffle(this.numbers); }, randomIndex() { return Math.floor(Math.random() * this.numbers.length) } }, } \u003c/script\u003e \u003cstyle scoped\u003e .item { margin-right: 10px; display: inline-block; /* 设置了元素为内联块级元素。 */ } .why-enter-from, .why-leave-to { opacity: 0; transform: translateY(30px); } .why-enter-active, .why-leave-active { transition: all 1s ease; } .why-leave-active { position: absolute; } .why-move { transition: transform 1s ease; } \u003c/style\u003e methods对象定义了四个方法：\naddNum方法在numbers数组的随机位置插入一个新的数字，然后numCounter加1。 removeNum方法从numbers数组的随机位置删除一个数字。 shuffleNum方法使用lodash的shuffle函数打乱numbers数组的顺序。 randomIndex方法返回一个numbers数组的随机索引 列表过渡的移动动画 在上面的案例中虽然新增的或者删除的节点是有动画的，但是对于哪些其他需要移动的节点是没有动画的：\n我们可以通过使用一个新增的 v-move 的class来完成动画； 它会在元素改变位置的过程中应用； 像之前的名字一样，我们可以通过name来自定义前缀; 支持通过 CSS transform 控制移动效果。当一个子节点在屏幕上的位置在更新之后发生变化时，它会被添加一个使其位移的 CSS class (基于 name attribute 推导，或使用 move-class prop 显式配置)。如果使其位移的 class 被添加时 CSS 的 transform 属性是“可过渡的”，那么该元素会基于 FLIP 技巧平滑地到达动画终点。\nhttps://cn.vuejs.org/api/built-in-components.html#transitiongroup\n.why-move { transition: transform 1s ease; } 演练 =\u003e 列表的交替动画 \u003ctemplate\u003e \u003cdiv\u003e \u003cinput v-model=\"keyword\"\u003e \u003ctransition-group tag=\"ul\" name=\"why\" :css=\"false\" @before-enter=\"beforeEnter\" @enter=\"enter\" @leave=\"leave\"\u003e \u003cli v-for=\"(item, index) in showNames\" :key=\"item\" :data-index=\"index\"\u003e {{item}} \u003c/li\u003e \u003c/transition-group\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript\u003e import gsap from 'gsap'; export default { data() { return { names: [\"abc\", \"cba\", \"nba\", \"why\", \"lilei\", \"hmm\", \"kobe\", \"james\"], keyword: \"\" } }, computed: { showNames() { return this.names.filter(item =\u003e item.indexOf(this.keyword) !== -1) } }, methods: { beforeEnter(el) { el.style.opacity = 0; el.style.height = 0; }, enter(el, done) { gsap.to(el, { opacity: 1, height: \"1.5em\", delay: el.dataset.index * 0.5, onComplete: done }) }, leave(el, done) { gsap.to(el, { opacity: 0, height: 0, delay: el.dataset.index * 0.5, onComplete: done }) } } } \u003c/script\u003e \u003cstyle scoped\u003e /* .why-enter-from, .why-leave-to { opacity: 0; } .why-enter-active, .why-leave-active { transition: opacity 1s ease; } */ \u003c/style\u003e 路由使用 关于路由 认识前端路由 路由其实是网络工程中的一个术语： 在架构一个网络时，非常重要的两个设备就是路由器和交换机。 当然，目前在我们生活中路由器也是越来越被大家所熟知，因为我们生活中都会用到路由器： 路由器的主要功能是维护一个映射表，这个映射表决定了数据的流向。在网络中，路由器通过这个映射表来确定数据包的传输路径，使得数据能够按照设定的规则正确地传输到目的地。 路由的概念在软件工程中出现，最早是在后端路由中实现的，原因是web的发展主要经历了这样一些阶段： 后端路由阶段； 前后端分离阶段； 单页面富应用（SPA）； 后端路由阶段 早期的网站开发整个HTML页面是由服务器来渲染的. 服务器直接生产渲染好对应的HTML页面, 返回给客户端进行展示. 一个页面有自己对应的网址, 也就是URL； URL会发送到服务器, 服务器会通过正则对该URL进行匹配, 并且最后交给一个Controller(控制器)进行处理； Controller进行各种处理, 最终生成HTML或者数据, 返回给前端. 上面的这种操作, 就是后端路由： 当我们页面中需要请求不同的路径内容时, 交给服务器来进行处理, 服务器渲染好整个页面, 并且将页面返回给客户端. 这种情况下渲染好的页面, 不需要单独加载任何的js和css, 可以直接交给浏览器展示, 这样也有利于SEO的优化. 后端路由的缺点: 一种情况是整个页面的模块由后端人员来编写和维护的； 另一种情况是前端开发人员如果要开发页面, 需要通过PHP和Java等语言来编写页面代码； 而且通常情况下HTML代码和数据以及对应的逻辑会混在一起, 编写和维护都是非常糟糕的事情； 前后端分离阶段 前端渲染的理解： 每次请求涉及到的静态资源都会从静态资源服务器获取，这些资源包括HTML+CSS+JS，然后在前端对这些请求回来的资源进行渲染； 需要注意的是，客户端的每一次请求，都会从静态资源服务器请求文件； 同时可以看到，和之前的后端路由不同，这时后端只是负责提供API了； 前后端分离阶段： 随着Ajax的出现, 有了前后端分离的开发模式； 后端只提供API来返回数据，前端通过Ajax获取数据，并且可以通过JavaScript将数据渲染到页面中； 这样做最大的优点就是前后端责任的清晰，后端专注于数据上，前端专注于交互和可视化上； 并且当移动端(iOS/Android)出现后，后端不需要进行任何处理，依然使用之前的一套API即可； 目前比较少的网站采用这种模式开发（jQuery开发模式）； 单页面富应用（SPA） 随着前端框架（如AngularJS、React、Vue等）的兴起，单页面富应用成为主流。单页面富应用（SPA）是一种Web应用程序的架构模式，它通过动态加载页面内容，实现在单个HTML页面上切换视图和更新内容，而无需每次都从服务器请求新的页面。这种方式提高了用户体验和应用性能，因为页面只在初始化时加载一次，之后的页面切换和内容更新都是通过异步加载数据和更新页面内容来实现的。常见的前端框架如AngularJS、React和Vue等都支持SPA的开发模式。\nVue-router 简介 官网: https://router.vuejs.org/zh/\nVue Router 是 Vue.js 的官方路由。它与 Vue.js 核心深度集成，让用 Vue.js 构建单页应用变得轻而易举。功能包括：\n嵌套路由映射 动态路由选择 模块化、基于组件的路由配置 路由参数、查询、通配符 展示由 Vue.js 的过渡系统提供的过渡效果 细致的导航控制 自动激活 CSS 类的链接 HTML5 history 模式或 hash 模式 可定制的滚动行为 URL 的正确编码 具体使用示例：\n网易云音乐 https://music.163.com/\n单页面应用(SPA): 所有功能在一个 html 页面上实现\n前端路由作用: 实现业务场景切换\n优点： 简单易用 支持嵌套路由 支持路由参数、查询、动态路由等 缺点： 对于大型单页应用可能不够灵活 在处理复杂路由时可能需要额外的插件或工具 路由初体验 Vue Router 支持两种路由模式：\nHash 模式： 使用 URL 中的 ##来管理路由，适用于不需要服务端支持的单页应用。createWebHashHistory是 Vue Router 提供的一种路由模式，它基于 URL 中的 hash（#）来管理路由。这种模式在不需要服务器端支持的情况下可以工作 History 模式： 使用 HTML5 History API 来管理路由，可以去掉 URL 中的 #，需要服务器端支持来处理路由createWebHistory 是 Vue Router 提供的基于 HTML5 History API 的路由模式。这种模式需要服务器端支持来处理路由，但可以去掉 URL 中的 #，看起来更加干净。 用 Vue + Vue Router 创建单页应用非常简单：通过 Vue.js，我们已经用组件组成了我们的应用。当加入 Vue Router 时，我们需要做的就是将我们的组件映射到路由上，让 Vue Router 知道在哪里渲染它们。下面是一个基本的例子：\n\u003cscript src=\"https://unpkg.com/vue@3\"\u003e\u003c/script\u003e \u003cscript src=\"https://unpkg.com/vue-router@4\"\u003e\u003c/script\u003e \u003cdiv id=\"app\"\u003e \u003ch1\u003eHello App!\u003c/h1\u003e \u003cp\u003e \u003crouter-link to=\"/\"\u003eGo to Home\u003c/router-link\u003e \u003crouter-link to=\"/about\"\u003eGo to About\u003c/router-link\u003e \u003c/p\u003e \u003crouter-view\u003e\u003c/router-view\u003e \u003c/div\u003e \u003cscript\u003e // 定义 (路由) 组件。 // 可以从其他文件 import 进来 const Home = { template: 'Home' } const About = { template: 'About' } // 定义路由 // 每个路由应该映射一个组件。 其中\"component\" 可以是 // 通过 Vue.extend() 创建的组件构造器， // 或者，只是一个组件配置对象。 const routes = [ { path: '/', component: Home }, { path: '/about', component: About } ] // 创建 router 实例 // 你可以在这里传入配置参数 // 我们在这里使用 `routes` 配置参数 const router = VueRouter.createRouter({ history: VueRouter.createWebHashHistory(), routes // `routes: routes` 的缩写 }) // 创建和挂载根实例 // 记得要通过 router 配置参数注入路由， // 从而让整个应用都有路由功能 const app = Vue.createApp({}) app.use(router) app.mount('#app') \u003c/script\u003e router-link 请注意，我们没有使用常规的 a 标签，而是使用一个自定义组件 router-link 来创建链接。这使得 Vue Router 可以在不重新加载页面的情况下更改 URL，处理 URL 的生成以及编码。我们将在后面看到如何从这些功能中获益。\nrouter-view router-view 将显示与 URL 对应的组件。你可以把它放在任何地方，以适应你的布局。\n安装以及使用 安装\nnpm install vue-router 创建 router/index.js 并在其中编辑基本配置(默认你已经注册了 components 中的两个文件)\nimport { createRouter, createWebHistory } from 'vue-router' const routes = [ { path: '/', component: () =\u003e import('../components/login.vue') }, { path: '/req', component: () =\u003e import('../components/req.vue') } ] const router = createRouter({ history: createWebHistory(), routes }) export default router 在 src/App.vue 中引入 import router from '../router' createApp(App).use(router).mount('#app') 当然, 我们需要一个 router-view 显示与 URL 对应的组件, 一般会在 src/App.vue 中做如下配置, 当然你可以把它放在任何地方，以适应你的布局。 \u003ctemplate\u003e \u003crouter-view\u003e\u003c/router-view\u003e \u003c/template\u003e 我们也可以在其中使用 router-link \u003ctemplate\u003e \u003cdiv\u003e \u003ch1\u003e小满最骚\u003c/h1\u003e \u003cdiv\u003e \u003crouter-link tag=\"div\" to=\"/\"\u003e跳转a\u003c/router-link\u003e \u003crouter-link tag=\"div\" style=\"margin-left:200px\" to=\"/register\"\u003e跳转b\u003c/router-link\u003e \u003c/div\u003e \u003chr /\u003e \u003crouter-view\u003e\u003c/router-view\u003e \u003c/div\u003e \u003c/template\u003e 带参数的动态路由匹配 很多时候，我们需要将给定匹配模式的路由映射到同一个组件。例如，我们可能有一个 User 组件，它应该对所有用户进行渲染，但用户 ID 不同。在 Vue Router 中，我们可以在路径中使用一个动态字段来实现，我们称之为 路径参数 ：\nconst User = { template: 'User', } // 这些都会传递给 `createRouter` const routes = [ // 动态字段以冒号开始 { path: '/users/:id', component: User }, ] 现在像 /users/johnny 和 /users/jolyne 这样的 URL 都会映射到同一个路由。\n路径参数 用冒号 : 表示。当一个路由被匹配时，它的 params 的值将在每个组件中以 this.$route.params 的形式暴露出来。因此，我们可以通过更新 User 的模板来呈现当前的用户 ID：\nconst User = { template: 'User {{ $route.params.id }}', } 你可以在同一个路由中设置有多个 路径参数，它们会映射到 $route.params 上的相应字段。例如：\n匹配模式 匹配路径 $route.params /users/:username /users/eduardo { username: 'eduardo' } /users/:username/posts/:postId /users/eduardo/posts/123 { username: 'eduardo', postId: '123' } 除了 $route.params 之外，$route 对象还公开了其他有用的信息，如 $route.query（如果 URL 中存在参数）、$route.hash 等。你可以在 API 参考中查看完整的细节。\n以下是一个小 Demo\n// router.js import { createRouter, createWebHistory } from 'vue-router' import UserPost from './views/UserPost.vue' export const router = createRouter({ history: createWebHistory(), routes: [{ path: '/users/:username/posts/:postId', component: UserPost }], }) \u003ctemplate\u003e \u003cul\u003e \u003cli\u003e \u003crouter-link to=\"/users/eduardo/posts/1\" \u003e/users/eduardo/posts/1\u003c/router-link \u003e \u003c/li\u003e \u003cli\u003e \u003crouter-link to=\"/users/eduardo/posts/20\" \u003e/users/eduardo/posts/20\u003c/router-link \u003e \u003c/li\u003e \u003c/ul\u003e \u003crouter-view\u003e\u003c/router-view\u003e \u003c/template\u003e \u003cscript\u003e export default { name: \"App\", }; \u003c/script\u003e \u003ctemplate\u003e \u003cdiv\u003e User {{ $route.params.username }} with post {{ $route.params.postId }} \u003c/div\u003e \u003c/template\u003e 声明式/ 编程式导航 声明式导航 基础使用/ 命名路由 除了 path 之外，你还可以为任何路由提供 name。这有以下优点：\nhttps://router.vuejs.org/zh/guide/essentials/named-routes.html\n没有硬编码的 URL\nparams 的自动编码/解码。\n防止你在 url中出现打字错误。\n绕过路径排序（如显示一个）\n这跟代码调用 router.push() 是一回事：\nrouter.push({name: 'user', params: {username: 'erina'}}) // 在这两种情况下，路由将导航到路径 /user/erina。 const routes:Array\u003cRouteRecordRaw\u003e = [ { path:\"/\", name:\"Login\", component:()=\u003e import('../components/login.vue') }, { path:\"/reg\", name:\"Reg\", component:()=\u003e import('../components/reg.vue') } ] 跳转方式需要改变 变为对象并且有对应name\n两种跳转方式有区别, a 标签有新的网络请求, 会刷新整个页面\n\u003ctemplate\u003e \u003cdiv\u003e \u003cdiv class=\"\"\u003e \u003crouter-link :to=\"{name: 'Login'}\"\u003eHome\u003c/router-link\u003e \u003crouter-link :to=\"{name: 'Req'}\"\u003eReq\u003c/router-link\u003e \u003ca href=\"/\"\u003eLogin\u003c/a\u003e \u003ca href=\"/req\"\u003eReq\u003c/a\u003e \u003c/div\u003e \u003cdiv class=\"top\"\u003e \u003crouter-view\u003e\u003c/router-view\u003e \u003c/div\u003e \u003c/div\u003e \u003c/template\u003e 跳转传参 目标: 在跳转路由时, 可以给路由对应的组件内传值\n在 router-link 上的 to 属性传值, 语法格式如下\n/path?参数名=值 /path/值 – 需要路由对象提前配置 path: \"/path/参数名\" 对应页面组件接收传递过来的值\nroute.query.参数名 route.params.参数名 1、新建 views/Part2.vue - 接收路由上传递的参数和值\n\u003ctemplate\u003e \u003cdiv\u003e \u003cp\u003e我的好友\u003c/p\u003e \u003cp\u003e人名(path --\u003e query): {{ route.query?.name }}\u003c/p\u003e \u003cp\u003e人名(?后参数 --\u003e params): {{ route.params?.name }}\u003c/p\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript setup\u003e // 目标: 声明式导航 - 基础使用 // 本质: vue-router 提供的全局组件 \"router-link\" 替代a标签 // 1. router-link 替代 a 标签 // 2. to 属性 替代 href 属性 // 好处: router-link 自带高亮的类名(激活时类名) // 3. 对激活的类名做出样式的编写 import {useRoute} from 'vue-router' const route = useRoute() \u003c/script\u003e 2、修改路由定义\nconst routes = [ {'path': '/find', component: () =\u003e import('../views/Find.vue')}, {'path': '/my', component: () =\u003e import('../views/My.vue')}, {'path': '/part', name: 'Part', component: () =\u003e import('../views/Part.vue')}, { path: \"/part/:name\", // 有:的路径代表要接收具体的值 component: () =\u003e import('../views/Part2.vue') }, ] 3、修改 App.vue 进行跳转\n\u003ctemplate\u003e \u003cdiv\u003e \u003cdiv class=\"footer_wrap\"\u003e \u003crouter-link to=\"/find\"\u003e发现音乐\u003c/router-link\u003e \u003crouter-link to=\"/my\"\u003e我的音乐\u003c/router-link\u003e \u003crouter-link to=\"/part\"\u003e朋友\u003c/router-link\u003e \u003crouter-link to=\"/part?name=小传\"\u003e朋友-小传\u003c/router-link\u003e \u003crouter-link to=\"/part/小智?name=小智2\"\u003e朋友-小智\u003c/router-link\u003e \u003c/div\u003e \u003cdiv class=\"top\"\u003e \u003crouter-view\u003e\u003c/router-view\u003e \u003c/div\u003e \u003c/div\u003e \u003c/template\u003e 总结:\n?key=value 用 $route.query.key 取值 /值 提前在路由规则 /path/:key 用 $route.params.key 取值 query 是查询参数, params 是 path 路径 有:的路径代表要接收具体的值, 不然会报警告 在这个特定的场景中，我们在括号之间使用了 自定义正则表达式，并将pathMatch 参数标记为 可选可重复。这样做是为了让我们在需要的时候，可以通过将 path 拆分成一个数组，直接导航到路由\n捕获所有路由或 404 Not found 路由 常规参数只匹配 url 片段之间的字符，用 / 分隔。如果我们想匹配任意路径，我们可以使用自定义的 路径参数 正则表达式，在 路径参数 后面的括号中加入 正则表达式 :\nconst routes = [ // 将匹配所有内容并将其放在 `$route.params.pathMatch` 下 { path: '/:pathMatch(.*)*', name: 'NotFound', component: NotFound }, // 将匹配以 `/user-` 开头的所有内容，并将其放在 `$route.params.afterUser` 下 { path: '/user-:afterUser(.*)', component: UserGeneric }, ] 在这个特定的场景中，我们在括号之间使用了 自定义正则表达式，并将pathMatch 参数标记为 可选可重复。这样做是为了让我们在需要的时候，可以通过将 path 拆分成一个数组，直接导航到路由：\nthis.$router.push({ name: 'NotFound', // 保留当前路径并删除第一个字符，以避免目标 URL 以 `//` 开头。 params: { pathMatch: this.$route.path.substring(1).split('/') }, // 保留现有的查询和 hash 值，如果有的话 query: this.$route.query, hash: this.$route.hash, }) 更多内容请参见 重复参数部分。\n一般使用如下\nconst routes = [ // ...省略了其他配置 // 404在最后(规则是从前往后逐个比较path) { path: \"/:pathMatch(.*)*\", component: () =\u003e import('../views/NotFound.vue') } ] 编程式导航 除了使用 创建 a 标签来定义导航链接，我们还可以借助 router 的实例方法，通过编写代码来实现。\n导航到不同的位置 注意：在 Vue 实例中，你可以通过 $router 访问路由实例。因此你可以调用 $router.push。\n想要导航到不同的 URL，可以使用 router.push 方法。这个方法会向 history 栈添加一个新的记录，所以，当用户点击浏览器后退按钮时，会回到之前的 URL。\n当你点击 时，内部会调用这个方法，所以点击 相当于调用 router.push(...) ：\n声明式 编程式 router.push(...) 该方法的参数可以是一个字符串路径，或者一个描述地址的对象。例如：\n// 字符串路径 router.push('/users/eduardo'); // 带有路径的对象 router.push({path: '/users/eduardo'}); // 命名的路由，并加上参数，让路由建立 url router.push({name: 'user', params: {username: 'eduardo'}}); // 带查询参数，结果是 /register?plan=private router.push({path: '/register', query: {plan: 'private'}}); // 带 hash，结果是 /about.md#team router.push({path: '/about.md', hash: '#team'}); 注意：如果提供了 path，params 会被忽略，上述例子中的 query 并不属于这种情况。取而代之的是下面例子的做法，你需要提供路由的 name 或手写完整的带有参数的 path ：\nconst username = 'eduardo' // 我们可以手动建立 url，但我们必须自己处理编码 router.push(`/user/${username}`) // -\u003e /user/eduardo // 同样 router.push({path: `/user/${username}`}) // -\u003e /user/eduardo // 如果可能的话，使用 `name` 和 `params` 从自动 URL 编码中获益 router.push({name: 'user', params: {username}}) // -\u003e /user/eduardo // `params` 不能与 `path` 一起使用 router.push({path: '/user', params: {username}}) // -\u003e /user 当指定 params 时，可提供 string 或 number 参数（或者对于 可重复的参数 可提供一个数组）。任何其他类型（如 undefined、false 等）都将被自动字符串化 。对于 可选参数 ，你可以提供一个空字符串（\"\"）来跳过它。\n由于属性 to 与 router.push 接受的对象种类相同，所以两者的规则完全相同。\n基础使用 语法:\nrouter.push({ path: \"路由路径\", // 都去 router/index.js 定义 name: \"路由名\" }) src/router/index.js - 路由数组里, 给路由起名字 import { createRouter, createWebHistory } from 'vue-router' const routes = [ { path: \"/part/:name\", // 有:的路径代表要接收具体的值 name: 'Part2', component: () =\u003e import('../components/HelloWorld.vue') }, ] const router = createRouter({ history: createWebHistory(), routes }) export default router App.vue - 换成 span 配合js的编程式导航跳转 \u003ctemplate\u003e \u003cdiv\u003e \u003cdiv class=\"footer_wrap\"\u003e \u003ca @click=\"change_router('/part', 'Part')\"\u003e朋友\u003c/a\u003e \u003cbr /\u003e \u003ca @click=\"change1\"\u003e朋友-小传\u003c/a\u003e \u003cbr /\u003e \u003ca @click=\"change2\"\u003e朋友-小智\u003c/a\u003e \u003c/div\u003e \u003cdiv class=\"top\"\u003e \u003crouter-view\u003e\u003c/router-view\u003e \u003c/div\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript setup\u003e import {useRouter} from 'vue-router'; const router = useRouter(); const change_router = (path, name) =\u003e { router.push({name: name}); }; const change1 = () =\u003e { router.push({ name: 'Part2', params: { name: '小传', }, }); }; const change2 = () =\u003e { router.push( { name: 'Part2', params: { name: '小智' }, query: { name: '小智', }, }, ); }; \u003c/script\u003e 横跨历史 该方法采用一个整数作为参数，表示在历史堆栈中前进或后退多少步，类似于 window.history.go(n)。\n// 向前移动一条记录，与 router.forward() 相同 router.go(1) // 返回一条记录，与 router.back() 相同 router.go(-1) // 前进 3 条记录 router.go(3) // 如果没有那么多记录，静默失败 router.go(-100) router.go(100) 替换当前位置 它的作用类似于 router.push，唯一不同的是，它在导航时不会向 history 添加新记录，正如它的名字所暗示的那样——它取代了当前的条目。\n声明式 编程式 router.replace(...) 也可以直接在传递给 router.push 的 routeLocation 中增加一个属性 replace: true ：\nrouter.push({path: '/home', replace: true}) // 相当于 router.replace({path: '/home'}) 重定向 重定向也是通过 routes 配置来完成，下面例子是从 /home 重定向到 /：\nconst routes = [{path: '/home', redirect: '/'}] 重定向的目标也可以是一个命名的路由：\nconst routes = [{path: '/home', redirect: {name: 'homepage'}}] 甚至是一个方法，动态返回重定向目标：\nconst routes = [ { // /search/screens -\u003e /search?q=screens path: '/search/:searchText', redirect: to =\u003e { // 方法接收目标路由作为参数 // return 重定向的字符串路径/路径对象 return {path: '/search', query: {q: to.params.searchText}} }, }, { path: '/search', // ... }, ] 例如: 网页默认打开, 匹配路由 \"/\", 强制切换到 \"/find\" 上\nconst routes = [ { path: \"/\", // 默认hash值路径 redirect: \"/find\" // 重定向到 /find // 浏览器 url 中 ## 后的路径被改变成 /find -重新匹配数组规则 }, ] 总结: 强制重定向后, 还会重新来数组里匹配一次规则\n别名 有时候，同一个路径可能需要多个路由，此时可以使用 alias 创建别名。\nconst routes = [ { path: '/foo', component: Foo, alias: '/bar' }, ] 有个通用的场景是，你可能要把 src 目录下的 @ 指向 src 目录，这时候就可以使用别名：\n在 vue.config.js 中配置别名\nmodule.exports = { configureWebpack: { resolve: { alias: { '@': path.resolve(__dirname, 'src') } } } } 路由进阶 路由嵌套 一些应用程序的 UI 由多层嵌套的组件组成。在这种情况下，URL 的片段通常对应于特定的嵌套组件结构，例如：\n/user/johnny/profile /user/johnny/posts +------------------+ +-----------------+ | User | | User | | +--------------+ | | +-------------+ | | | Profile | | +------------\u003e | | Posts | | | | | | | | | | | +--------------+ | | +-------------+ | +------------------+ +-----------------+ 通过 Vue Router，你可以使用嵌套路由配置来表达这种关系。\n接着上节创建的 app ：\n\u003cdiv id=\"app\"\u003e \u003crouter-view\u003e\u003c/router-view\u003e \u003c/div\u003e const User = { template: 'User {{ $route.params.id }}', } // 这些都会传递给 `createRouter` const routes = [{ path: '/user/:id', component: User }] 这里的 是一个顶层的 router-view。它渲染顶层路由匹配的组件。同样地，一个被渲染的组件也可以包含自己嵌套的 。例如，如果我们在 User 组件的模板内添加一个 ：\nconst User = { template: ` User {{ $route.params.id }} `, } 要将组件渲染到这个嵌套的 router-view 中，我们需要在路由中配置 children：\nconst routes = [ { path: '/user/:id', component: User, children: [ { // 当 /user/:id/profile 匹配成功 // UserProfile 将被渲染到 User 的 内部 path: 'profile', component: UserProfile, }, { // 当 /user/:id/posts 匹配成功 // UserPosts 将被渲染到 User 的 内部 path: 'posts', component: UserPosts, }, ], }, ] 注意，以 / 开头的嵌套路径将被视为根路径。这允许你利用组件嵌套，而不必使用嵌套的 URL。\n如你所见，children 配置只是另一个路由数组，就像 routes 本身一样。因此，你可以根据自己的需要，不断地嵌套视图。\n此时，按照上面的配置，当你访问 /user/eduardo 时，在 User 的 router-view 里面什么都不会呈现，因为没有匹配到嵌套路由。也许你确实想在那里渲染一些东西。在这种情况下，你可以提供一个空的嵌套路径：\nconst routes = [ { path: '/user/:id', component: User, children: [ // 当 /user/:id 匹配成功 // UserHome 将被渲染到 User 的 内部 { path: '', component: UserHome }, // ...其他子路由 ], }, ] 导航守卫 https://router.vuejs.org/zh/guide/advanced/navigation-guards.html\n正如其名，vue-router 提供的导航守卫主要用来通过跳转或取消的方式守卫导航。这里有很多方式植入路由导航中：全局的，单个路由独享的，或者组件级的。\n全局前置守卫 你可以使用 router.beforeEach 注册一个全局前置守卫：\nconst router = createRouter({ ... }) router.beforeEach((to, from) =\u003e { // ... // 返回 false 以取消导航 return false }) 当一个导航触发时，全局前置守卫按照创建顺序调用。守卫是异步解析执行，此时导航在所有守卫 resolve 完之前一直处于等待中。\n每个守卫方法接收两个参数：\nto: 即将要进入的目标 用一种标准化的方式 from: 当前导航正要离开的路由 用一种标准化的方式 可以返回的值如下:\nfalse: 取消当前的导航。如果浏览器的 URL 改变了(可能是用户手动或者浏览器后退按钮)，那么 URL 地址会重置到 from 路由对应的地址。 一个 路由地址: 通过一个路由地址重定向到一个不同的地址，如同调用 router.push()，且可以传入诸如 replace: true 或 name: 'home' 之类的选项。它会中断当前的导航，同时用相同的 from 创建一个新导航。 router.beforeEach(async (to, from) =\u003e { if ( // 检查用户是否已登录 !isAuthenticated \u0026\u0026 // ❗️ 避免无限重定向 to.name !== 'Login' ) { // 将用户重定向到登录页面 return { name: 'Login' } } }) 如果遇到了意料之外的情况，可能会抛出一个 Error。这会取消导航并且调用 router.onError() 注册过的回调。\n如果什么都没有，undefined 或返回 true，则导航是有效的，并调用下一个导航守卫\n以上所有都同 async 函数 和 Promise 工作方式一样：\nrouter.beforeEach(async (to, from) =\u003e { // canUserAccess() 返回 `true` 或 `false` const canAccess = await canUserAccess(to) if (!canAccess) return '/login' }) 在之前的 Vue Router 版本中，还可以使用 第三个参数 next 。这是一个常见的错误来源，我们经过 RFC 讨论将其移除。然而，它仍然是被支持的，这意味着你可以向任何导航守卫传递第三个参数。在这种情况下，确保 next 在任何给定的导航守卫中都被严格调用一次。它可以出现多于一次，但是只能在所有的逻辑路径都不重叠的情况下，否则钩子永远都不会被解析或报错。这里有一个在用户未能验证身份时重定向到/login的错误用例：\n// BAD router.beforeEach((to, from, next) =\u003e { if (to.name !== 'Login' \u0026\u0026 !isAuthenticated) next({ name: 'Login' }) // 如果用户未能验证身份，则 `next` 会被调用两次 next() }) 下面是正确的版本:\n// GOOD router.beforeEach((to, from, next) =\u003e { if (to.name !== 'Login' \u0026\u0026 !isAuthenticated) next({ name: 'Login' }) else next() }) 全局后置钩子 你也可以注册全局后置钩子，然而和守卫不同的是，这些钩子不会接受 next 函数也不会改变导航本身：\nrouter.afterEach((to, from) =\u003e { sendToAnalytics(to.fullPath) }) 它们对于分析、更改页面标题、声明页面等辅助功能以及许多其他事情都很有用。\n它们也反映了 navigation failures 作为第三个参数：\nrouter.afterEach((to, from, failure) =\u003e { if (!failure) sendToAnalytics(to.fullPath) }) 更多关于 navigation failures 的信息在 它的指南 中。\n路由独享的守卫 你可以直接在路由配置上定义 beforeEnter 守卫：\nconst routes = [ { path: '/users/:id', component: UserDetails, beforeEnter: (to, from) =\u003e { // reject the navigation return false }, }, ] beforeEnter 守卫 只在进入路由时触发，不会在 params、query 或 hash 改变时触发。例如，从 /users/2 进入到 /users/3 或者从 /users/2#info 进入到 /users/2#projects。它们只有在 从一个不同的 路由导航时，才会被触发。\n你也可以将一个函数数组传递给 beforeEnter，这在为不同的路由重用守卫时很有用：\nfunction removeQueryParams(to) { if (Object.keys(to.query).length) return { path: to.path, query: {}, hash: to.hash } } function removeHash(to) { if (to.hash) return { path: to.path, query: to.query, hash: '' } } const routes = [ { path: '/users/:id', component: UserDetails, beforeEnter: [removeQueryParams, removeHash], }, { path: '/about', component: UserDetails, beforeEnter: [removeQueryParams], }, ] 请注意，你也可以通过使用 路径 meta 字段和全局导航守卫来实现类似的行为。\n组件内的守卫 最后，你可以在路由组件内直接定义路由导航守卫(传递给路由配置的)\n可用的配置 API 你可以为路由组件添加以下配置：\nbeforeRouteEnter beforeRouteUpdate beforeRouteLeave const UserDetails = { template: `...`, beforeRouteEnter(to, from) { // 在渲染该组件的对应路由被验证前调用 // 不能获取组件实例 `this` ！ // 因为当守卫执行时，组件实例还没被创建！ }, beforeRouteUpdate(to, from) { // 在当前路由改变，但是该组件被复用时调用 // 举例来说，对于一个带有动态参数的路径 `/users/:id`，在 `/users/1` 和 `/users/2` 之间跳转的时候， // 由于会渲染同样的 `UserDetails` 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。 // 因为在这种情况发生的时候，组件已经挂载好了，导航守卫可以访问组件实例 `this` }, beforeRouteLeave(to, from) { // 在导航离开渲染该组件的对应路由时调用 // 与 `beforeRouteUpdate` 一样，它可以访问组件实例 `this` }, } beforeRouteEnter 守卫 不能 访问 this，因为守卫在导航确认前被调用，因此即将登场的新组件还没被创建。\n不过，你可以通过传一个回调给 next 来访问组件实例。在导航被确认的时候执行回调，并且把组件实例作为回调方法的参数：\nbeforeRouteEnter (to, from, next) { next(vm =\u003e { // 通过 `vm` 访问组件实例 }) } 注意 beforeRouteEnter 是支持给 next 传递回调的唯一守卫。对于 beforeRouteUpdate 和 beforeRouteLeave 来说，this 已经可用了，所以不支持 传递回调，因为没有必要了：\nbeforeRouteUpdate (to, from) { // just use `this` this.name = to.params.name } 这个 离开守卫 通常用来预防用户在还未保存修改前突然离开。该导航可以通过返回 false 来取消。\nbeforeRouteLeave (to, from) { const answer = window.confirm('Do you really want to leave? you have unsaved changes!') if (!answer) return false } 使用组合 AP 如果你正在使用 组合 API 和 setup 函数来编写组件，你可以通过 onBeforeRouteUpdate 和 onBeforeRouteLeave 分别添加 update 和 leave 守卫。 请参考 组合 API 部分以获得更多细节。\n完整的导航解析流程 导航被触发。 在失活的组件里调用 beforeRouteLeave 守卫。 调用全局的 beforeEach 守卫。 在重用的组件里调用 beforeRouteUpdate 守卫(2.2+)。 在路由配置里调用 beforeEnter。 解析异步路由组件。 在被激活的组件里调用 beforeRouteEnter。 调用全局的 beforeResolve 守卫(2.5+)。 导航被确认。 调用全局的 afterEach 钩子。 触发 DOM 更新。 调用 beforeRouteEnter 守卫中传给 next 的回调函数，创建好的组件实例会作为回调函数的参数传入。 路由案例 目标: 路由跳转之前, 先执行一次前置守卫函数, 判断是否可以正常跳转\n// `router.beforeEach` router.beforeEach((to, form, next) =\u003e { console.log(to, form); next() }) 每个守卫方法接收三个参数：\nto: Route， 即将要进入的目标 路由对象； from: Route，当前导航正要离开的路由； next(): 进行管道中的下一个钩子。如果全部钩子执行完了，则导航的状态就是 confirmed (确认的)。 next(false): 中断当前的导航。如果浏览器的 URL 改变了 (可能是用户手动或者浏览器后退按钮)，那么 URL 地址会重置到 from 路由对应的地址。 next('/') 或者 next({ path: '/' }): 跳转到一个不同的地址。当前的导航被中断，然后进行一个新的导航。 登录拦截 使用例子: 在跳转路由前, 判断用户登陆了才能去 \u003c我的音乐\u003e 页面, 未登录弹窗提示回到发现音乐页面\n在路由对象上使用固定方法 beforeEach\n// 目标: 路由守卫 // 场景: 当你要对路由权限判断时 // 语法: router.beforeEach((to, from, next)=\u003e{//路由跳转\"之前\"先执行这里, 决定是否跳转}) // 参数1: 要跳转到的路由 (路由对象信息) 目标 // 参数2: 从哪里跳转的路由 (路由对象信息) 来源 // 参数3: 函数体 - next()才会让路由正常的跳转切换, next(false)在原地停留, next(\"强制修改到另一个路由路径上\") // 注意: 如果不调用 next, 页面留在原地 const isLogin = ref(true)// 登录状态(未登录) router.beforeEach((to, from, next) =\u003e { if (to.path === '/my' \u0026\u0026 isLogin.value === false) { alert('请登录') next(false) // 阻止路由跳转 } else { next() // 正常放行 } }) 总结: next()放行, next(false)留在原地不跳转路由, next(path路径)强制换成对应path路径跳转\n权限判断 const whileList = ['/'] router.beforeEach((to, from, next) =\u003e { let token = localStorage.getItem('token') //白名单 有值 或者登陆过存储了token信息可以跳转 否则就去登录页面 if (whileList.includes(to.path) || token) { next() } else { next({ path: '/' }) } }) 路由原信息 有时，你可能希望将任意信息附加到路由上，如过渡名称、谁可以访问路由等。这些事情可以通过接收属性对象的meta属性来实现，并且它可以在路由地址和导航守卫上都被访问到。定义路由的时候你可以这样配置 meta 字段：\nconst routes = [ { path: '/posts', component: PostsLayout, children: [ { path: 'new', component: PostsNew, // 只有经过身份验证的用户才能创建帖子 meta: { requiresAuth: true }, }, { path: ':id', component: PostsDetail // 任何人都可以阅读文章 meta: { requiresAuth: false }, } ] } ] 那么如何访问这个 meta 字段呢？\n首先，我们称呼 routes 配置中的每个路由对象为 路由记录。路由记录可以是嵌套的，因此，当一个路由匹配成功后，它可能匹配多个路由记录。\n例如，根据上面的路由配置，/posts/new 这个 URL 将会匹配父路由记录 (path: '/posts') 以及子路由记录 (path: 'new')。\n一个路由匹配到的所有路由记录会暴露为 $route 对象(还有在导航守卫中的路由对象)的$route.matched 数组。我们需要遍历这个数组来检查路由记录中的 meta 字段，但是 Vue Router 还为你提供了一个 $route.meta 方法，它是一个非递归合并所有 meta 字段（从父字段到子字段）的方法。这意味着你可以简单地写\nrouter.beforeEach((to, from) =\u003e { // 而不是去检查每条路由记录 // to.matched.some(record =\u003e record.meta.requiresAuth) if (to.meta.requiresAuth \u0026\u0026 !auth.isLoggedIn()) { // 此路由需要授权，请检查是否已登录 // 如果没有，则重定向到登录页面 return { path: '/login', // 保存我们所在的位置，以便以后再来 query: { redirect: to.fullPath }, } } }) 过渡动效 想要在你的路径组件上使用转场，并对导航进行动画处理，你需要使用 v-slot API：\n\u003crouter-view #default=\"{route,Component}\"\u003e \u003ctransition :enter-active-class=\"`animate__animated ${route.meta.transition}`\"\u003e \u003ccomponent :is=\"Component\"\u003e\u003c/component\u003e \u003c/transition\u003e \u003c/router-view\u003e 上面的用法会对所有的路由使用相同的过渡。如果你想让每个路由的组件有不同的过渡，你可以将 元信息和动态的 name 结合在一起，放在 上：\nconst routes = [ { path: '/custom-transition', component: PanelLeft, meta: { transition: 'slide-left' }, }, { path: '/other-transition', component: PanelRight, meta: { transition: 'slide-right' }, }, ] \u003crouter-view v-slot=\"{ Component, route }\"\u003e \u003ctransition :name=\"route.meta.transition || 'fade'\"\u003e \u003ccomponent :is=\"Component\" /\u003e \u003c/transition\u003e \u003c/router-view\u003e 也可以根据目标路由和当前路由之间的关系，动态地确定使用的过渡。使用和刚才非常相似的片段：\n\u003crouter-view v-slot=\"{ Component, route }\"\u003e \u003ctransition :name=\"route.meta.transition\"\u003e \u003ccomponent :is=\"Component\" /\u003e \u003c/transition\u003e \u003c/router-view\u003e 我们可以添加一个 after navigation hook，根据路径的深度动态添加信息到 meta 字段。\nrouter.afterEach((to, from) =\u003e { const toDepth = to.path.split('/').length const fromDepth = from.path.split('/').length to.meta.transition = toDepth \u003c fromDepth ? 'slide-right' : 'slide-left' }) Vue 可能会自动复用看起来相似的组件，从而忽略了任何过渡。幸运的是，可以 添加一个 key 属性来强制过渡。这也允许你在相同路由上使用不同的参数触发过渡：\n\u003crouter-view v-slot=\"{ Component, route }\"\u003e \u003ctransition name=\"fade\"\u003e \u003ccomponent :is=\"Component\" :key=\"route.path\" /\u003e \u003c/transition\u003e \u003c/router-view\u003e 滚动行为 使用前端路由，当切换到新路由时，想要页面滚到顶部，或者是保持原先的滚动位置，就像重新加载页面那样。 vue-router 能做到，而且更好，它让你可以自定义路由切换时页面如何滚动。\n注意: 这个功能只在支持 history.pushState 的浏览器中可用。\n当创建一个 Router 实例，你可以提供一个 scrollBehavior 方法：\nconst router = createRouter({ history: createWebHashHistory(), routes: [...], scrollBehavior (to, from, savedPosition) { // return 期望滚动到哪个的位置 } }) scrollBehavior 函数接收 to和from 路由对象，如 Navigation Guards。第三个参数 savedPosition，只有当这是一个 popstate 导航时才可用（由浏览器的后退/前进按钮触发）。\n该函数可以返回一个 ScrollToOptions 位置对象:\nconst router = createRouter({ scrollBehavior(to, from, savedPosition) { // 始终滚动到顶部 return { top: 0 } }, }) 你也可以通过 el 传递一个 CSS 选择器或一个 DOM 元素。在这种情况下，top 和 left 将被视为该元素的相对偏移量。\nconst router = createRouter({ scrollBehavior(to, from, savedPosition) { // 始终在元素 #main 上方滚动 10px return { // 也可以这么写 // el: document.getElementById('main'), el: '#main', // 在元素上 10 像素 top: 10, } }, }) 如果返回一个 falsy 的值，或者是一个空对象，那么不会发生滚动。\n返回 savedPosition，在按下 后退/前进 按钮时，就会像浏览器的原生表现那样：\nconst router = createRouter({ scrollBehavior(to, from, savedPosition) { if (savedPosition) { return savedPosition } else { return { top: 0 } } }, }) 如果你要模拟 “滚动到锚点” 的行为：\nconst router = createRouter({ scrollBehavior(to, from, savedPosition) { if (to.hash) { return { el: to.hash, } } }, }) 如果你的浏览器支持 滚动行为，你可以让它变得更流畅：\nconst router = createRouter({ scrollBehavior(to, from, savedPosition) { if (to.hash) { return { el: to.hash, behavior: 'smooth', } } } }) 有时候，我们需要在页面中滚动之前稍作等待。例如，当处理过渡时，我们希望等待过渡结束后再滚动。要做到这一点，你可以返回一个 Promise，它可以返回所需的位置描述符。下面是一个例子，我们在滚动前等待 500ms：\nconst router = createRouter({ scrollBehavior(to, from, savedPosition) { return new Promise((resolve, reject) =\u003e { setTimeout(() =\u003e { resolve({ left: 0, top: 0 }) }, 500) }) }, }) 我们可以将其与页面级过渡组件的事件挂钩，以使滚动行为与你的页面过渡很好地结合起来，但由于使用场景可能存在的差异和复杂性，我们只是提供了这个基础来实现特定的用户场景。\n动态路由 对路由的添加通常是通过 routes 选项来完成的，但是在某些情况下，你可能想在应用程序已经运行的时候添加或删除路由。具有可扩展接口(如 Vue CLI UI )这样的应用程序可以使用它来扩展应用程序。\n添加路由 动态路由主要通过两个函数实现。router.addRoute() 和 router.removeRoute()。它们只注册一个新的路由，也就是说，如果新增加的路由与当前位置相匹配，就需要你用 router.push() 或 router.replace() 来手动导航，才能显示该新路由。我们来看一个例子：\n想象一下，只有一个路由的以下路由：\nconst router = createRouter({ history: createWebHistory(), routes: [{ path: '/:articleName', component: Article }], }) 进入任何页面，/about，/store，或者 /3-tricks-to-improve-your-routing-code 最终都会呈现 Article 组件。如果我们在 /about 上添加一个新的路由：\nrouter.addRoute({ path: '/about', component: About }) 页面仍然会显示 Article 组件，我们需要手动调用 router.replace() 来改变当前的位置，并覆盖我们原来的位置（而不是添加一个新的路由，最后在我们的历史中两次出现在同一个位置）：\nrouter.addRoute({ path: '/about', component: About }) // 我们也可以使用 this.$route 或 route = useRoute() （在 setup 中） router.replace(router.currentRoute.value.fullPath) 记住，如果你需要等待新的路由显示，可以使用 await router.replace()。\n删除路由 有几个不同的方法来删除现有的路由：\n通过添加一个名称冲突的路由。如果添加与现有途径名称相同的途径，会先删除路由，再添加路由：\nrouter.addRoute({ path: '/about', name: 'about', component: About }) // 这将会删除之前已经添加的路由，因为他们具有相同的名字且名字必须是唯一的 router.addRoute({ path: '/other', name: 'about', component: Other }) 通过调用 router.addRoute() 返回的回调：\nconst removeRoute = router.addRoute(routeRecord) removeRoute() // 删除路由如果存在的话 当路由没有名称时，这很有用。\n通过使用 router.removeRoute() 按名称删除路由：\nrouter.addRoute({ path: '/about', name: 'about', component: About }) // 删除路由 router.removeRoute('about') 需要注意的是，如果你想使用这个功能，但又想避免名字的冲突，可以在路由中使用 Symbol 作为名字。\n当路由被删除时，所有的别名和子路由也会被同时删除\n查看现有路由 Vue Router 提供了两个功能来查看现有的路由：\nrouter.hasRoute()：检查路由是否存在。 router.getRoutes()：获取一个包含所有路由记录的数组。 动态路由案例 后端代码 -\u003e Python Flask from flask import Flask, request from flask_cors import CORS app = Flask(__name__) CORS().init_app(app) @app.route('/login', methods=['POST']) def login(): username = request.json.get('username') password = request.json.get('password') if username == 'admin' and password == '123456': return { 'routes': [ { 'path': \"/articles\", 'name': \"articles\", 'parent': \"subviews\", 'component': 'Articles.vue' }, { 'path': \"/hot\", 'name': \"hot\", 'parent': \"subviews\", 'component': 'Hot.vue' }, { 'path': \"/author\", 'name': \"author\", 'parent': \"subviews\", 'component': 'Author.vue' } ] } else: return { 'code': 400, 'message': \"账号密码错误\" } @app.route('/menus', methods=['GET']) def menus(): return { 'routes': [ { 'path': '/login', 'name': 'login', 'component': 'Login.vue' }, { 'path': '/main', 'name': 'main', 'component': 'Main.vue' } ] } @app.route('/', methods=['GET']) def index(): return { 'routes': [ { 'path': '/login', 'name': 'login', 'component': './views/Login.vue' } ] } if __name__ == '__main__': app.run(debug=True, host='127.0.0.1', port=5000) 前端代码 App.vue \u003cscript setup\u003e import {onMounted} from \"vue\"; import axios from \"axios\"; import {useRouter} from \"vue-router\"; const router = useRouter() // 启动项目之后才加载登录路由 onMounted(async () =\u003e { const response = await axios.get('http://127.0.0.1:5000/menus') const data = response.data data.routes.forEach((v) =\u003e { router.addRoute({ path: v.path, name: v.name, component: () =\u003e import(/* @vite-ignore */ `./components/${v.component}`) }) }) await router.push('/login') }) \u003c/script\u003e \u003ctemplate\u003e \u003crouter-view\u003e\u003c/router-view\u003e \u003c/template\u003e \u003cstyle\u003e * { margin: 0; padding: 0; box-sizing: border-box; } html, body, #app { width: 100%; height: 100%; } \u003c/style\u003e router.js import { createRouter, createWebHistory } from 'vue-router' // @ 路径 console.log(import.meta.url) const routes = [ { path: '/login', name: 'login', component: () =\u003e import('@/components/login.vue') }, { path: '/main', name: 'main', component: () =\u003e import('@/components/main.vue') } ] const router = createRouter({ history: createWebHistory(), routes }) export default router login.vue \u003ctemplate\u003e \u003cdiv class=\"login\"\u003e \u003cel-form :model=\"formInline\" class=\"demo-form-inline\"\u003e \u003cel-form-item label=\"用户名：\"\u003e \u003cel-input v-model=\"formInline.username\" placeholder=\"请输入用户名\"/\u003e \u003c/el-form-item\u003e \u003cel-form-item label=\"密\u0026nbsp;\u0026nbsp;\u0026nbsp;码：\"\u003e \u003cel-input v-model=\"formInline.password\" placeholder=\"请输入密码\"\u003e \u003c/el-input\u003e \u003c/el-form-item\u003e \u003cel-form-item\u003e \u003cel-button type=\"primary\" @click=\"onSubmit\"\u003e提交登录\u003c/el-button\u003e \u003c/el-form-item\u003e \u003c/el-form\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript setup\u003e import axios from 'axios'; import {reactive} from 'vue' import {useRouter} from \"vue-router\"; const router = useRouter() const formInline = reactive({ username: '', password: '', }) const onSubmit = async () =\u003e { const response = await axios.post('http://127.0.0.1:5000/login', formInline) const data = response.data console.log(data) // 登录成功之后, 解析后端返回的路由数据 if (data?.routes) { data.routes.forEach((v) =\u003e { console.log(v) const path = v?.parent ? `./${v.parent}/${v.component}` : `./${v.component}` router.addRoute('main', { path: '/main' + v.path, name: v.name, component: () =\u003e import(/* @vite-ignore */ path) }) }) console.log(router.getRoutes()) await router.push('/main') } } \u003c/script\u003e \u003cstyle scoped\u003e .login { width: 30%; margin: 100px auto; } \u003c/style\u003e main.js \u003ctemplate\u003e \u003ch1\u003eMain\u003c/h1\u003e \u003cdiv class=\"nav\"\u003e \u003crouter-link to=\"/main/articles\"\u003e阅读文章\u003c/router-link\u003e \u003crouter-link to=\"/main/hot\"\u003e排行热榜\u003c/router-link\u003e \u003crouter-link to=\"/main/author\"\u003e作者排行\u003c/router-link\u003e \u003c/div\u003e \u003cdiv class=\"subview\"\u003e \u003crouter-view\u003e\u003c/router-view\u003e \u003c/div\u003e \u003c/template\u003e \u003cscript setup\u003e \u003c/script\u003e \u003cstyle scoped\u003e .nav a { margin: 20px; } \u003c/style\u003e ","wordCount":"18308","inLanguage":"zh-cn","datePublished":"2023-03-11T21:05:54+08:00","dateModified":"2023-03-22T21:05:54+08:00","author":{"@type":"Person","name":"Waite Wang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://waite.wang/posts/vue/system-learn-vue-4-animation-router/"},"publisher":{"@type":"Organization","name":"隶笔难书","logo":{"@type":"ImageObject","url":"https://waite.wang/images/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://waite.wang/ accesskey=h title="隶笔难书 (Alt + H)">隶笔难书</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://waite.wang/ title=首页><span>首页</span></a></li><li><a href=https://waite.wang/search title=搜索><span>搜索</span></a></li><li><a href=https://waite.wang/categories title=分类><span>分类</span></a></li><li><a href=https://waite.wang/tags title=标签><span>标签</span></a></li><li><a href=https://waite.wang/archives title=归档><span>归档</span></a></li><li><a href=https://waite.wang/links title=友链><span>友链</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://waite.wang/>Home</a>&nbsp;»&nbsp;<a href=https://waite.wang/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">系统学习 Vue -- 4. 动画和路由</h1><div class=post-description>Vue 学习笔记-Vue 动画和路由</div><div class=post-meta><span title='2023-03-11 21:05:54 +0800 +0800'>2023-03-11</span>&nbsp;·&nbsp;37 min&nbsp;·&nbsp;18308 words&nbsp;·&nbsp;Waite Wang&nbsp;|&nbsp;<a href=https://github.com/Waite0603/HugoBlog/edit/main/content/posts/vue/system-learn-vue-4-animation-router.md rel="noopener noreferrer" target=_blank>在 GitHub 编辑</a>
&nbsp; | Last Updated:&nbsp;2023-03-22</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#vue-%e8%bf%87%e6%b8%a1%e4%b8%8e%e5%8a%a8%e7%94%bb%e5%88%9d%e4%bd%93%e9%aa%8c aria-label="Vue 过渡与动画初体验">Vue 过渡与动画初体验</a><ul><li><a href=#%e8%ae%a4%e8%af%86%e5%8a%a8%e7%94%bb aria-label=认识动画>认识动画</a></li><li><a href=#vue%e7%9a%84-transition-%e5%8a%a8%e7%94%bb aria-label="Vue的 transition 动画">Vue的 transition 动画</a><ul><li><a href=#%e5%9f%ba%e4%ba%8e-css-%e7%9a%84%e8%bf%87%e6%b8%a1%e6%95%88%e6%9e%9c aria-label="基于 CSS 的过渡效果">基于 CSS 的过渡效果</a><ul><li><a href=#%e4%b8%ba%e8%bf%87%e6%b8%a1%e6%95%88%e6%9e%9c%e5%91%bd%e5%90%8d aria-label=为过渡效果命名>为过渡效果命名</a></li><li><a href=#css-%e7%9a%84-transition aria-label="CSS 的 transition">CSS 的 transition</a></li></ul></li></ul></li><li><a href=#css-%e7%9a%84-animation aria-label="CSS 的 animation">CSS 的 animation</a></li><li><a href=#%e5%90%8c%e6%97%b6%e8%ae%be%e7%bd%ae%e8%bf%87%e6%b8%a1%e5%92%8c%e5%8a%a8%e7%94%bb aria-label=同时设置过渡和动画>同时设置过渡和动画</a><ul><li><a href=#%e7%a4%ba%e4%be%8b aria-label=示例>示例</a></li></ul></li><li><a href=#javascript-%e9%92%a9%e5%ad%90 aria-label="JavaScript 钩子">JavaScript 钩子</a></li><li><a href=#%e7%ac%ac%e4%b8%89%e6%96%b9%e5%ba%93%e7%9a%84%e4%bd%bf%e7%94%a8 aria-label=第三方库的使用>第三方库的使用</a><ul><li><a href=#animatecss aria-label=animate.css>animate.css</a></li><li><a href=#gsap aria-label=gsap>gsap</a></li><li><a href=#gsap-%e6%95%b0%e5%ad%97%e9%80%92%e5%a2%9e%e6%95%88%e6%9e%9c aria-label="gsap 数字递增效果">gsap 数字递增效果</a></li></ul></li><li><a href=#%e8%ae%a4%e8%af%86%e5%88%97%e8%a1%a8%e7%9a%84%e8%bf%87%e6%b8%a1 aria-label=认识列表的过渡>认识列表的过渡</a><ul><li><a href=#%e5%9f%ba%e6%9c%ac%e4%bd%bf%e7%94%a8 aria-label=基本使用>基本使用</a></li><li><a href=#%e5%88%97%e8%a1%a8%e8%bf%87%e6%b8%a1%e7%9a%84%e7%a7%bb%e5%8a%a8%e5%8a%a8%e7%94%bb aria-label=列表过渡的移动动画>列表过渡的移动动画</a></li><li><a href=#%e6%bc%94%e7%bb%83--%e5%88%97%e8%a1%a8%e7%9a%84%e4%ba%a4%e6%9b%bf%e5%8a%a8%e7%94%bb aria-label="演练 => 列表的交替动画">演练 => 列表的交替动画</a></li></ul></li></ul></li><li><a href=#%e8%b7%af%e7%94%b1%e4%bd%bf%e7%94%a8 aria-label=路由使用>路由使用</a><ul><li><a href=#%e5%85%b3%e4%ba%8e%e8%b7%af%e7%94%b1 aria-label=关于路由>关于路由</a><ul><li><a href=#%e8%ae%a4%e8%af%86%e5%89%8d%e7%ab%af%e8%b7%af%e7%94%b1 aria-label=认识前端路由>认识前端路由</a></li><li><a href=#%e5%90%8e%e7%ab%af%e8%b7%af%e7%94%b1%e9%98%b6%e6%ae%b5 aria-label=后端路由阶段>后端路由阶段</a></li><li><a href=#%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e9%98%b6%e6%ae%b5 aria-label=前后端分离阶段>前后端分离阶段</a></li><li><a href=#%e5%8d%95%e9%a1%b5%e9%9d%a2%e5%af%8c%e5%ba%94%e7%94%a8spa aria-label=单页面富应用（SPA）>单页面富应用（SPA）</a></li></ul></li><li><a href=#vue-router-%e7%ae%80%e4%bb%8b aria-label="Vue-router 简介">Vue-router 简介</a></li><li><a href=#%e8%b7%af%e7%94%b1%e5%88%9d%e4%bd%93%e9%aa%8c aria-label=路由初体验>路由初体验</a><ul><li><a href=#router-link aria-label=router-link>router-link</a></li><li><a href=#router-view aria-label=router-view>router-view</a></li></ul></li><li><a href=#%e5%ae%89%e8%a3%85%e4%bb%a5%e5%8f%8a%e4%bd%bf%e7%94%a8 aria-label=安装以及使用>安装以及使用</a></li><li><a href=#%e5%b8%a6%e5%8f%82%e6%95%b0%e7%9a%84%e5%8a%a8%e6%80%81%e8%b7%af%e7%94%b1%e5%8c%b9%e9%85%8d aria-label=带参数的动态路由匹配>带参数的动态路由匹配</a></li><li><a href=#%e5%a3%b0%e6%98%8e%e5%bc%8f-%e7%bc%96%e7%a8%8b%e5%bc%8f%e5%af%bc%e8%88%aa aria-label="声明式/ 编程式导航">声明式/ 编程式导航</a><ul><li><a href=#%e5%a3%b0%e6%98%8e%e5%bc%8f%e5%af%bc%e8%88%aa aria-label=声明式导航>声明式导航</a><ul><li><a href=#%e5%9f%ba%e7%a1%80%e4%bd%bf%e7%94%a8-%e5%91%bd%e5%90%8d%e8%b7%af%e7%94%b1 aria-label="基础使用/ 命名路由">基础使用/ 命名路由</a></li><li><a href=#%e8%b7%b3%e8%bd%ac%e4%bc%a0%e5%8f%82 aria-label=跳转传参>跳转传参</a></li><li><a href=#%e6%8d%95%e8%8e%b7%e6%89%80%e6%9c%89%e8%b7%af%e7%94%b1%e6%88%96-404-not-found-%e8%b7%af%e7%94%b1 aria-label="捕获所有路由或 404 Not found 路由">捕获所有路由或 404 Not found 路由</a></li></ul></li><li><a href=#%e7%bc%96%e7%a8%8b%e5%bc%8f%e5%af%bc%e8%88%aa aria-label=编程式导航>编程式导航</a><ul><li><a href=#%e5%af%bc%e8%88%aa%e5%88%b0%e4%b8%8d%e5%90%8c%e7%9a%84%e4%bd%8d%e7%bd%ae aria-label=导航到不同的位置>导航到不同的位置</a></li><li><a href=#%e5%9f%ba%e7%a1%80%e4%bd%bf%e7%94%a8 aria-label=基础使用>基础使用</a></li></ul></li></ul></li><li><a href=#%e6%a8%aa%e8%b7%a8%e5%8e%86%e5%8f%b2 aria-label=横跨历史>横跨历史</a></li><li><a href=#%e6%9b%bf%e6%8d%a2%e5%bd%93%e5%89%8d%e4%bd%8d%e7%bd%ae aria-label=替换当前位置>替换当前位置</a></li><li><a href=#%e9%87%8d%e5%ae%9a%e5%90%91 aria-label=重定向>重定向</a></li><li><a href=#%e5%88%ab%e5%90%8d aria-label=别名>别名</a></li></ul></li><li><a href=#%e8%b7%af%e7%94%b1%e8%bf%9b%e9%98%b6 aria-label=路由进阶>路由进阶</a><ul><li><a href=#%e8%b7%af%e7%94%b1%e5%b5%8c%e5%a5%97 aria-label=路由嵌套>路由嵌套</a></li><li><a href=#%e5%af%bc%e8%88%aa%e5%ae%88%e5%8d%ab aria-label=导航守卫>导航守卫</a><ul><li><a href=#%e5%85%a8%e5%b1%80%e5%89%8d%e7%bd%ae%e5%ae%88%e5%8d%ab aria-label=全局前置守卫>全局前置守卫</a></li><li><a href=#%e5%85%a8%e5%b1%80%e5%90%8e%e7%bd%ae%e9%92%a9%e5%ad%90 aria-label=全局后置钩子>全局后置钩子</a></li><li><a href=#%e8%b7%af%e7%94%b1%e7%8b%ac%e4%ba%ab%e7%9a%84%e5%ae%88%e5%8d%ab aria-label=路由独享的守卫>路由独享的守卫</a></li><li><a href=#%e7%bb%84%e4%bb%b6%e5%86%85%e7%9a%84%e5%ae%88%e5%8d%ab aria-label=组件内的守卫>组件内的守卫</a></li><li><a href=#%e5%8f%af%e7%94%a8%e7%9a%84%e9%85%8d%e7%bd%ae-api aria-label="可用的配置 API">可用的配置 API</a><ul><li><a href=#%e4%bd%bf%e7%94%a8%e7%bb%84%e5%90%88-ap aria-label="使用组合 AP">使用组合 AP</a></li></ul></li><li><a href=#%e5%ae%8c%e6%95%b4%e7%9a%84%e5%af%bc%e8%88%aa%e8%a7%a3%e6%9e%90%e6%b5%81%e7%a8%8b aria-label=完整的导航解析流程>完整的导航解析流程</a></li></ul></li><li><a href=#%e8%b7%af%e7%94%b1%e6%a1%88%e4%be%8b aria-label=路由案例>路由案例</a><ul><li><a href=#%e7%99%bb%e5%bd%95%e6%8b%a6%e6%88%aa aria-label=登录拦截>登录拦截</a></li><li><a href=#%e6%9d%83%e9%99%90%e5%88%a4%e6%96%ad aria-label=权限判断>权限判断</a></li></ul></li><li><a href=#%e8%b7%af%e7%94%b1%e5%8e%9f%e4%bf%a1%e6%81%af aria-label=路由原信息>路由原信息</a></li><li><a href=#%e8%bf%87%e6%b8%a1%e5%8a%a8%e6%95%88 aria-label=过渡动效>过渡动效</a></li><li><a href=#%e6%bb%9a%e5%8a%a8%e8%a1%8c%e4%b8%ba aria-label=滚动行为>滚动行为</a></li><li><a href=#%e5%8a%a8%e6%80%81%e8%b7%af%e7%94%b1 aria-label=动态路由>动态路由</a><ul><li><a href=#%e6%b7%bb%e5%8a%a0%e8%b7%af%e7%94%b1 aria-label=添加路由>添加路由</a></li><li><a href=#%e5%88%a0%e9%99%a4%e8%b7%af%e7%94%b1 aria-label=删除路由>删除路由</a></li><li><a href=#%e6%9f%a5%e7%9c%8b%e7%8e%b0%e6%9c%89%e8%b7%af%e7%94%b1 aria-label=查看现有路由>查看现有路由</a></li></ul></li><li><a href=#%e5%8a%a8%e6%80%81%e8%b7%af%e7%94%b1%e6%a1%88%e4%be%8b aria-label=动态路由案例>动态路由案例</a><ul><li><a href=#%e5%90%8e%e7%ab%af%e4%bb%a3%e7%a0%81---python-flask aria-label="后端代码 -> Python Flask">后端代码 -> Python Flask</a></li><li><a href=#%e5%89%8d%e7%ab%af%e4%bb%a3%e7%a0%81 aria-label=前端代码>前端代码</a></li></ul></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=vue-过渡与动画初体验>Vue 过渡与动画初体验<a hidden class=anchor aria-hidden=true href=#vue-过渡与动画初体验>#</a></h2><h3 id=认识动画>认识动画<a hidden class=anchor aria-hidden=true href=#认识动画>#</a></h3><ul><li>在开发中，我们想要给一个组件的显示和消失添加某种过渡动画，可以很好的增加用户体验：<ul><li>React框架本身并没有提供任何动画相关的API，所以在React中使用过渡动画我们需要使用一个第三方库 react-transition-group；</li><li>Vue中为我们提供一些内置组件和对应的API来完成动画，利用它们我们可以方便的实现过渡动画效果；</li></ul></li><li>我们来看一个案例：<ul><li>Hello World的显示和隐藏；</li><li>通过下面的代码实现，是不会有任何动画效果的；</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;toggle&#34;</span><span class=p>&gt;</span><span class=na>显示</span><span class=err>/</span><span class=na>隐藏</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h2</span> <span class=nt>v-if</span><span class=o>=</span><span class=s>&#34;show&#34;</span><span class=p>&gt;</span><span class=na>App组件</span><span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>show</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>toggle</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>show</span> <span class=o>=</span> <span class=o>!</span><span class=k>this</span><span class=p>.</span><span class=nx>show</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><ul><li>没有动画的情况下，整个内容的显示和隐藏会非常的生硬：<ul><li>如果我们希望给单元素或者组件实现过渡动画，可以使用 <code>transition</code>内置组件来完成动画；</li></ul></li></ul><h3 id=vue的-transition-动画>Vue的 transition 动画<a hidden class=anchor aria-hidden=true href=#vue的-transition-动画>#</a></h3><blockquote><p><a href=https://cn.vuejs.org/guide/built-ins/transition.html#transition target=_blank>https://cn.vuejs.org/guide/built-ins/transition.html#transition</a></p></blockquote><p><code>&lt;Transition></code> 会在一个元素或组件进入和离开 DOM 时应用动画。</p><p><code>&lt;Transition></code> 是一个内置组件，这意味着它在任意别的组件中都可以被使用，无需注册。它可以将进入和离开动画应用到通过默认插槽传递给它的元素或组件上。进入或离开可以由以下的条件之一触发：</p><ul><li>由 <code>v-if</code> 所触发的切换</li><li>由 <code>v-show</code> 所触发的切换</li><li>由特殊元素 <code>&lt;component></code> 切换的动态组件</li><li>改变特殊的 <code>key</code> 属性</li></ul><p>以下是最基本用法的示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;show = !show&#34;</span><span class=p>&gt;</span><span class=na>Toggle</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=nt>v-if</span><span class=o>=</span><span class=s>&#34;show&#34;</span><span class=p>&gt;</span><span class=na>hello</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=c>/* 下面我们会解释这些 class 是做什么的 */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>v-enter-active</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>v-leave-active</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>transition</span><span class=p>:</span> <span class=k>opacity</span> <span class=mf>0.5</span><span class=kt>s</span> <span class=kc>ease</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>v-enter-from</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>v-leave-to</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>opacity</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><blockquote><p><code>&lt;Transition></code> 仅支持单个元素或组件作为其插槽内容。如果内容是一个组件，这个组件必须仅有一个根元素。</p></blockquote><p>当一个 <code>&lt;Transition></code> 组件中的元素被插入或移除时，会发生下面这些事情：</p><ol><li>Vue 会自动检测目标元素是否应用了 CSS 过渡或动画。如果是，则一些
<a href=https://cn.vuejs.org/guide/built-ins/transition.html#transition-classes target=_blank>CSS 过渡 class</a> 会在适当的时机被添加和移除。</li><li>如果有作为监听器的
<a href=https://cn.vuejs.org/guide/built-ins/transition.html#javascript-hooks target=_blank>JavaScript 钩子</a>，这些钩子函数会在适当时机被调用。</li><li>如果没有探测到 CSS 过渡或动画、也没有提供 JavaScript 钩子，那么 DOM 的插入、删除操作将在浏览器的下一个动画帧后执行。</li></ol><h4 id=基于-css-的过渡效果>基于 CSS 的过渡效果<a hidden class=anchor aria-hidden=true href=#基于-css-的过渡效果>#</a></h4><h5 id=css-过渡-class><a href=https://cn.vuejs.org/guide/built-ins/transition.html#transition-classes target=_blank>CSS 过渡 class</a></h5><p>一共有 6 个应用于进入与离开过渡效果的 CSS class。</p><p><img alt=过渡图示 loading=lazy src=https://qiniu.waite.wang/202312111414504.png></p><ol><li><code>v-enter-from</code>：进入动画的起始状态。在元素插入之前添加，在元素插入完成后的下一帧移除。</li><li><code>v-enter-active</code>：进入动画的生效状态。应用于整个进入动画阶段。在元素被插入之前添加，在过渡或动画完成之后移除。这个 class 可以被用来定义进入动画的持续时间、延迟与速度曲线类型。</li><li><code>v-enter-to</code>：进入动画的结束状态。在元素插入完成后的下一帧被添加 (也就是 <code>v-enter-from</code> 被移除的同时)，在过渡或动画完成之后移除。</li><li><code>v-leave-from</code>：离开动画的起始状态。在离开过渡效果被触发时立即添加，在一帧后被移除。</li><li><code>v-leave-active</code>：离开动画的生效状态。应用于整个离开动画阶段。在离开过渡效果被触发时立即添加，在过渡或动画完成之后移除。这个 class 可以被用来定义离开动画的持续时间、延迟与速度曲线类型。</li><li><code>v-leave-to</code>：离开动画的结束状态。在一个离开动画被触发后的下一帧被添加 (也就是 <code>v-leave-from</code> 被移除的同时)，在过渡或动画完成之后移除。</li></ol><h5 id=为过渡效果命名>为过渡效果命名<a hidden class=anchor aria-hidden=true href=#为过渡效果命名>#</a></h5><p>我们可以给 <code>&lt;Transition></code> 组件传一个 <code>name</code> prop 来声明一个过渡效果名：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Transition</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;fade&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>对于一个有名字的过渡效果，对它起作用的过渡 class 会以其名字而不是 <code>v</code> 作为前缀。比如，上方例子中被应用的 class 将会是 <code>fade-enter-active</code> 而不是 <code>v-enter-active</code>。这个“fade”过渡的 class 应该是这样：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=p>.</span><span class=nc>fade-enter-active</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>fade-leave-active</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>transition</span><span class=p>:</span> <span class=k>opacity</span> <span class=mf>0.5</span><span class=kt>s</span> <span class=kc>ease</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>fade-enter-from</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>fade-leave-to</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>opacity</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=css-的-transition>CSS 的 transition<a hidden class=anchor aria-hidden=true href=#css-的-transition>#</a></h5><p><code>&lt;Transition></code> 一般都会搭配
<a href=https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Transitions/Using_CSS_transitions target=_blank>原生 CSS 过渡</a>一起使用，正如你在上面的例子中所看到的那样。这个 <code>transition</code> CSS 属性是一个简写形式，使我们可以一次定义一个过渡的各个方面，包括需要执行动画的属性、持续时间和
<a href=https://developer.mozilla.org/en-US/docs/Web/CSS/easing-function target=_blank>速度曲线</a>。</p><p>下面是一个更高级的例子，它使用了不同的持续时间和速度曲线来过渡多个属性：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Transition</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;slide-fade&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=nt>v-if</span><span class=o>=</span><span class=s>&#34;show&#34;</span><span class=p>&gt;</span><span class=na>hello</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=c>/*
</span></span></span><span class=line><span class=cl><span class=c>  进入和离开动画可以使用不同
</span></span></span><span class=line><span class=cl><span class=c>  持续时间和速度曲线。
</span></span></span><span class=line><span class=cl><span class=c>*/</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>slide-fade-enter-active</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>transition</span><span class=p>:</span> <span class=kc>all</span> <span class=mf>0.3</span><span class=kt>s</span> <span class=kc>ease-out</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>slide-fade-leave-active</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>transition</span><span class=p>:</span> <span class=kc>all</span> <span class=mf>0.8</span><span class=kt>s</span> <span class=nb>cubic-bezier</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.8</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>slide-fade-enter-from</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>slide-fade-leave-to</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>transform</span><span class=p>:</span> <span class=nb>translateX</span><span class=p>(</span><span class=mi>20</span><span class=kt>px</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>opacity</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=css-的-animation>CSS 的 animation<a hidden class=anchor aria-hidden=true href=#css-的-animation>#</a></h3><blockquote><p>帧动画, 可以指定在什么时间是什么状态!</p></blockquote><p><a href=https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Animations/Using_CSS_animations target=_blank>原生 CSS 动画</a>和 CSS transition 的应用方式基本上是相同的，只有一点不同，那就是 <code>*-enter-from</code> 不是在元素插入后立即移除，而是在一个 <code>animationend</code> 事件触发时被移除。</p><p>对于大多数的 CSS 动画，我们可以简单地在 <code>*-enter-active</code> 和 <code>*-leave-active</code> class 下声明它们。下面是一个示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Transition</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;bounce&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=nt>v-if</span><span class=o>=</span><span class=s>&#34;show&#34; style=&#34;text-align: center;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=na>Hello</span> <span class=na>here</span> <span class=na>is</span> <span class=na>some</span> <span class=na>bouncy</span> <span class=na>text</span><span class=err>!</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=p>.</span><span class=nc>bounce-enter-active</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>animation</span><span class=p>:</span> <span class=n>bounce-in</span> <span class=mf>0.5</span><span class=kt>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>bounce-leave-active</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>animation</span><span class=p>:</span> <span class=n>bounce-in</span> <span class=mf>0.5</span><span class=kt>s</span> <span class=kc>reverse</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>@</span><span class=k>keyframes</span> <span class=nt>bounce-in</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>0</span><span class=o>%</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>transform</span><span class=p>:</span> <span class=nb>scale</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nt>50</span><span class=o>%</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>transform</span><span class=p>:</span> <span class=nb>scale</span><span class=p>(</span><span class=mf>1.25</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nt>100</span><span class=o>%</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>transform</span><span class=p>:</span> <span class=nb>scale</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=自定义过渡-class><a href=https://cn.vuejs.org/guide/built-ins/transition.html#custom-transition-classes target=_blank>自定义过渡 class</a></h3><p>你也可以向 <code>&lt;Transition></code> 传递以下的 props 来指定自定义的过渡 class：</p><ul><li><code>enter-from-class</code></li><li><code>enter-active-class</code></li><li><code>enter-to-class</code></li><li><code>leave-from-class</code></li><li><code>leave-active-class</code></li><li><code>leave-to-class</code></li></ul><p>他们的优先级高于普通的类名，这对于 Vue 的过渡系统和其他第三方 CSS 动画库，如 Animate.css.</p><p>你传入的这些 class 会覆盖相应阶段的默认 class 名。这个功能在你想要在 Vue 的动画机制下集成其他的第三方 CSS 动画库时非常有用，比如
<a href=https://daneden.github.io/animate.css/ target=_blank>Animate.css</a>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>show</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl> <span class=p>&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;show = !show&#34;</span><span class=p>&gt;</span><span class=na>Toggle</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>Transition</span>
</span></span><span class=line><span class=cl>    <span class=na>name</span><span class=o>=</span><span class=s>&#34;custom-classes&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>enter</span><span class=nt>-active-class</span><span class=err>=&#34;</span><span class=na>animate__animated</span> <span class=na>animate__tada</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>leave</span><span class=nt>-active-class</span><span class=err>=&#34;</span><span class=na>animate__animated</span> <span class=na>animate__bounceOutRight</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span> <span class=nt>v-if</span><span class=o>=</span><span class=s>&#34;show&#34;</span><span class=p>&gt;</span><span class=na>hello</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=err>@</span><span class=kr>import</span> <span class=s2>&#34;https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=同时设置过渡和动画>同时设置过渡和动画<a hidden class=anchor aria-hidden=true href=#同时设置过渡和动画>#</a></h3><ul><li>Vue为了知道过渡的完成，内部是在监听 <code>transitionend</code>或 <code>animationend</code>，到底使用哪一个取决于元素应用的 CSS规则：<ul><li>如果我们只是使用了其中的一个，那么Vue能自动识别类型并设置监听；</li></ul></li><li>但是如果我们同时使用了过渡和动画呢？<ul><li>并且在这个情况下可能某一个动画执行结束时，另外一个动画还没有结束；</li><li>在这种情况下，我们可以设置 type 属性为 animation 或者 transition 来明确的告知Vue监听的类型；</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Transition</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;animation&#34;</span><span class=p>&gt;...&lt;/</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=深层级过渡与显式过渡时长><a href=https://cn.vuejs.org/guide/built-ins/transition.html#nested-transitions-and-explicit-transition-durations target=_blank>深层级过渡与显式过渡时长</a></h3><p>尽管过渡 class 仅能应用在 <code>&lt;Transition></code> 的直接子元素上，我们还是可以使用深层级的 CSS 选择器，在深层级的元素上触发过渡效果。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Transition</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;nested&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=nt>v-if</span><span class=o>=</span><span class=s>&#34;show&#34; class=&#34;outer&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;inner&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nx>Hello</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=c>/* 应用于嵌套元素的规则 */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>nested-enter-active</span> <span class=p>.</span><span class=nc>inner</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>nested-leave-active</span> <span class=p>.</span><span class=nc>inner</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>transition</span><span class=p>:</span> <span class=kc>all</span> <span class=mf>0.3</span><span class=kt>s</span> <span class=kc>ease-in-out</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>nested-enter-from</span> <span class=p>.</span><span class=nc>inner</span><span class=o>,</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>nested-leave-to</span> <span class=p>.</span><span class=nc>inner</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>transform</span><span class=p>:</span> <span class=nb>translateX</span><span class=p>(</span><span class=mi>30</span><span class=kt>px</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>opacity</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* ... 省略了其他必要的 CSS */</span>
</span></span></code></pre></div><p>我们甚至可以在深层元素上添加一个过渡延迟，从而创建一个带渐进延迟的动画序列：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=c>/* 延迟嵌套元素的进入以获得交错效果 */</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>nested-enter-active</span> <span class=p>.</span><span class=nc>inner</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>transition-delay</span><span class=p>:</span> <span class=mf>0.25</span><span class=kt>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>然而，这会带来一个小问题。默认情况下，<code>&lt;Transition></code> 组件会通过监听过渡根元素上的<strong>第一个</strong> <code>transitionend</code> 或者 <code>animationend</code> 事件来尝试自动判断过渡何时结束。而在嵌套的过渡中，期望的行为应该是等待所有内部元素的过渡完成。</p><p>在这种情况下，你可以通过向 <code>&lt;Transition></code> 组件传入 <code>duration</code> prop 来显式指定过渡的持续时间 (以毫秒为单位)。总持续时间应该匹配延迟加上内部元素的过渡持续时间：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=o>&lt;</span><span class=nt>Transition</span> <span class=p>:</span><span class=nd>duration</span><span class=o>=</span><span class=s2>&#34;550&#34;</span><span class=o>&gt;...&lt;/</span><span class=nt>Transition</span><span class=o>&gt;</span>
</span></span></code></pre></div><p>如果有必要的话，你也可以用对象的形式传入，分开指定进入和离开所需的时间：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Transition</span> <span class=o>:</span><span class=na>duration</span><span class=o>=</span><span class=s>&#34;{ enter: 500, leave: 800 }&#34;</span><span class=p>&gt;...&lt;/</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=过渡模式><a href=https://cn.vuejs.org/guide/built-ins/transition.html#transition-modes target=_blank>过渡模式</a></h3><p>在之前的例子中，进入和离开的元素都是在同时开始动画的，因此我们不得不将它们设为 <code>position: absolute</code> 以避免二者同时存在时出现的布局问题。</p><p>然而，很多情况下这可能并不符合需求。我们可能想要先执行离开动画，然后在其完成<strong>之后</strong>再执行元素的进入动画。手动编排这样的动画是非常复杂的，好在我们可以通过向 <code>&lt;Transition></code> 传入一个 <code>mode</code> prop 来实现这个行为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Transition</span> <span class=na>mode</span><span class=o>=</span><span class=s>&#34;out-in&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span></code></pre></div><p><code>&lt;Transition></code> 也支持 <code>mode="in-out"</code>，虽然这并不常用。</p><p><code>&lt;Transition></code> 也可以作用于
<a href=https://cn.vuejs.org/guide/essentials/component-basics.html#dynamic-components target=_blank>动态组件</a>之间的切换：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Transition</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;fade&#34;</span> <span class=na>mode</span><span class=o>=</span><span class=s>&#34;out-in&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>component</span> <span class=nt>:is</span><span class=o>=</span><span class=s>&#34;activeComponent&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>component</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=出现时过渡><a href=https://cn.vuejs.org/guide/built-ins/transition.html#transition-on-appear target=_blank>出现时过渡</a></h4><p>如果你想在某个节点初次渲染时应用一个过渡效果，你可以添加 <code>appear</code> prop：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Transition</span> <span class=na>appear</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=元素间过渡><a href=https://cn.vuejs.org/guide/built-ins/transition.html#transition-between-elements target=_blank>元素间过渡</a></h4><p>除了通过 <code>v-if</code> / <code>v-show</code> 切换一个元素，我们也可以通过 <code>v-if</code> / <code>v-else</code> / <code>v-else-if</code> 在几个组件间进行切换，只要确保任一时刻只会有一个元素被渲染即可：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>button</span> <span class=nt>v-if</span><span class=o>=</span><span class=s>&#34;docState === &#39;saved&#39;&#34;</span><span class=p>&gt;</span><span class=na>Edit</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>button</span> <span class=nt>v-else-if</span><span class=o>=</span><span class=s>&#34;docState === &#39;edited&#39;&#34;</span><span class=p>&gt;</span><span class=na>Save</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>button</span> <span class=nt>v-else-if</span><span class=o>=</span><span class=s>&#34;docState === &#39;editing&#39;&#34;</span><span class=p>&gt;</span><span class=na>Cancel</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=示例>示例<a hidden class=anchor aria-hidden=true href=#示例>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;app&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;isShow = !isShow&#34;</span><span class=p>&gt;</span><span class=na>显示</span><span class=err>/</span><span class=na>隐藏</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>transition</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;why&#34;</span> <span class=na>mode</span><span class=o>=</span><span class=s>&#34;out-in&#34;</span> <span class=na>appear</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>component</span> <span class=o>:</span><span class=na>is</span><span class=o>=</span><span class=s>&#34;isShow ? &#39;home&#39;: &#39;about&#39;&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>component</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>transition</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=kr>import</span> <span class=nx>Home</span> <span class=nx>from</span> <span class=s1>&#39;./pages/Home.vue&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>import</span> <span class=nx>About</span> <span class=nx>from</span> <span class=s1>&#39;./pages/About.vue&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>components</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>Home</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>About</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>isShow</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>style</span> <span class=na>scoped</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>app</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>width</span><span class=o>:</span> <span class=mi>200</span><span class=nx>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>margin</span><span class=o>:</span> <span class=mi>0</span> <span class=nx>auto</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>title</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>display</span><span class=o>:</span> <span class=nx>inline</span><span class=o>-</span><span class=nx>block</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>why</span><span class=o>-</span><span class=nx>enter</span><span class=o>-</span><span class=nx>from</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>why</span><span class=o>-</span><span class=nx>leave</span><span class=o>-</span><span class=nx>to</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>opacity</span><span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>why</span><span class=o>-</span><span class=nx>enter</span><span class=o>-</span><span class=nx>active</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>why</span><span class=o>-</span><span class=nx>leave</span><span class=o>-</span><span class=nx>active</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>transition</span><span class=o>:</span> <span class=nx>opacity</span> <span class=mi>1</span><span class=nx>s</span> <span class=nx>ease</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>why</span><span class=o>-</span><span class=nx>enter</span><span class=o>-</span><span class=nx>active</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>animation</span><span class=o>:</span> <span class=nx>bounce</span> <span class=mi>1</span><span class=nx>s</span> <span class=nx>ease</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>why</span><span class=o>-</span><span class=nx>leave</span><span class=o>-</span><span class=nx>active</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>animation</span><span class=o>:</span> <span class=nx>bounce</span> <span class=mi>1</span><span class=nx>s</span> <span class=nx>ease</span> <span class=nx>reverse</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=nx>keyframes</span> <span class=nx>bounce</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=mi>0</span><span class=o>%</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>transform</span><span class=o>:</span> <span class=nx>scale</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=mi>50</span><span class=o>%</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>transform</span><span class=o>:</span> <span class=nx>scale</span><span class=p>(</span><span class=mf>1.2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=mi>100</span><span class=o>%</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>transform</span><span class=o>:</span> <span class=nx>scale</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=javascript-钩子>JavaScript 钩子<a hidden class=anchor aria-hidden=true href=#javascript-钩子>#</a></h3><p>你可以通过监听 <code>&lt;Transition></code> 组件事件的方式在过渡过程中挂上钩子函数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Transition</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=na>before-enter</span><span class=o>=</span><span class=s>&#34;onBeforeEnter&#34;</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=na>enter</span><span class=o>=</span><span class=s>&#34;onEnter&#34;</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=na>after-enter</span><span class=o>=</span><span class=s>&#34;onAfterEnter&#34;</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=na>enter-cancelled</span><span class=o>=</span><span class=s>&#34;onEnterCancelled&#34;</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=na>before-leave</span><span class=o>=</span><span class=s>&#34;onBeforeLeave&#34;</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=na>leave</span><span class=o>=</span><span class=s>&#34;onLeave&#34;</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=na>after-leave</span><span class=o>=</span><span class=s>&#34;onAfterLeave&#34;</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=na>leave-cancelled</span><span class=o>=</span><span class=s>&#34;onLeaveCancelled&#34;</span>
</span></span><span class=line><span class=cl><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=c>&lt;!-- ... --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 在元素被插入到 DOM 之前被调用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 用这个来设置元素的 &#34;enter-from&#34; 状态
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>onBeforeEnter</span><span class=p>(</span><span class=nx>el</span><span class=p>)</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 在元素被插入到 DOM 之后的下一帧被调用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 用这个来开始进入动画
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>onEnter</span><span class=p>(</span><span class=nx>el</span><span class=p>,</span> <span class=nx>done</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 调用回调函数 done 表示过渡结束
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>// 如果与 CSS 结合使用，则这个回调是可选参数
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 当进入过渡完成时调用。
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>onAfterEnter</span><span class=p>(</span><span class=nx>el</span><span class=p>)</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>    <span class=nx>onEnterCancelled</span><span class=p>(</span><span class=nx>el</span><span class=p>)</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 在 leave 钩子之前调用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 大多数时候，你应该只会用到 leave 钩子
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>onBeforeLeave</span><span class=p>(</span><span class=nx>el</span><span class=p>)</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 在离开过渡开始时调用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 用这个来开始离开动画
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>onLeave</span><span class=p>(</span><span class=nx>el</span><span class=p>,</span> <span class=nx>done</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 调用回调函数 done 表示过渡结束
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>// 如果与 CSS 结合使用，则这个回调是可选参数
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 在离开过渡完成、
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 且元素已从 DOM 中移除时调用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>onAfterLeave</span><span class=p>(</span><span class=nx>el</span><span class=p>)</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 仅在 v-show 过渡中可用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>onLeaveCancelled</span><span class=p>(</span><span class=nx>el</span><span class=p>)</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;app&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;isShow = !isShow&#34;</span><span class=p>&gt;</span><span class=na>显示</span><span class=err>/</span><span class=na>隐藏</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>transition</span> <span class=err>@</span><span class=na>before</span><span class=nt>-enter</span><span class=err>=&#34;</span><span class=na>beforeEnter</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>                <span class=nt>@enter</span><span class=s>=&#34;enter&#34;</span><span class=p>
</span></span></span><span class=line><span class=cl><span class=p></span>                <span class=err>@</span><span class=na>after</span><span class=nt>-enter</span><span class=err>=&#34;</span><span class=na>afterEnter</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>                <span class=err>@</span><span class=na>before</span><span class=nt>-leave</span><span class=err>=&#34;</span><span class=na>beforeLeave</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>                <span class=nt>@leave</span><span class=s>=&#34;leave&#34;</span><span class=p>
</span></span></span><span class=line><span class=cl><span class=p></span>                <span class=nt>@afterLeave</span><span class=s>=&#34;afterLeave&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>h2</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;title&#34;</span> <span class=nt>v-if</span><span class=o>=</span><span class=s>&#34;isShow&#34;</span><span class=p>&gt;</span><span class=na>Hello</span> <span class=na>World</span><span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>transition</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>isShow</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>beforeEnter</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;beforeEnter&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>enter</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;enter&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>afterEnter</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;afterEnter&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>beforeLeave</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;beforeLeave&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>leave</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;leave&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>afterLeave</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;afterLeave&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>style</span> <span class=na>scoped</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>title</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>display</span><span class=o>:</span> <span class=nx>inline</span><span class=o>-</span><span class=nx>block</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>这些钩子可以与 CSS 过渡或动画结合使用，也可以单独使用。</p><p>在使用仅由 JavaScript 执行的动画时，最好是添加一个 <code>:css="false"</code> prop。这显式地向 Vue 表明可以跳过对 CSS 过渡的自动探测。除了性能稍好一些之外，还可以防止 CSS 规则意外地干扰过渡效果。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Transition</span>
</span></span><span class=line><span class=cl>  <span class=na>...</span>
</span></span><span class=line><span class=cl>  <span class=nt>:css</span><span class=o>=</span><span class=s>&#34;false&#34;</span>
</span></span><span class=line><span class=cl><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>Transition</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>在有了 <code>:css="false"</code> 后，我们就自己全权负责控制什么时候过渡结束了。这种情况下对于 <code>@enter</code> 和 <code>@leave</code> 钩子来说，回调函数 <code>done</code> 就是必须的。否则，钩子将被同步调用，过渡将立即完成。</p><p>这里是使用
<a href=https://greensock.com/ target=_blank>GreenSock 库</a>执行动画的一个示例，你也可以使用任何你想要的库，比如
<a href=https://animejs.com/ target=_blank>Anime.js</a> 或者
<a href=https://motion.dev/ target=_blank>Motion One</a>。</p><h3 id=第三方库的使用>第三方库的使用<a hidden class=anchor aria-hidden=true href=#第三方库的使用>#</a></h3><h4 id=animatecss>animate.css<a hidden class=anchor aria-hidden=true href=#animatecss>#</a></h4><blockquote><p><a href=https://animate.style/ target=_blank>https://animate.style/</a></p></blockquote><ul><li>如果我们手动一个个来编写这些动画，那么效率是比较低的，所以在开发中我们可能会引用一些第三方库的动画库， 比如animate.css。</li><li>Animate.css是一个已经<strong>准备好的、跨平台的</strong>动画库为我们的web项目，对于强调、主页、滑动、注意力引导 非常有用；</li></ul><p><strong>如何使用?</strong></p><ul><li><p>安装animate.css：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>npm install animate.css 
</span></span></code></pre></div></li><li><p>在main.js中导入animate.css：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>createApp</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>App</span> <span class=nx>from</span> <span class=s1>&#39;./test/App.vue&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=s1>&#39;animate.css&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>createApp</span><span class=p>(</span><span class=nx>App</span><span class=p>).</span><span class=nx>mount</span><span class=p>(</span><span class=s1>&#39;#app&#39;</span><span class=p>)</span>
</span></span></code></pre></div></li><li><p>接下来在使用的时候我们有两种用法：</p><ul><li>用法一：直接使用animate库中定义的 keyframes 动画；</li><li>用法二：直接使用animate库提供给我们的类；</li></ul></li><li><p>使用参考:
<a href=https://cn.vuejs.org/guide/built-ins/transition.html#custom-transition-classes target=_blank>自定义过渡 class</a></p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>transition</span> <span class=na>enter</span><span class=nt>-active-class</span><span class=err>=&#34;</span><span class=na>animate__animated</span> <span class=na>animate__backInDown</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=na>leave</span><span class=nt>-active-class</span><span class=err>=&#34;</span><span class=na>animate__animated</span> <span class=na>animate__bounceOutDown</span><span class=err>&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>h2</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;title&#34;</span> <span class=nt>v-if</span><span class=o>=</span><span class=s>&#34;isShow&#34;</span><span class=p>&gt;</span><span class=na>Hello</span> <span class=na>World</span><span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>transition</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=gsap>gsap<a hidden class=anchor aria-hidden=true href=#gsap>#</a></h4><blockquote><p><a href=https://gsap.com/docs/v3/Installation/ target=_blank>https://gsap.com/docs/v3/Installation/</a></p><p><a href=https://gsap.framer.wiki/stated target=_blank>https://gsap.framer.wiki/stated</a> &ndash; 中文文档</p></blockquote><ul><li>某些情况下我们希望通过JavaScript来实现一些动画的效果，这个时候我们可以选择使用gsap库来完成。</li><li>什么是<code>gsap</code>呢？<ul><li><code>GSAP</code>是<code>The GreenSock Animation</code></li><li><code>latform</code>（<code>GreenSock</code>动画平台）的缩写；</li></ul></li><li>它可以通过JavaScript为CSS属性、SVG、Canvas等设置动画，并且是浏览器兼容的；</li></ul><p><strong>如何使用</strong></p><ul><li>安装</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>npm install gsap
</span></span></code></pre></div><ul><li>调用 api</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;app&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;isShow = !isShow&#34;</span><span class=p>&gt;</span><span class=na>显示</span><span class=err>/</span><span class=na>隐藏</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>transition</span> <span class=nt>@enter</span><span class=s>=&#34;enter&#34;</span><span class=p>
</span></span></span><span class=line><span class=cl><span class=p></span>                <span class=nt>@leave</span><span class=s>=&#34;leave&#34;</span><span class=p>
</span></span></span><span class=line><span class=cl><span class=p></span>                <span class=nt>:css</span><span class=o>=</span><span class=s>&#34;false&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>h2</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;title&#34;</span> <span class=nt>v-if</span><span class=o>=</span><span class=s>&#34;isShow&#34;</span><span class=p>&gt;</span><span class=na>Hello</span> <span class=na>World</span><span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>transition</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=kr>import</span> <span class=nx>gsap</span> <span class=nx>from</span> <span class=s1>&#39;gsap&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>isShow</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>enter</span><span class=p>(</span><span class=nx>el</span><span class=p>,</span> <span class=nx>done</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;enter&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>gsap</span><span class=p>.</span><span class=nx>from</span><span class=p>(</span><span class=nx>el</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>scale</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>x</span><span class=o>:</span> <span class=mi>200</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>onComplete</span><span class=o>:</span> <span class=nx>done</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>leave</span><span class=p>(</span><span class=nx>el</span><span class=p>,</span> <span class=nx>done</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;leave&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>gsap</span><span class=p>.</span><span class=nx>to</span><span class=p>(</span><span class=nx>el</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>scale</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>x</span><span class=o>:</span> <span class=mi>200</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>onComplete</span><span class=o>:</span> <span class=nx>done</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>style</span> <span class=na>scoped</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>title</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>display</span><span class=o>:</span> <span class=nx>inline</span><span class=o>-</span><span class=nx>block</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span></code></pre></div><ul><li><code>enter</code>函数接收两个参数：<code>el</code>和<code>done</code>。<code>el</code>是正在进入的元素，<code>done</code>是一个在进入过渡完成时应该被调用的函数。</li><li><code>onComplete: done</code>部分在动画完成时调用<code>done</code>函数。这是必要的，以便让Vue知道过渡已经完成。如果不调用<code>done</code>，Vue可能无法正确地确定过渡的结束，这可能会导致意外的行为。</li><li>在使用仅由 JavaScript 执行的动画时，最好是添加一个 <code>:css="false"</code> prop。这显式地向 Vue 表明可以跳过对 CSS 过渡的自动探测。除了性能稍好一些之外，还可以防止 CSS 规则意外地干扰过渡效果。</li></ul><h4 id=gsap-数字递增效果>gsap 数字递增效果<a hidden class=anchor aria-hidden=true href=#gsap-数字递增效果>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;app&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;number&#34;</span> <span class=na>step</span><span class=o>=</span><span class=s>&#34;100&#34;</span> <span class=nt>v-model</span><span class=o>=</span><span class=s>&#34;counter&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h2</span><span class=p>&gt;</span><span class=nx>当前计数</span><span class=o>:</span> <span class=p>{{</span><span class=nx>showNumber</span><span class=p>.</span><span class=nx>toFixed</span><span class=p>(</span><span class=mi>0</span><span class=p>)}}&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>gsap</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;gsap&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>counter</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>showNumber</span><span class=o>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>watch</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>counter</span><span class=p>(</span><span class=nx>newValue</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>gsap</span><span class=p>.</span><span class=nx>to</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=p>{</span> <span class=nx>duration</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>showNumber</span><span class=o>:</span> <span class=nx>newValue</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=认识列表的过渡>认识列表的过渡<a hidden class=anchor aria-hidden=true href=#认识列表的过渡>#</a></h3><ul><li>目前为止，过渡动画我们只要是针对单个元素或者组件的：<ul><li>要么是单个节点；</li><li>要么是同一时间渲染多个节点中的一个；</li></ul></li><li>那么如果希望渲染的是一个列表，并且该列表中添加删除数据也希望有动画执行呢？<ul><li>这个时候我们要使用 组件来完成；</li></ul></li><li>使用 有如下的特点：<ul><li>默认情况下，它不会渲染一个元素的包裹器，但是你可以指定一个元素并以 tag attribute 进行渲染；</li><li>过渡模式不可用，因为我们不再相互切换特有的元素；</li><li>内部元素总是需要提供唯一的 key attribute 值；</li><li>CSS 过渡的类将会应用在内部的元素中，而不是这个组/容器本身；</li></ul></li></ul><h4 id=基本使用>基本使用<a hidden class=anchor aria-hidden=true href=#基本使用>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;addNum&#34;</span><span class=p>&gt;</span><span class=na>添加数字</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;removeNum&#34;</span><span class=p>&gt;</span><span class=na>删除数字</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>button</span> <span class=nt>@click</span><span class=s>=&#34;shuffleNum&#34;</span><span class=p>&gt;</span><span class=na>数字洗牌</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>transition-group</span> <span class=na>tag</span><span class=o>=</span><span class=s>&#34;p&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;why&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>span</span> <span class=nt>v-for</span><span class=o>=</span><span class=s>&#34;item in numbers&#34; :key=&#34;item&#34; class=&#34;item&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>{{</span><span class=na>item</span><span class=p>}}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=err>&lt;/</span><span class=na>transition</span><span class=nt>-group</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=kr>import</span> <span class=nx>_</span> <span class=nx>from</span> <span class=s1>&#39;lodash&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>numbers</span><span class=o>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=nx>numCounter</span><span class=o>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>addNum</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// this.numbers.push(this.numCounter++)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>numbers</span><span class=p>.</span><span class=nx>splice</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>randomIndex</span><span class=p>(),</span> <span class=mi>0</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>numCounter</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>removeNum</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>numbers</span><span class=p>.</span><span class=nx>splice</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>randomIndex</span><span class=p>(),</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>shuffleNum</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>numbers</span> <span class=o>=</span> <span class=nx>_</span><span class=p>.</span><span class=nx>shuffle</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>numbers</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>randomIndex</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>*</span> <span class=k>this</span><span class=p>.</span><span class=nx>numbers</span><span class=p>.</span><span class=nx>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>style</span> <span class=na>scoped</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>item</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>margin</span><span class=o>-</span><span class=nx>right</span><span class=o>:</span> <span class=mi>10</span><span class=nx>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>display</span><span class=o>:</span> <span class=nx>inline</span><span class=o>-</span><span class=nx>block</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* 设置了元素为内联块级元素。 */</span> 
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>why</span><span class=o>-</span><span class=nx>enter</span><span class=o>-</span><span class=nx>from</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>why</span><span class=o>-</span><span class=nx>leave</span><span class=o>-</span><span class=nx>to</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>opacity</span><span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>transform</span><span class=o>:</span> <span class=nx>translateY</span><span class=p>(</span><span class=mi>30</span><span class=nx>px</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>why</span><span class=o>-</span><span class=nx>enter</span><span class=o>-</span><span class=nx>active</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>why</span><span class=o>-</span><span class=nx>leave</span><span class=o>-</span><span class=nx>active</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>transition</span><span class=o>:</span> <span class=nx>all</span> <span class=mi>1</span><span class=nx>s</span> <span class=nx>ease</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>why</span><span class=o>-</span><span class=nx>leave</span><span class=o>-</span><span class=nx>active</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>position</span><span class=o>:</span> <span class=nx>absolute</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>why</span><span class=o>-</span><span class=nx>move</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>transition</span><span class=o>:</span> <span class=nx>transform</span> <span class=mi>1</span><span class=nx>s</span> <span class=nx>ease</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span></code></pre></div><p><code>methods</code>对象定义了四个方法：</p><ul><li><code>addNum</code>方法在<code>numbers</code>数组的随机位置插入一个新的数字，然后<code>numCounter</code>加1。</li><li><code>removeNum</code>方法从<code>numbers</code>数组的随机位置删除一个数字。</li><li><code>shuffleNum</code>方法使用lodash的<code>shuffle</code>函数打乱<code>numbers</code>数组的顺序。</li><li><code>randomIndex</code>方法返回一个<code>numbers</code>数组的随机索引</li></ul><h4 id=列表过渡的移动动画>列表过渡的移动动画<a hidden class=anchor aria-hidden=true href=#列表过渡的移动动画>#</a></h4><p>在上面的案例中虽然新增的或者删除的节点是有动画的，但是对于哪些其他需要移动的节点是没有动画的：</p><ul><li>我们可以通过使用一个新增的 v-move 的class来完成动画；</li><li>它会在元素改变位置的过程中应用；</li><li>像之前的名字一样，我们可以通过name来自定义前缀;</li></ul><blockquote><p><code>&lt;TransitionGroup></code> 支持通过 CSS transform 控制移动效果。当一个子节点在屏幕上的位置在更新之后发生变化时，它会被添加一个使其位移的 CSS class (基于 <code>name</code> attribute 推导，或使用 <code>move-class</code> prop 显式配置)。如果使其位移的 class 被添加时 CSS 的 <code>transform</code> 属性是“可过渡的”，那么该元素会基于
<a href=https://aerotwist.com/blog/flip-your-animations/ target=_blank>FLIP 技巧</a>平滑地到达动画终点。</p><p><a href=https://cn.vuejs.org/api/built-in-components.html#transitiongroup target=_blank>https://cn.vuejs.org/api/built-in-components.html#transitiongroup</a></p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=p>.</span><span class=nc>why-move</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>transition</span><span class=p>:</span> <span class=k>transform</span> <span class=mi>1</span><span class=kt>s</span> <span class=kc>ease</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=演练--列表的交替动画>演练 => 列表的交替动画<a hidden class=anchor aria-hidden=true href=#演练--列表的交替动画>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>input</span> <span class=nt>v-model</span><span class=o>=</span><span class=s>&#34;keyword&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>transition-group</span> <span class=na>tag</span><span class=o>=</span><span class=s>&#34;ul&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;why&#34;</span> <span class=nt>:css</span><span class=o>=</span><span class=s>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>                      <span class=err>@</span><span class=na>before</span><span class=nt>-enter</span><span class=err>=&#34;</span><span class=na>beforeEnter</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>                      <span class=nt>@enter</span><span class=s>=&#34;enter&#34;</span><span class=p>
</span></span></span><span class=line><span class=cl><span class=p></span>                      <span class=nt>@leave</span><span class=s>=&#34;leave&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>li</span> <span class=nt>v-for</span><span class=o>=</span><span class=s>&#34;(item, index) in showNames&#34; :key=&#34;item&#34; :data-index=&#34;index&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>{{</span><span class=na>item</span><span class=p>}}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=err>&lt;/</span><span class=na>transition</span><span class=nt>-group</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=kr>import</span> <span class=nx>gsap</span> <span class=nx>from</span> <span class=s1>&#39;gsap&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>names</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;abc&#34;</span><span class=p>,</span> <span class=s2>&#34;cba&#34;</span><span class=p>,</span> <span class=s2>&#34;nba&#34;</span><span class=p>,</span> <span class=s2>&#34;why&#34;</span><span class=p>,</span> <span class=s2>&#34;lilei&#34;</span><span class=p>,</span> <span class=s2>&#34;hmm&#34;</span><span class=p>,</span> <span class=s2>&#34;kobe&#34;</span><span class=p>,</span> <span class=s2>&#34;james&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=nx>keyword</span><span class=o>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>computed</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>showNames</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>names</span><span class=p>.</span><span class=nx>filter</span><span class=p>(</span><span class=nx>item</span> <span class=p>=&gt;</span> <span class=nx>item</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>keyword</span><span class=p>)</span> <span class=o>!==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>methods</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>beforeEnter</span><span class=p>(</span><span class=nx>el</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>el</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>opacity</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>el</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>height</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>enter</span><span class=p>(</span><span class=nx>el</span><span class=p>,</span> <span class=nx>done</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>gsap</span><span class=p>.</span><span class=nx>to</span><span class=p>(</span><span class=nx>el</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>opacity</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>height</span><span class=o>:</span> <span class=s2>&#34;1.5em&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>delay</span><span class=o>:</span> <span class=nx>el</span><span class=p>.</span><span class=nx>dataset</span><span class=p>.</span><span class=nx>index</span> <span class=o>*</span> <span class=mf>0.5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>onComplete</span><span class=o>:</span> <span class=nx>done</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>leave</span><span class=p>(</span><span class=nx>el</span><span class=p>,</span> <span class=nx>done</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>gsap</span><span class=p>.</span><span class=nx>to</span><span class=p>(</span><span class=nx>el</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>opacity</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>height</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>delay</span><span class=o>:</span> <span class=nx>el</span><span class=p>.</span><span class=nx>dataset</span><span class=p>.</span><span class=nx>index</span> <span class=o>*</span> <span class=mf>0.5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>onComplete</span><span class=o>:</span> <span class=nx>done</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>style</span> <span class=na>scoped</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=cm>/* .why-enter-from,
</span></span></span><span class=line><span class=cl><span class=cm>  .why-leave-to {
</span></span></span><span class=line><span class=cl><span class=cm>    opacity: 0;
</span></span></span><span class=line><span class=cl><span class=cm>  }
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>  .why-enter-active,
</span></span></span><span class=line><span class=cl><span class=cm>  .why-leave-active {
</span></span></span><span class=line><span class=cl><span class=cm>    transition: opacity 1s ease;
</span></span></span><span class=line><span class=cl><span class=cm>  } */</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span></code></pre></div><h2 id=路由使用>路由使用<a hidden class=anchor aria-hidden=true href=#路由使用>#</a></h2><h3 id=关于路由>关于路由<a hidden class=anchor aria-hidden=true href=#关于路由>#</a></h3><h4 id=认识前端路由>认识前端路由<a hidden class=anchor aria-hidden=true href=#认识前端路由>#</a></h4><ul><li>路由其实是网络工程中的一个术语：<ul><li>在架构一个网络时，非常重要的两个设备就是路由器和交换机。</li><li>当然，目前在我们生活中路由器也是越来越被大家所熟知，因为我们生活中都会用到路由器：</li><li>路由器的主要功能是维护一个映射表，这个映射表决定了数据的流向。在网络中，路由器通过这个映射表来确定数据包的传输路径，使得数据能够按照设定的规则正确地传输到目的地。</li></ul></li><li>路由的概念在软件工程中出现，最早是在后端路由中实现的，原因是web的发展主要经历了这样一些阶段：<ul><li>后端路由阶段；</li><li>前后端分离阶段；</li><li>单页面富应用（SPA）；</li></ul></li></ul><h4 id=后端路由阶段>后端路由阶段<a hidden class=anchor aria-hidden=true href=#后端路由阶段>#</a></h4><ul><li>早期的网站开发整个HTML页面是由服务器来渲染的.<ul><li>服务器直接生产渲染好对应的HTML页面, 返回给客户端进行展示.</li></ul></li><li>一个页面有自己对应的网址, 也就是URL；</li><li>URL会发送到服务器, 服务器会通过正则对该URL进行匹配, 并且最后交给一个Controller(控制器)进行处理；</li><li>Controller进行各种处理, 最终生成HTML或者数据, 返回给前端.</li><li>上面的这种操作, 就是后端路由：<ul><li>当我们页面中需要请求不同的路径内容时, 交给服务器来进行处理, 服务器渲染好整个页面, 并且将页面返回给客户端.</li><li>这种情况下渲染好的页面, 不需要单独加载任何的<code>js</code>和<code>css</code>, 可以直接交给浏览器展示, 这样也有利于SEO的优化.</li></ul></li><li>后端路由的缺点:<ul><li>一种情况是整个页面的模块由后端人员来编写和维护的；</li><li>另一种情况是前端开发人员如果要开发页面, 需要通过PHP和Java等语言来编写页面代码；</li><li>而且通常情况下HTML代码和数据以及对应的逻辑会混在一起, 编写和维护都是非常糟糕的事情；</li></ul></li></ul><h4 id=前后端分离阶段>前后端分离阶段<a hidden class=anchor aria-hidden=true href=#前后端分离阶段>#</a></h4><ul><li>前端渲染的理解：<ul><li>每次请求涉及到的静态资源都会从静态资源服务器获取，这些资源包括HTML+CSS+JS，然后在前端对这些请求回来的资源进行渲染；</li><li>需要注意的是，客户端的每一次请求，都会从静态资源服务器请求文件；</li><li>同时可以看到，和之前的后端路由不同，这时后端只是负责提供API了；</li></ul></li><li>前后端分离阶段：<ul><li>随着Ajax的出现, 有了前后端分离的开发模式；</li><li>后端只提供API来返回数据，前端通过Ajax获取数据，并且可以通过JavaScript将数据渲染到页面中；</li><li>这样做最大的优点就是前后端责任的清晰，后端专注于数据上，前端专注于交互和可视化上；</li><li>并且当移动端(iOS/Android)出现后，后端不需要进行任何处理，依然使用之前的一套API即可；</li><li>目前比较少的网站采用这种模式开发（jQuery开发模式）；</li></ul></li></ul><h4 id=单页面富应用spa>单页面富应用（SPA）<a hidden class=anchor aria-hidden=true href=#单页面富应用spa>#</a></h4><p>随着前端框架（如AngularJS、React、Vue等）的兴起，单页面富应用成为主流。单页面富应用（SPA）是一种Web应用程序的架构模式，它通过动态加载页面内容，实现在单个HTML页面上切换视图和更新内容，而无需每次都从服务器请求新的页面。这种方式提高了用户体验和应用性能，因为页面只在初始化时加载一次，之后的页面切换和内容更新都是通过异步加载数据和更新页面内容来实现的。常见的前端框架如AngularJS、React和Vue等都支持SPA的开发模式。</p><h3 id=vue-router-简介>Vue-router 简介<a hidden class=anchor aria-hidden=true href=#vue-router-简介>#</a></h3><blockquote><p>官网:
<a href=https://router.vuejs.org/zh/ target=_blank>https://router.vuejs.org/zh/</a></p></blockquote><p>Vue Router 是
<a href=https://vuejs.org/ target=_blank>Vue.js</a> 的官方路由。它与 Vue.js 核心深度集成，让用 Vue.js 构建单页应用变得轻而易举。功能包括：</p><ul><li>嵌套路由映射</li><li>动态路由选择</li><li>模块化、基于组件的路由配置</li><li>路由参数、查询、通配符</li><li>展示由 Vue.js 的过渡系统提供的过渡效果</li><li>细致的导航控制</li><li>自动激活 CSS 类的链接</li><li>HTML5 history 模式或 hash 模式</li><li>可定制的滚动行为</li><li>URL 的正确编码</li></ul><p><strong>具体使用示例：</strong></p><p>网易云音乐
<a href=https://music.163.com/ target=_blank>https://music.163.com/</a></p><p>单页面应用(SPA): 所有功能在一个 html 页面上实现</p><p>前端路由作用: 实现业务场景切换</p><ul><li>优点：<ul><li>简单易用</li><li>支持嵌套路由</li><li>支持路由参数、查询、动态路由等</li></ul></li><li>缺点：<ul><li>对于大型单页应用可能不够灵活</li><li>在处理复杂路由时可能需要额外的插件或工具</li></ul></li></ul><h3 id=路由初体验>路由初体验<a hidden class=anchor aria-hidden=true href=#路由初体验>#</a></h3><p>Vue Router 支持两种路由模式：</p><ul><li>Hash 模式：<ul><li>使用 URL 中的 <code>##</code>来管理路由，适用于不需要服务端支持的单页应用。<code>createWebHashHistory</code>是 Vue Router 提供的一种路由模式，它基于 URL 中的 hash（#）来管理路由。这种模式在不需要服务器端支持的情况下可以工作</li></ul></li><li>History 模式：<ul><li>使用 HTML5 History API 来管理路由，可以去掉 URL 中的 <code>#</code>，需要服务器端支持来处理路由<code>createWebHistory</code> 是 Vue Router 提供的基于 HTML5 History API 的路由模式。这种模式需要服务器端支持来处理路由，但可以去掉 URL 中的 #，看起来更加干净。</li></ul></li></ul><p>用 Vue + Vue Router 创建单页应用非常简单：通过 Vue.js，我们已经用组件组成了我们的应用。当加入 Vue Router 时，我们需要做的就是将我们的组件映射到路由上，让 Vue Router 知道在哪里渲染它们。下面是一个基本的例子：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://unpkg.com/vue@3&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://unpkg.com/vue-router@4&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;app&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span><span class=nx>Hello</span> <span class=nx>App</span><span class=o>!</span><span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--</span><span class=nx>使用</span> <span class=nx>router</span><span class=o>-</span><span class=nx>link</span> <span class=nx>组件进行导航</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--</span><span class=nx>通过传递</span> <span class=sb>`to`</span> <span class=nx>来指定链接</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--</span><span class=sb>`&lt;router-link&gt;`</span> <span class=nx>将呈现一个带有正确</span> <span class=sb>`href`</span> <span class=nx>属性的</span> <span class=sb>`&lt;a&gt;`</span> <span class=nx>标签</span><span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>router-link</span> <span class=na>to</span><span class=o>=</span><span class=s>&#34;/&#34;</span><span class=p>&gt;</span><span class=nx>Go</span> <span class=nx>to</span> <span class=nx>Home</span><span class=p>&lt;/</span><span class=nt>router-link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>router-link</span> <span class=na>to</span><span class=o>=</span><span class=s>&#34;/about&#34;</span><span class=p>&gt;</span><span class=nx>Go</span> <span class=nx>to</span> <span class=nx>About</span><span class=p>&lt;/</span><span class=nt>router-link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=c>&lt;!--</span> <span class=nx>路由出口</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>  <span class=c>&lt;!--</span> <span class=nx>路由匹配到的组件将渲染在这里</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>router-view</span><span class=p>&gt;&lt;/</span><span class=nt>router-view</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 定义 (路由) 组件。
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 可以从其他文件 import 进来
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>Home</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>template</span><span class=o>:</span> <span class=s1>&#39;&lt;div&gt;Home&lt;/div&gt;&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>About</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>template</span><span class=o>:</span> <span class=s1>&#39;&lt;div&gt;About&lt;/div&gt;&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 定义路由
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 每个路由应该映射一个组件。 其中&#34;component&#34; 可以是
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 通过 Vue.extend() 创建的组件构造器，
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 或者，只是一个组件配置对象。
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>Home</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/about&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>About</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 创建 router 实例
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 你可以在这里传入配置参数
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 我们在这里使用 `routes` 配置参数
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>VueRouter</span><span class=p>.</span><span class=nx>createRouter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>history</span><span class=o>:</span> <span class=nx>VueRouter</span><span class=p>.</span><span class=nx>createWebHashHistory</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=nx>routes</span> <span class=c1>// `routes: routes` 的缩写
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 创建和挂载根实例
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 记得要通过 router 配置参数注入路由，
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 从而让整个应用都有路由功能
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>Vue</span><span class=p>.</span><span class=nx>createApp</span><span class=p>({})</span>
</span></span><span class=line><span class=cl>  <span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>router</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>app</span><span class=p>.</span><span class=nx>mount</span><span class=p>(</span><span class=s1>&#39;#app&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h4 id=router-link>router-link<a hidden class=anchor aria-hidden=true href=#router-link>#</a></h4><p>请注意，我们没有使用常规的 <code>a</code> 标签，而是使用一个自定义组件 <code>router-link</code> 来创建链接。这使得 Vue Router 可以在不重新加载页面的情况下更改 URL，处理 URL 的生成以及编码。我们将在后面看到如何从这些功能中获益。</p><h4 id=router-view>router-view<a hidden class=anchor aria-hidden=true href=#router-view>#</a></h4><p><code>router-view</code> 将显示与 URL 对应的组件。你可以把它放在任何地方，以适应你的布局。</p><h3 id=安装以及使用>安装以及使用<a hidden class=anchor aria-hidden=true href=#安装以及使用>#</a></h3><ul><li><p>安装</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npm install vue-router
</span></span></code></pre></div></li><li><p>创建 <code>router/index.js</code> 并在其中编辑基本配置(默认你已经注册了 <code>components</code> 中的两个文件)</p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>createRouter</span><span class=p>,</span> <span class=nx>createWebHistory</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue-router&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;../components/login.vue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/req&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;../components/req.vue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>history</span><span class=o>:</span> <span class=nx>createWebHistory</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>  <span class=nx>routes</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>router</span>
</span></span></code></pre></div><ul><li>在 <code>src/App.vue</code> 中引入</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=nx>router</span> <span class=nx>from</span> <span class=s1>&#39;../router&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>createApp</span><span class=p>(</span><span class=nx>App</span><span class=p>).</span><span class=nx>use</span><span class=p>(</span><span class=nx>router</span><span class=p>).</span><span class=nx>mount</span><span class=p>(</span><span class=s1>&#39;#app&#39;</span><span class=p>)</span>
</span></span></code></pre></div><ul><li>当然, 我们需要一个 <code>router-view</code> 显示与 URL 对应的组件, 一般会在 <code>src/App.vue</code> 中做如下配置, 当然你可以把它放在任何地方，以适应你的布局。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>router-view</span><span class=p>&gt;&lt;/</span><span class=nt>router-view</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></div><ul><li>我们也可以在其中使用 <code>router-link</code></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span><span class=nx>小满最骚</span><span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--</span><span class=nx>使用</span> <span class=nx>router</span><span class=o>-</span><span class=nx>link</span> <span class=nx>组件进行导航</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--</span><span class=nx>通过传递</span> <span class=sb>`to`</span> <span class=nx>来指定链接</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--</span><span class=sb>`&lt;router-link&gt;`</span> <span class=nx>将呈现一个带有正确</span> <span class=sb>`href`</span> <span class=nx>属性的</span> <span class=sb>`&lt;a&gt;`</span> <span class=nx>标签</span><span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>router-link</span> <span class=na>tag</span><span class=o>=</span><span class=s>&#34;div&#34;</span> <span class=na>to</span><span class=o>=</span><span class=s>&#34;/&#34;</span><span class=p>&gt;</span><span class=nx>跳转a</span><span class=p>&lt;/</span><span class=nt>router-link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>router-link</span> <span class=na>tag</span><span class=o>=</span><span class=s>&#34;div&#34;</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;margin-left:200px&#34;</span> <span class=na>to</span><span class=o>=</span><span class=s>&#34;/register&#34;</span><span class=p>&gt;</span><span class=nx>跳转b</span><span class=p>&lt;/</span><span class=nt>router-link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>hr</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--</span> <span class=nx>路由出口</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--</span> <span class=nx>路由匹配到的组件将渲染在这里</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>router-view</span><span class=p>&gt;&lt;/</span><span class=nt>router-view</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=带参数的动态路由匹配>带参数的动态路由匹配<a hidden class=anchor aria-hidden=true href=#带参数的动态路由匹配>#</a></h3><p>很多时候，我们需要将给定匹配模式的路由映射到同一个组件。例如，我们可能有一个 <code>User</code> 组件，它应该对所有用户进行渲染，但用户 ID 不同。在 Vue Router 中，我们可以在路径中使用一个动态字段来实现，我们称之为 <em>路径参数</em> ：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>User</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>template</span><span class=o>:</span> <span class=s1>&#39;&lt;div&gt;User&lt;/div&gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 这些都会传递给 `createRouter`
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 动态字段以冒号开始
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>{</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/users/:id&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>User</span> <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><p>现在像 <code>/users/johnny</code> 和 <code>/users/jolyne</code> 这样的 URL 都会映射到同一个路由。</p><p><em>路径参数</em> 用冒号 <code>:</code> 表示。当一个路由被匹配时，它的 <em>params</em> 的值将在每个组件中以 <code>this.$route.params</code> 的形式暴露出来。因此，我们可以通过更新 <code>User</code> 的模板来呈现当前的用户 ID：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>User</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>template</span><span class=o>:</span> <span class=s1>&#39;&lt;div&gt;User {{ $route.params.id }}&lt;/div&gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>你可以在同一个路由中设置有多个 <em>路径参数</em>，它们会映射到 <code>$route.params</code> 上的相应字段。例如：</p><table><thead><tr><th style=text-align:left>匹配模式</th><th style=text-align:left>匹配路径</th><th style=text-align:left>$route.params</th></tr></thead><tbody><tr><td style=text-align:left>/users/:username</td><td style=text-align:left>/users/eduardo</td><td style=text-align:left><code>{ username: 'eduardo' }</code></td></tr><tr><td style=text-align:left>/users/:username/posts/:postId</td><td style=text-align:left>/users/eduardo/posts/123</td><td style=text-align:left><code>{ username: 'eduardo', postId: '123' }</code></td></tr></tbody></table><p>除了 <code>$route.params</code> 之外，<code>$route</code> 对象还公开了其他有用的信息，如 <code>$route.query</code>（如果 URL 中存在参数）、<code>$route.hash</code> 等。你可以在
<a href=https://router.vuejs.org/zh/api/#routelocationnormalized target=_blank>API 参考</a>中查看完整的细节。</p><blockquote><p>以下是一个小 Demo</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// router.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>createRouter</span><span class=p>,</span> <span class=nx>createWebHistory</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue-router&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>UserPost</span> <span class=nx>from</span> <span class=s1>&#39;./views/UserPost.vue&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>history</span><span class=o>:</span> <span class=nx>createWebHistory</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>  <span class=nx>routes</span><span class=o>:</span> <span class=p>[{</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/users/:username/posts/:postId&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>UserPost</span> <span class=p>}],</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=c>&lt;!--</span> <span class=nx>App</span><span class=p>.</span><span class=nx>vue</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>router-link</span> <span class=na>to</span><span class=o>=</span><span class=s>&#34;/users/eduardo/posts/1&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>&gt;</span><span class=o>/</span><span class=nx>users</span><span class=o>/</span><span class=nx>eduardo</span><span class=o>/</span><span class=nx>posts</span><span class=o>/</span><span class=mi>1</span><span class=o>&lt;</span><span class=err>/router-link</span>
</span></span><span class=line><span class=cl>      <span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>router-link</span> <span class=na>to</span><span class=o>=</span><span class=s>&#34;/users/eduardo/posts/20&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>&gt;</span><span class=o>/</span><span class=nx>users</span><span class=o>/</span><span class=nx>eduardo</span><span class=o>/</span><span class=nx>posts</span><span class=o>/</span><span class=mi>20</span><span class=o>&lt;</span><span class=err>/router-link</span>
</span></span><span class=line><span class=cl>      <span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>router-view</span><span class=p>&gt;&lt;/</span><span class=nt>router-view</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;App&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=c>&lt;!--</span> <span class=p>.</span><span class=o>/</span><span class=nx>views</span><span class=o>/</span><span class=nx>UserPost</span><span class=p>.</span><span class=nx>vue</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nx>User</span> <span class=p>{{</span> <span class=nx>$route</span><span class=p>.</span><span class=nx>params</span><span class=p>.</span><span class=nx>username</span> <span class=p>}}</span> <span class=kd>with</span> <span class=nx>post</span> <span class=p>{{</span> <span class=nx>$route</span><span class=p>.</span><span class=nx>params</span><span class=p>.</span><span class=nx>postId</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></div><p><img alt=image-20231223000208274 loading=lazy src=https://qiniu.waite.wang/202312230002394.png></p><h3 id=声明式-编程式导航>声明式/ 编程式导航<a hidden class=anchor aria-hidden=true href=#声明式-编程式导航>#</a></h3><h4 id=声明式导航>声明式导航<a hidden class=anchor aria-hidden=true href=#声明式导航>#</a></h4><h5 id=基础使用-命名路由>基础使用/ 命名路由<a hidden class=anchor aria-hidden=true href=#基础使用-命名路由>#</a></h5><p>除了 <code>path</code> 之外，你还可以为任何路由提供 <code>name</code>。这有以下优点：</p><ul><li><p><a href=https://router.vuejs.org/zh/guide/essentials/named-routes.html target=_blank>https://router.vuejs.org/zh/guide/essentials/named-routes.html</a></p></li><li><p>没有硬编码的 URL</p></li><li><p><code>params</code> 的自动编码/解码。</p></li><li><p>防止你在 <code>url</code>中出现打字错误。</p></li><li><p>绕过路径排序（如显示一个）</p></li><li><p>这跟代码调用 <code>router.push()</code> 是一回事：</p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span><span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;user&#39;</span><span class=p>,</span> <span class=nx>params</span><span class=o>:</span> <span class=p>{</span><span class=nx>username</span><span class=o>:</span> <span class=s1>&#39;erina&#39;</span><span class=p>}})</span>
</span></span><span class=line><span class=cl><span class=c1>// 在这两种情况下，路由将导航到路径 /user/erina。
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span>:<span class=kt>Array</span><span class=p>&lt;</span><span class=nt>RouteRecordRaw</span><span class=p>&gt;</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>path</span><span class=o>:</span><span class=s2>&#34;/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>name</span><span class=o>:</span><span class=s2>&#34;Login&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>component</span><span class=o>:</span><span class=p>()</span><span class=o>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;../components/login.vue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>path</span><span class=o>:</span><span class=s2>&#34;/reg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>name</span><span class=o>:</span><span class=s2>&#34;Reg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>component</span><span class=o>:</span><span class=p>()</span><span class=o>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;../components/reg.vue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><blockquote><p>跳转方式需要改变 变为对象并且有对应name</p><p>两种跳转方式有区别, a 标签有新的网络请求, 会刷新整个页面</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>router-link</span> <span class=o>:</span><span class=na>to</span><span class=o>=</span><span class=s>&#34;{name: &#39;Login&#39;}&#34;</span><span class=p>&gt;</span><span class=nx>Home</span><span class=p>&lt;/</span><span class=nt>router-link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>router-link</span> <span class=o>:</span><span class=na>to</span><span class=o>=</span><span class=s>&#34;{name: &#39;Req&#39;}&#34;</span><span class=p>&gt;</span><span class=nx>Req</span><span class=p>&lt;/</span><span class=nt>router-link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/&#34;</span><span class=p>&gt;</span><span class=nx>Login</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/req&#34;</span><span class=p>&gt;</span><span class=nx>Req</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;top&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>router-view</span><span class=p>&gt;&lt;/</span><span class=nt>router-view</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></div><h5 id=跳转传参>跳转传参<a hidden class=anchor aria-hidden=true href=#跳转传参>#</a></h5><p>目标: 在跳转路由时, 可以给路由对应的组件内传值</p><p>在 <code>router-link</code> 上的 <code>to</code> 属性传值, 语法格式如下</p><ul><li><code>/path?参数名=值</code></li><li><code>/path/值</code> – 需要路由对象提前配置 <code>path: "/path/参数名"</code></li></ul><p>对应页面组件接收传递过来的值</p><ul><li><code>route.query.参数名</code></li><li><code>route.params.参数名</code></li></ul><p>1、新建 <code>views/Part2.vue</code> - 接收路由上传递的参数和值</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>我的好友</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--</span> <span class=nx>query</span> <span class=nx>查询</span> <span class=err>？</span> <span class=nx>号后面的</span><span class=err>。</span> <span class=nx>params</span> <span class=nx>是获取</span> <span class=nx>url</span> <span class=o>:</span> <span class=nx>中的参数</span><span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>人名</span><span class=p>(</span><span class=nx>path</span> <span class=o>--&gt;</span> <span class=nx>query</span><span class=p>)</span><span class=o>:</span> <span class=p>{{</span> <span class=nx>route</span><span class=p>.</span><span class=nx>query</span><span class=o>?</span><span class=p>.</span><span class=nx>name</span> <span class=p>}}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>人名</span><span class=p>(</span><span class=o>?</span><span class=nx>后参数</span> <span class=o>--&gt;</span> <span class=nx>params</span><span class=p>)</span><span class=o>:</span> <span class=p>{{</span> <span class=nx>route</span><span class=p>.</span><span class=nx>params</span><span class=o>?</span><span class=p>.</span><span class=nx>name</span> <span class=p>}}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>setup</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>// 目标: 声明式导航 - 基础使用
</span></span></span><span class=line><span class=cl><span class=c1>// 本质: vue-router 提供的全局组件 &#34;router-link&#34; 替代a标签
</span></span></span><span class=line><span class=cl><span class=c1>// 1. router-link  替代 a 标签
</span></span></span><span class=line><span class=cl><span class=c1>// 2. to 属性      替代 href 属性
</span></span></span><span class=line><span class=cl><span class=c1>// 好处: router-link 自带高亮的类名(激活时类名)
</span></span></span><span class=line><span class=cl><span class=c1>// 3. 对激活的类名做出样式的编写
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span><span class=nx>useRoute</span><span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue-router&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>route</span> <span class=o>=</span> <span class=nx>useRoute</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>2、修改路由定义</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s1>&#39;path&#39;</span><span class=o>:</span> <span class=s1>&#39;/find&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;../views/Find.vue&#39;</span><span class=p>)},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s1>&#39;path&#39;</span><span class=o>:</span> <span class=s1>&#39;/my&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;../views/My.vue&#39;</span><span class=p>)},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s1>&#39;path&#39;</span><span class=o>:</span> <span class=s1>&#39;/part&#39;</span><span class=p>,</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Part&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;../views/Part.vue&#39;</span><span class=p>)},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;/part/:name&#34;</span><span class=p>,</span> <span class=c1>// 有:的路径代表要接收具体的值
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;../views/Part2.vue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><p>3、修改 <code>App.vue</code> 进行跳转</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;footer_wrap&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=c>&lt;!--</span>      <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;#/find&#34;</span><span class=p>&gt;</span><span class=nx>发现音乐</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span><span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>      <span class=c>&lt;!--</span>      <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;#/my&#34;</span><span class=p>&gt;</span><span class=nx>我的音乐</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span><span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>      <span class=c>&lt;!--</span>      <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;#/part&#34;</span><span class=p>&gt;</span><span class=nx>朋友</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span><span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>router-link</span> <span class=na>to</span><span class=o>=</span><span class=s>&#34;/find&#34;</span><span class=p>&gt;</span><span class=nx>发现音乐</span><span class=p>&lt;/</span><span class=nt>router-link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>router-link</span> <span class=na>to</span><span class=o>=</span><span class=s>&#34;/my&#34;</span><span class=p>&gt;</span><span class=nx>我的音乐</span><span class=p>&lt;/</span><span class=nt>router-link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>router-link</span> <span class=na>to</span><span class=o>=</span><span class=s>&#34;/part&#34;</span><span class=p>&gt;</span><span class=nx>朋友</span><span class=p>&lt;/</span><span class=nt>router-link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>router-link</span> <span class=na>to</span><span class=o>=</span><span class=s>&#34;/part?name=小传&#34;</span><span class=p>&gt;</span><span class=nx>朋友</span><span class=o>-</span><span class=nx>小传</span><span class=p>&lt;/</span><span class=nt>router-link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>router-link</span> <span class=na>to</span><span class=o>=</span><span class=s>&#34;/part/小智?name=小智2&#34;</span><span class=p>&gt;</span><span class=nx>朋友</span><span class=o>-</span><span class=nx>小智</span><span class=p>&lt;/</span><span class=nt>router-link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;top&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>router-view</span><span class=p>&gt;&lt;/</span><span class=nt>router-view</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>总结:</p><ul><li><code>?key=value</code> 用 <code>$route.query.key</code> 取值</li><li><code>/值</code> 提前在路由规则 <code>/path/:key</code> 用 <code>$route.params.key</code> 取值</li><li><code>query</code> 是查询参数, <code>params</code> 是 <code>path</code> 路径</li><li>有:的路径代表要接收具体的值, 不然会报警告</li></ul><p><img alt=image-20231223002327799 loading=lazy src=https://qiniu.waite.wang/202312230023125.png></p><p>在这个特定的场景中，我们在括号之间使用了
<a href=https://router.vuejs.org/zh/guide/essentials/route-matching-syntax.html#%e5%9c%a8%e5%8f%82%e6%95%b0%e4%b8%ad%e8%87%aa%e5%ae%9a%e4%b9%89%e6%ad%a3%e5%88%99 target=_blank>自定义正则表达式</a>，并将<code>pathMatch</code> 参数标记为
<a href=https://router.vuejs.org/zh/guide/essentials/route-matching-syntax.html#%e5%8f%af%e9%80%89%e5%8f%82%e6%95%b0 target=_blank>可选可重复</a>。这样做是为了让我们在需要的时候，可以通过将 <code>path</code> 拆分成一个数组，直接导航到路由</p><h5 id=捕获所有路由或-404-not-found-路由>捕获所有路由或 404 Not found 路由<a hidden class=anchor aria-hidden=true href=#捕获所有路由或-404-not-found-路由>#</a></h5><p>常规参数只匹配 url 片段之间的字符，用 <code>/</code> 分隔。如果我们想匹配<strong>任意路径</strong>，我们可以使用自定义的 <em>路径参数</em> 正则表达式，在 <em>路径参数</em> 后面的括号中加入 正则表达式 :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 将匹配所有内容并将其放在 `$route.params.pathMatch` 下
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>{</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/:pathMatch(.*)*&#39;</span><span class=p>,</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;NotFound&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>NotFound</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 将匹配以 `/user-` 开头的所有内容，并将其放在 `$route.params.afterUser` 下
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>{</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/user-:afterUser(.*)&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>UserGeneric</span> <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><p>在这个特定的场景中，我们在括号之间使用了
<a href=https://router.vuejs.org/zh/guide/essentials/route-matching-syntax.html#%e5%9c%a8%e5%8f%82%e6%95%b0%e4%b8%ad%e8%87%aa%e5%ae%9a%e4%b9%89%e6%ad%a3%e5%88%99 target=_blank>自定义正则表达式</a>，并将<code>pathMatch</code> 参数标记为
<a href=https://router.vuejs.org/zh/guide/essentials/route-matching-syntax.html#%e5%8f%af%e9%80%89%e5%8f%82%e6%95%b0 target=_blank>可选可重复</a>。这样做是为了让我们在需要的时候，可以通过将 <code>path</code> 拆分成一个数组，直接导航到路由：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>$router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;NotFound&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 保留当前路径并删除第一个字符，以避免目标 URL 以 `//` 开头。
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>params</span><span class=o>:</span> <span class=p>{</span> <span class=nx>pathMatch</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>$route</span><span class=p>.</span><span class=nx>path</span><span class=p>.</span><span class=nx>substring</span><span class=p>(</span><span class=mi>1</span><span class=p>).</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 保留现有的查询和 hash 值，如果有的话
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>query</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>$route</span><span class=p>.</span><span class=nx>query</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>hash</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>$route</span><span class=p>.</span><span class=nx>hash</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>更多内容请参见
<a href=https://router.vuejs.org/zh/guide/essentials/route-matching-syntax.html#%e5%8f%af%e9%87%8d%e5%a4%8d%e7%9a%84%e5%8f%82%e6%95%b0 target=_blank>重复参数</a>部分。</p><blockquote><p>一般使用如下</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...省略了其他配置  
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 404在最后(规则是从前往后逐个比较path)  
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;/:pathMatch(.*)*&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;../views/NotFound.vue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><h4 id=编程式导航>编程式导航<a hidden class=anchor aria-hidden=true href=#编程式导航>#</a></h4><p>除了使用 <code>&lt;router-link></code> 创建 <code>a</code> 标签来定义导航链接，我们还可以借助 <code>router</code> 的实例方法，通过编写代码来实现。</p><h5 id=导航到不同的位置>导航到不同的位置<a hidden class=anchor aria-hidden=true href=#导航到不同的位置>#</a></h5><p>注意：在 Vue 实例中，你可以通过 <code>$router</code> 访问路由实例。因此你可以调用 <code>$router.push</code>。</p><p>想要导航到不同的 URL，可以使用 <code>router.push</code> 方法。这个方法会向 history 栈添加一个新的记录，所以，当用户点击浏览器后退按钮时，会回到之前的 URL。</p><p>当你点击 <code>&lt;router-link></code> 时，内部会调用这个方法，所以点击 <code>&lt;router-link :to="..."></code> 相当于调用 <code>router.push(...)</code> ：</p><table><thead><tr><th style=text-align:left>声明式</th><th style=text-align:left>编程式</th></tr></thead><tbody><tr><td style=text-align:left><code>&lt;router-link :to="..."></code></td><td style=text-align:left><code>router.push(...)</code></td></tr></tbody></table><p>该方法的参数可以是一个字符串路径，或者一个描述地址的对象。例如：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 字符串路径
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;/users/eduardo&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 带有路径的对象
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span><span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/users/eduardo&#39;</span><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 命名的路由，并加上参数，让路由建立 url
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span><span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;user&#39;</span><span class=p>,</span> <span class=nx>params</span><span class=o>:</span> <span class=p>{</span><span class=nx>username</span><span class=o>:</span> <span class=s1>&#39;eduardo&#39;</span><span class=p>}});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 带查询参数，结果是 /register?plan=private
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span><span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/register&#39;</span><span class=p>,</span> <span class=nx>query</span><span class=o>:</span> <span class=p>{</span><span class=nx>plan</span><span class=o>:</span> <span class=s1>&#39;private&#39;</span><span class=p>}});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 带 hash，结果是 /about.md#team
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span><span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/about.md&#39;</span><span class=p>,</span> <span class=nx>hash</span><span class=o>:</span> <span class=s1>&#39;#team&#39;</span><span class=p>});</span>
</span></span></code></pre></div><p><strong>注意</strong>：如果提供了 <code>path</code>，<code>params</code> 会被忽略，上述例子中的 <code>query</code> 并不属于这种情况。取而代之的是下面例子的做法，你需要提供路由的 <code>name</code> 或手写完整的带有参数的 <code>path</code> ：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>username</span> <span class=o>=</span> <span class=s1>&#39;eduardo&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>// 我们可以手动建立 url，但我们必须自己处理编码
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=sb>`/user/</span><span class=si>${</span><span class=nx>username</span><span class=si>}</span><span class=sb>`</span><span class=p>)</span> <span class=c1>// -&gt; /user/eduardo
</span></span></span><span class=line><span class=cl><span class=c1>// 同样
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span><span class=nx>path</span><span class=o>:</span> <span class=sb>`/user/</span><span class=si>${</span><span class=nx>username</span><span class=si>}</span><span class=sb>`</span><span class=p>})</span> <span class=c1>// -&gt; /user/eduardo
</span></span></span><span class=line><span class=cl><span class=c1>// 如果可能的话，使用 `name` 和 `params` 从自动 URL 编码中获益
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span><span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;user&#39;</span><span class=p>,</span> <span class=nx>params</span><span class=o>:</span> <span class=p>{</span><span class=nx>username</span><span class=p>}})</span> <span class=c1>// -&gt; /user/eduardo
</span></span></span><span class=line><span class=cl><span class=c1>// `params` 不能与 `path` 一起使用
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span><span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/user&#39;</span><span class=p>,</span> <span class=nx>params</span><span class=o>:</span> <span class=p>{</span><span class=nx>username</span><span class=p>}})</span> <span class=c1>// -&gt; /user
</span></span></span></code></pre></div><p>当指定 <code>params</code> 时，可提供 <code>string</code> 或 <code>number</code> 参数（或者对于
<a href=https://router.vuejs.org/zh/guide/essentials/route-matching-syntax.html#repeatable-params target=_blank>可重复的参数</a> 可提供一个数组）。<strong>任何其他类型（如 <code>undefined</code>、<code>false</code> 等）都将被自动字符串化</strong> 。对于
<a href=https://router.vuejs.org/zh/guide/essentials/route-matching-syntax.html#repeatable-params target=_blank>可选参数</a> ，你可以提供一个空字符串（<code>""</code>）来跳过它。</p><p>由于属性 <code>to</code> 与 <code>router.push</code> 接受的对象种类相同，所以两者的规则完全相同。</p><h5 id=基础使用>基础使用<a hidden class=anchor aria-hidden=true href=#基础使用>#</a></h5><p>语法:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;路由路径&#34;</span><span class=p>,</span> <span class=c1>// 都去 router/index.js 定义
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;路由名&#34;</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><ol><li><code>src/router/index.js</code> - 路由数组里, 给路由起名字</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>createRouter</span><span class=p>,</span> <span class=nx>createWebHistory</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue-router&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;/part/:name&#34;</span><span class=p>,</span> <span class=c1>// 有:的路径代表要接收具体的值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Part2&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;../components/HelloWorld.vue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>history</span><span class=o>:</span> <span class=nx>createWebHistory</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>  <span class=nx>routes</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>router</span>
</span></span></code></pre></div><ol start=2><li>App.vue - 换成 span 配合js的编程式导航跳转</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;footer_wrap&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>a</span> <span class=nt>@click</span><span class=s>=&#34;change_router(&#39;/part&#39;, &#39;Part&#39;)&#34;</span><span class=p>&gt;</span><span class=na>朋友</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>br</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>a</span> <span class=nt>@click</span><span class=s>=&#34;change1&#34;</span><span class=p>&gt;</span><span class=na>朋友</span><span class=nt>-小传</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>br</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>a</span> <span class=nt>@click</span><span class=s>=&#34;change2&#34;</span><span class=p>&gt;</span><span class=na>朋友</span><span class=nt>-小智</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;top&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>router-view</span><span class=p>&gt;&lt;/</span><span class=nt>router-view</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>setup</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span><span class=nx>useRouter</span><span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue-router&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>useRouter</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>change_router</span> <span class=o>=</span> <span class=p>(</span><span class=nx>path</span><span class=p>,</span> <span class=nx>name</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span><span class=nx>name</span><span class=o>:</span> <span class=nx>name</span><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>change1</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Part2&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>params</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;小传&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>change2</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Part2&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>params</span><span class=o>:</span> <span class=p>{</span>  
</span></span><span class=line><span class=cl>        <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;小智&#39;</span>  
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>query</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;小智&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=横跨历史>横跨历史<a hidden class=anchor aria-hidden=true href=#横跨历史>#</a></h3><p>该方法采用一个整数作为参数，表示在历史堆栈中前进或后退多少步，类似于 <code>window.history.go(n)</code>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 向前移动一条记录，与 router.forward() 相同
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>go</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 返回一条记录，与 router.back() 相同
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>go</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 前进 3 条记录
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>go</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 如果没有那么多记录，静默失败
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>go</span><span class=p>(</span><span class=o>-</span><span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>go</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=替换当前位置>替换当前位置<a hidden class=anchor aria-hidden=true href=#替换当前位置>#</a></h3><p>它的作用类似于 <code>router.push</code>，唯一不同的是，它在导航时不会向 history 添加新记录，正如它的名字所暗示的那样——它取代了当前的条目。</p><table><thead><tr><th style=text-align:left>声明式</th><th style=text-align:left>编程式</th></tr></thead><tbody><tr><td style=text-align:left><code>&lt;router-link :to="..." replace></code></td><td style=text-align:left><code>router.replace(...)</code></td></tr></tbody></table><p>也可以直接在传递给 <code>router.push</code> 的 <code>routeLocation</code> 中增加一个属性 <code>replace: true</code> ：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span><span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/home&#39;</span><span class=p>,</span> <span class=nx>replace</span><span class=o>:</span> <span class=kc>true</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=c1>// 相当于
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>replace</span><span class=p>({</span><span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/home&#39;</span><span class=p>})</span>
</span></span></code></pre></div><h3 id=重定向>重定向<a hidden class=anchor aria-hidden=true href=#重定向>#</a></h3><p>重定向也是通过 <code>routes</code> 配置来完成，下面例子是从 <code>/home</code> 重定向到 <code>/</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[{</span><span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/home&#39;</span><span class=p>,</span> <span class=nx>redirect</span><span class=o>:</span> <span class=s1>&#39;/&#39;</span><span class=p>}]</span>
</span></span></code></pre></div><p>重定向的目标也可以是一个命名的路由：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[{</span><span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/home&#39;</span><span class=p>,</span> <span class=nx>redirect</span><span class=o>:</span> <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;homepage&#39;</span><span class=p>}}]</span>
</span></span></code></pre></div><p>甚至是一个方法，动态返回重定向目标：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// /search/screens -&gt; /search?q=screens
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/search/:searchText&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>redirect</span><span class=o>:</span> <span class=nx>to</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 方法接收目标路由作为参数
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>// return 重定向的字符串路径/路径对象
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>return</span> <span class=p>{</span><span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/search&#39;</span><span class=p>,</span> <span class=nx>query</span><span class=o>:</span> <span class=p>{</span><span class=nx>q</span><span class=o>:</span> <span class=nx>to</span><span class=p>.</span><span class=nx>params</span><span class=p>.</span><span class=nx>searchText</span><span class=p>}}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/search&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><p>例如: 网页默认打开, 匹配路由 <code>"/"</code>, 强制切换到 <code>"/find"</code> 上</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span> <span class=c1>// 默认hash值路径  
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>redirect</span><span class=o>:</span> <span class=s2>&#34;/find&#34;</span> <span class=c1>// 重定向到 /find  
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// 浏览器 url 中 ## 后的路径被改变成 /find -重新匹配数组规则
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><p>总结: 强制重定向后, 还会重新来数组里匹配一次规则</p><h3 id=别名>别名<a hidden class=anchor aria-hidden=true href=#别名>#</a></h3><p>有时候，同一个路径可能需要多个路由，此时可以使用 <code>alias</code> 创建别名。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/foo&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>Foo</span><span class=p>,</span> <span class=nx>alias</span><span class=o>:</span> <span class=s1>&#39;/bar&#39;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><blockquote><p>有个通用的场景是，你可能要把 <code>src</code> 目录下的 <code>@</code> 指向 <code>src</code> 目录，这时候就可以使用别名：</p></blockquote><p>在 <code>vue.config.js</code> 中配置别名</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>configureWebpack</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>resolve</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>alias</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;@&#39;</span><span class=o>:</span> <span class=nx>path</span><span class=p>.</span><span class=nx>resolve</span><span class=p>(</span><span class=nx>__dirname</span><span class=p>,</span> <span class=s1>&#39;src&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=路由进阶>路由进阶<a hidden class=anchor aria-hidden=true href=#路由进阶>#</a></h2><h3 id=路由嵌套>路由嵌套<a hidden class=anchor aria-hidden=true href=#路由嵌套>#</a></h3><p>一些应用程序的 UI 由多层嵌套的组件组成。在这种情况下，URL 的片段通常对应于特定的嵌套组件结构，例如：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/user/johnny/profile                     /user/johnny/posts
</span></span><span class=line><span class=cl>+------------------+                  +-----------------+
</span></span><span class=line><span class=cl>| User             |                  | User            |
</span></span><span class=line><span class=cl>| +--------------+ |                  | +-------------+ |
</span></span><span class=line><span class=cl>| | Profile      | |  +------------&gt;  | | Posts       | |
</span></span><span class=line><span class=cl>| |              | |                  | |             | |
</span></span><span class=line><span class=cl>| +--------------+ |                  | +-------------+ |
</span></span><span class=line><span class=cl>+------------------+                  +-----------------+
</span></span></code></pre></div><p>通过 Vue Router，你可以使用嵌套路由配置来表达这种关系。</p><p>接着上节创建的 app ：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;app&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>router-view</span><span class=p>&gt;&lt;/</span><span class=nt>router-view</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>User</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>template</span><span class=o>:</span> <span class=s1>&#39;&lt;div&gt;User {{ $route.params.id }}&lt;/div&gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 这些都会传递给 `createRouter`
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[{</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/user/:id&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>User</span> <span class=p>}]</span>
</span></span></code></pre></div><p>这里的 <code>&lt;router-view></code> 是一个顶层的 <code>router-view</code>。它渲染顶层路由匹配的组件。同样地，一个被渲染的组件也可以包含自己嵌套的 <code>&lt;router-view></code>。例如，如果我们在 <code>User</code> 组件的模板内添加一个 <code>&lt;router-view></code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>User</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>template</span><span class=o>:</span> <span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>    &lt;div class=&#34;user&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;h2&gt;User {{ $route.params.id }}&lt;/h2&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;router-view&gt;&lt;/router-view&gt;
</span></span></span><span class=line><span class=cl><span class=sb>    &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>  `</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>要将组件渲染到这个嵌套的 <code>router-view</code> 中，我们需要在路由中配置 <code>children</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/user/:id&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=nx>User</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>children</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 当 /user/:id/profile 匹配成功
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// UserProfile 将被渲染到 User 的 &lt;router-view&gt; 内部
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;profile&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>component</span><span class=o>:</span> <span class=nx>UserProfile</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 当 /user/:id/posts 匹配成功
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// UserPosts 将被渲染到 User 的 &lt;router-view&gt; 内部
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;posts&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>component</span><span class=o>:</span> <span class=nx>UserPosts</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><p><strong>注意，以 <code>/</code> 开头的嵌套路径将被视为根路径。这允许你利用组件嵌套，而不必使用嵌套的 URL。</strong></p><p>如你所见，<code>children</code> 配置只是另一个路由数组，就像 <code>routes</code> 本身一样。因此，你可以根据自己的需要，不断地嵌套视图。</p><p>此时，按照上面的配置，当你访问 <code>/user/eduardo</code> 时，在 <code>User</code> 的 <code>router-view</code> 里面什么都不会呈现，因为没有匹配到嵌套路由。也许你确实想在那里渲染一些东西。在这种情况下，你可以提供一个空的嵌套路径：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/user/:id&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=nx>User</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>children</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 当 /user/:id 匹配成功
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>// UserHome 将被渲染到 User 的 &lt;router-view&gt; 内部
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=p>{</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>UserHome</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=c1>// ...其他子路由
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><h3 id=导航守卫>导航守卫<a hidden class=anchor aria-hidden=true href=#导航守卫>#</a></h3><blockquote><p><a href=https://router.vuejs.org/zh/guide/advanced/navigation-guards.html target=_blank>https://router.vuejs.org/zh/guide/advanced/navigation-guards.html</a></p></blockquote><p>正如其名，vue-router 提供的导航守卫主要用来通过跳转或取消的方式守卫导航。这里有很多方式植入路由导航中：全局的，单个路由独享的，或者组件级的。</p><h4 id=全局前置守卫>全局前置守卫<a hidden class=anchor aria-hidden=true href=#全局前置守卫>#</a></h4><p>你可以使用 <code>router.beforeEach</code> 注册一个全局前置守卫：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>({</span> <span class=p>...</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>beforeEach</span><span class=p>((</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 返回 false 以取消导航
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>当一个导航触发时，全局前置守卫按照创建顺序调用。守卫是异步解析执行，此时导航在所有守卫 resolve 完之前一直处于<strong>等待中</strong>。</p><p>每个守卫方法接收两个参数：</p><ul><li><strong><code>to</code></strong>: 即将要进入的目标
<a href=https://router.vuejs.org/zh/api/#routelocationnormalized target=_blank>用一种标准化的方式</a></li><li><strong><code>from</code></strong>: 当前导航正要离开的路由
<a href=https://router.vuejs.org/zh/api/#routelocationnormalized target=_blank>用一种标准化的方式</a></li></ul><p>可以返回的值如下:</p><ul><li><code>false</code>: 取消当前的导航。如果浏览器的 URL 改变了(可能是用户手动或者浏览器后退按钮)，那么 URL 地址会重置到 <code>from</code> 路由对应的地址。</li><li>一个
<a href=https://router.vuejs.org/zh/api/#routelocationraw target=_blank>路由地址</a>: 通过一个路由地址重定向到一个不同的地址，如同调用 <code>router.push()</code>，且可以传入诸如 <code>replace: true</code> 或 <code>name: 'home'</code> 之类的选项。它会中断当前的导航，同时用相同的 <code>from</code> 创建一个新导航。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl> <span class=nx>router</span><span class=p>.</span><span class=nx>beforeEach</span><span class=p>(</span><span class=kr>async</span> <span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=k>if</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>     <span class=c1>// 检查用户是否已登录
</span></span></span><span class=line><span class=cl><span class=c1></span>     <span class=o>!</span><span class=nx>isAuthenticated</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>     <span class=c1>// ❗️ 避免无限重定向
</span></span></span><span class=line><span class=cl><span class=c1></span>     <span class=nx>to</span><span class=p>.</span><span class=nx>name</span> <span class=o>!==</span> <span class=s1>&#39;Login&#39;</span>
</span></span><span class=line><span class=cl>   <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=c1>// 将用户重定向到登录页面
</span></span></span><span class=line><span class=cl><span class=c1></span>     <span class=k>return</span> <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Login&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=p>})</span>
</span></span></code></pre></div><p>如果遇到了意料之外的情况，可能会抛出一个 <code>Error</code>。这会取消导航并且调用
<a href=https://router.vuejs.org/zh/api/interfaces/router#onError target=_blank><code>router.onError()</code></a> 注册过的回调。</p><p>如果什么都没有，<code>undefined</code> 或返回 <code>true</code>，<strong>则导航是有效的</strong>，并调用下一个导航守卫</p><p>以上所有都同 <strong><code>async</code> 函数</strong> 和 Promise 工作方式一样：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>beforeEach</span><span class=p>(</span><span class=kr>async</span> <span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// canUserAccess() 返回 `true` 或 `false`
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>canAccess</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>canUserAccess</span><span class=p>(</span><span class=nx>to</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>canAccess</span><span class=p>)</span> <span class=k>return</span> <span class=s1>&#39;/login&#39;</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>在之前的 Vue Router 版本中，还可以使用 <em>第三个参数</em> <code>next</code> 。这是一个常见的错误来源，我们经过
<a href=https://github.com/vuejs/rfcs/blob/master/active-rfcs/0037-router-return-guards.md#motivation target=_blank>RFC</a> 讨论将其移除。然而，它仍然是被支持的，这意味着你可以向任何导航守卫传递第三个参数。在这种情况下，<strong>确保 <code>next</code></strong> 在任何给定的导航守卫中都被<strong>严格调用一次</strong>。它可以出现多于一次，但是只能在所有的逻辑路径都不重叠的情况下，否则钩子永远都不会被解析或报错。这里有一个在用户未能验证身份时重定向到<code>/login</code>的<strong>错误用例</strong>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// BAD
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>beforeEach</span><span class=p>((</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>to</span><span class=p>.</span><span class=nx>name</span> <span class=o>!==</span> <span class=s1>&#39;Login&#39;</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nx>isAuthenticated</span><span class=p>)</span> <span class=nx>next</span><span class=p>({</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Login&#39;</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 如果用户未能验证身份，则 `next` 会被调用两次
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>next</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>下面是正确的版本:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// GOOD
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>beforeEach</span><span class=p>((</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>to</span><span class=p>.</span><span class=nx>name</span> <span class=o>!==</span> <span class=s1>&#39;Login&#39;</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nx>isAuthenticated</span><span class=p>)</span> <span class=nx>next</span><span class=p>({</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Login&#39;</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span> <span class=nx>next</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h4 id=全局后置钩子>全局后置钩子<a hidden class=anchor aria-hidden=true href=#全局后置钩子>#</a></h4><p>你也可以注册全局后置钩子，然而和守卫不同的是，这些钩子不会接受 <code>next</code> 函数也不会改变导航本身：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>afterEach</span><span class=p>((</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>sendToAnalytics</span><span class=p>(</span><span class=nx>to</span><span class=p>.</span><span class=nx>fullPath</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>它们对于分析、更改页面标题、声明页面等辅助功能以及许多其他事情都很有用。</p><p>它们也反映了
<a href=https://router.vuejs.org/zh/guide/advanced/navigation-failures.html target=_blank>navigation failures</a> 作为第三个参数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>afterEach</span><span class=p>((</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>,</span> <span class=nx>failure</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>failure</span><span class=p>)</span> <span class=nx>sendToAnalytics</span><span class=p>(</span><span class=nx>to</span><span class=p>.</span><span class=nx>fullPath</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>更多关于 navigation failures 的信息在
<a href=https://router.vuejs.org/zh/guide/advanced/navigation-failures.html target=_blank>它的指南</a> 中。</p><h4 id=路由独享的守卫>路由独享的守卫<a hidden class=anchor aria-hidden=true href=#路由独享的守卫>#</a></h4><p>你可以直接在路由配置上定义 <code>beforeEnter</code> 守卫：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/users/:id&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=nx>UserDetails</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>beforeEnter</span><span class=o>:</span> <span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// reject the navigation
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>return</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><p><code>beforeEnter</code> 守卫 <strong>只在进入路由时触发</strong>，不会在 <code>params</code>、<code>query</code> 或 <code>hash</code> 改变时触发。例如，从 <code>/users/2</code> 进入到 <code>/users/3</code> 或者从 <code>/users/2#info</code> 进入到 <code>/users/2#projects</code>。它们只有在 <strong>从一个不同的</strong> 路由导航时，才会被触发。</p><p>你也可以将一个函数数组传递给 <code>beforeEnter</code>，这在为不同的路由重用守卫时很有用：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>removeQueryParams</span><span class=p>(</span><span class=nx>to</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nb>Object</span><span class=p>.</span><span class=nx>keys</span><span class=p>(</span><span class=nx>to</span><span class=p>.</span><span class=nx>query</span><span class=p>).</span><span class=nx>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span> <span class=nx>path</span><span class=o>:</span> <span class=nx>to</span><span class=p>.</span><span class=nx>path</span><span class=p>,</span> <span class=nx>query</span><span class=o>:</span> <span class=p>{},</span> <span class=nx>hash</span><span class=o>:</span> <span class=nx>to</span><span class=p>.</span><span class=nx>hash</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>removeHash</span><span class=p>(</span><span class=nx>to</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>to</span><span class=p>.</span><span class=nx>hash</span><span class=p>)</span> <span class=k>return</span> <span class=p>{</span> <span class=nx>path</span><span class=o>:</span> <span class=nx>to</span><span class=p>.</span><span class=nx>path</span><span class=p>,</span> <span class=nx>query</span><span class=o>:</span> <span class=nx>to</span><span class=p>.</span><span class=nx>query</span><span class=p>,</span> <span class=nx>hash</span><span class=o>:</span> <span class=s1>&#39;&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/users/:id&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=nx>UserDetails</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>beforeEnter</span><span class=o>:</span> <span class=p>[</span><span class=nx>removeQueryParams</span><span class=p>,</span> <span class=nx>removeHash</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/about&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=nx>UserDetails</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>beforeEnter</span><span class=o>:</span> <span class=p>[</span><span class=nx>removeQueryParams</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><p>请注意，你也可以通过使用
<a href=https://router.vuejs.org/zh/guide/advanced/meta target=_blank>路径 meta 字段</a>和全局导航守卫来实现类似的行为。</p><h4 id=组件内的守卫>组件内的守卫<a hidden class=anchor aria-hidden=true href=#组件内的守卫>#</a></h4><p>最后，你可以在路由组件内直接定义路由导航守卫(传递给路由配置的)</p><h4 id=可用的配置-api>可用的配置 API<a hidden class=anchor aria-hidden=true href=#可用的配置-api>#</a></h4><p>你可以为路由组件添加以下配置：</p><ul><li><code>beforeRouteEnter</code></li><li><code>beforeRouteUpdate</code></li><li><code>beforeRouteLeave</code></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>UserDetails</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>template</span><span class=o>:</span> <span class=sb>`...`</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>beforeRouteEnter</span><span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 在渲染该组件的对应路由被验证前调用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 不能获取组件实例 `this` ！
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 因为当守卫执行时，组件实例还没被创建！
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>beforeRouteUpdate</span><span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 在当前路由改变，但是该组件被复用时调用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 举例来说，对于一个带有动态参数的路径 `/users/:id`，在 `/users/1` 和 `/users/2` 之间跳转的时候，
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 由于会渲染同样的 `UserDetails` 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 因为在这种情况发生的时候，组件已经挂载好了，导航守卫可以访问组件实例 `this`
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>beforeRouteLeave</span><span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 在导航离开渲染该组件的对应路由时调用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 与 `beforeRouteUpdate` 一样，它可以访问组件实例 `this`
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><code>beforeRouteEnter</code> 守卫 <strong>不能</strong> 访问 <code>this</code>，因为守卫在导航确认前被调用，因此即将登场的新组件还没被创建。</p><p>不过，你可以通过传一个回调给 <code>next</code> 来访问组件实例。在导航被确认的时候执行回调，并且把组件实例作为回调方法的参数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>beforeRouteEnter</span> <span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>next</span><span class=p>(</span><span class=nx>vm</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 通过 `vm` 访问组件实例
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>注意 <code>beforeRouteEnter</code> 是支持给 <code>next</code> 传递回调的唯一守卫。对于 <code>beforeRouteUpdate</code> 和 <code>beforeRouteLeave</code> 来说，<code>this</code> 已经可用了，所以<em>不支持</em> 传递回调，因为没有必要了：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>beforeRouteUpdate</span> <span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// just use `this`
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>this</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=nx>to</span><span class=p>.</span><span class=nx>params</span><span class=p>.</span><span class=nx>name</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>这个 <strong>离开守卫</strong> 通常用来预防用户在还未保存修改前突然离开。该导航可以通过返回 <code>false</code> 来取消。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>beforeRouteLeave</span> <span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>answer</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>confirm</span><span class=p>(</span><span class=s1>&#39;Do you really want to leave? you have unsaved changes!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>answer</span><span class=p>)</span> <span class=k>return</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=使用组合-ap>使用组合 AP<a hidden class=anchor aria-hidden=true href=#使用组合-ap>#</a></h5><p>如果你正在使用
<a href=https://cn.vuejs.org/api/composition-api-setup.html target=_blank>组合 API 和 <code>setup</code> 函数</a>来编写组件，你可以通过 <code>onBeforeRouteUpdate</code> 和 <code>onBeforeRouteLeave</code> 分别添加 update 和 leave 守卫。 请参考
<a href=https://router.vuejs.org/zh/guide/advanced/composition-api.html#%e5%af%bc%e8%88%aa%e5%ae%88%e5%8d%ab target=_blank>组合 API 部分</a>以获得更多细节。</p><h4 id=完整的导航解析流程>完整的导航解析流程<a hidden class=anchor aria-hidden=true href=#完整的导航解析流程>#</a></h4><ol><li>导航被触发。</li><li>在失活的组件里调用 <code>beforeRouteLeave</code> 守卫。</li><li>调用全局的 <code>beforeEach</code> 守卫。</li><li>在重用的组件里调用 <code>beforeRouteUpdate</code> 守卫(2.2+)。</li><li>在路由配置里调用 <code>beforeEnter</code>。</li><li>解析异步路由组件。</li><li>在被激活的组件里调用 <code>beforeRouteEnter</code>。</li><li>调用全局的 <code>beforeResolve</code> 守卫(2.5+)。</li><li>导航被确认。</li><li>调用全局的 <code>afterEach</code> 钩子。</li><li>触发 DOM 更新。</li><li>调用 <code>beforeRouteEnter</code> 守卫中传给 <code>next</code> 的回调函数，创建好的组件实例会作为回调函数的参数传入。</li></ol><h3 id=路由案例>路由案例<a hidden class=anchor aria-hidden=true href=#路由案例>#</a></h3><p>目标: 路由跳转之前, 先执行一次前置守卫函数, 判断是否可以正常跳转</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// `router.beforeEach`
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>beforeEach</span><span class=p>((</span><span class=nx>to</span><span class=p>,</span> <span class=nx>form</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>form</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>next</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>每个守卫方法接收三个参数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>to</span><span class=o>:</span> <span class=nx>Route</span><span class=err>，</span> <span class=nx>即将要进入的目标</span> <span class=nx>路由对象</span><span class=err>；</span>
</span></span><span class=line><span class=cl><span class=nx>from</span><span class=o>:</span> <span class=nx>Route</span><span class=err>，</span><span class=nx>当前导航正要离开的路由</span><span class=err>；</span>
</span></span><span class=line><span class=cl><span class=nx>next</span><span class=p>()</span><span class=o>:</span> <span class=nx>进行管道中的下一个钩子</span><span class=err>。</span><span class=nx>如果全部钩子执行完了</span><span class=err>，</span><span class=nx>则导航的状态就是</span> <span class=nx>confirmed</span> <span class=p>(</span><span class=nx>确认的</span><span class=p>)</span><span class=err>。</span>
</span></span><span class=line><span class=cl><span class=nx>next</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span><span class=o>:</span> <span class=nx>中断当前的导航</span><span class=err>。</span><span class=nx>如果浏览器的</span> <span class=nx>URL</span> <span class=nx>改变了</span> <span class=p>(</span><span class=nx>可能是用户手动或者浏览器后退按钮</span><span class=p>)</span><span class=err>，</span><span class=nx>那么</span> <span class=nx>URL</span> <span class=nx>地址会重置到</span> <span class=nx>from</span> <span class=nx>路由对应的地址</span><span class=err>。</span>
</span></span><span class=line><span class=cl><span class=nx>next</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span> <span class=nx>或者</span> <span class=nx>next</span><span class=p>({</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/&#39;</span> <span class=p>})</span><span class=o>:</span> <span class=nx>跳转到一个不同的地址</span><span class=err>。</span><span class=nx>当前的导航被中断</span><span class=err>，</span><span class=nx>然后进行一个新的导航</span><span class=err>。</span>
</span></span></code></pre></div><h4 id=登录拦截>登录拦截<a hidden class=anchor aria-hidden=true href=#登录拦截>#</a></h4><p>使用例子: 在跳转路由前, 判断用户登陆了才能去 <code>&lt;我的音乐></code> 页面, 未登录弹窗提示回到发现音乐页面</p><p>在路由对象上使用固定方法 beforeEach</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 目标: 路由守卫
</span></span></span><span class=line><span class=cl><span class=c1>// 场景: 当你要对路由权限判断时
</span></span></span><span class=line><span class=cl><span class=c1>// 语法: router.beforeEach((to, from, next)=&gt;{//路由跳转&#34;之前&#34;先执行这里, 决定是否跳转})
</span></span></span><span class=line><span class=cl><span class=c1>// 参数1: 要跳转到的路由 (路由对象信息)    目标
</span></span></span><span class=line><span class=cl><span class=c1>// 参数2: 从哪里跳转的路由 (路由对象信息)  来源
</span></span></span><span class=line><span class=cl><span class=c1>// 参数3: 函数体 - next()才会让路由正常的跳转切换, next(false)在原地停留, next(&#34;强制修改到另一个路由路径上&#34;)
</span></span></span><span class=line><span class=cl><span class=c1>// 注意: 如果不调用 next, 页面留在原地
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>isLogin</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span><span class=c1>// 登录状态(未登录)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>beforeEach</span><span class=p>((</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>to</span><span class=p>.</span><span class=nx>path</span> <span class=o>===</span> <span class=s1>&#39;/my&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>isLogin</span><span class=p>.</span><span class=nx>value</span> <span class=o>===</span> <span class=kc>false</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>alert</span><span class=p>(</span><span class=s1>&#39;请登录&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>next</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span> <span class=c1>// 阻止路由跳转
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>next</span><span class=p>()</span> <span class=c1>// 正常放行
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><blockquote><p>总结: next()放行, next(false)留在原地不跳转路由, next(path路径)强制换成对应path路径跳转</p></blockquote><h4 id=权限判断>权限判断<a hidden class=anchor aria-hidden=true href=#权限判断>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>whileList</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;/&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>beforeEach</span><span class=p>((</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>localStorage</span><span class=p>.</span><span class=nx>getItem</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>//白名单 有值 或者登陆过存储了token信息可以跳转 否则就去登录页面
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>whileList</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=nx>to</span><span class=p>.</span><span class=nx>path</span><span class=p>)</span> <span class=o>||</span> <span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>next</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>next</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h3 id=路由原信息>路由原信息<a hidden class=anchor aria-hidden=true href=#路由原信息>#</a></h3><p>有时，你可能希望将任意信息附加到路由上，如过渡名称、谁可以访问路由等。这些事情可以通过接收属性对象的<code>meta</code>属性来实现，并且它可以在路由地址和导航守卫上都被访问到。定义路由的时候你可以这样配置 <code>meta</code> 字段：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/posts&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=nx>PostsLayout</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>children</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;new&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>component</span><span class=o>:</span> <span class=nx>PostsNew</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 只有经过身份验证的用户才能创建帖子
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>meta</span><span class=o>:</span> <span class=p>{</span> <span class=nx>requiresAuth</span><span class=o>:</span> <span class=kc>true</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;:id&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>component</span><span class=o>:</span> <span class=nx>PostsDetail</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 任何人都可以阅读文章
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>meta</span><span class=o>:</span> <span class=p>{</span> <span class=nx>requiresAuth</span><span class=o>:</span> <span class=kc>false</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><p>那么如何访问这个 <code>meta</code> 字段呢？</p><p>首先，我们称呼 <code>routes</code> 配置中的每个路由对象为 <strong>路由记录</strong>。路由记录可以是嵌套的，因此，当一个路由匹配成功后，它可能匹配多个路由记录。</p><p>例如，根据上面的路由配置，<code>/posts/new</code> 这个 URL 将会匹配父路由记录 (<code>path: '/posts'</code>) 以及子路由记录 (<code>path: 'new'</code>)。</p><p>一个路由匹配到的所有路由记录会暴露为 <code>$route</code> 对象(还有在导航守卫中的路由对象)的<code>$route.matched</code> 数组。我们需要遍历这个数组来检查路由记录中的 <code>meta</code> 字段，但是 Vue Router 还为你提供了一个 <code>$route.meta</code> 方法，它是一个非递归合并<strong>所有 <code>meta</code></strong> 字段（从父字段到子字段）的方法。这意味着你可以简单地写</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>beforeEach</span><span class=p>((</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 而不是去检查每条路由记录
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// to.matched.some(record =&gt; record.meta.requiresAuth)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>to</span><span class=p>.</span><span class=nx>meta</span><span class=p>.</span><span class=nx>requiresAuth</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nx>auth</span><span class=p>.</span><span class=nx>isLoggedIn</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 此路由需要授权，请检查是否已登录
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 如果没有，则重定向到登录页面
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/login&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 保存我们所在的位置，以便以后再来
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>query</span><span class=o>:</span> <span class=p>{</span> <span class=nx>redirect</span><span class=o>:</span> <span class=nx>to</span><span class=p>.</span><span class=nx>fullPath</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h3 id=过渡动效>过渡动效<a hidden class=anchor aria-hidden=true href=#过渡动效>#</a></h3><p>想要在你的路径组件上使用转场，并对导航进行动画处理，你需要使用
<a href=https://router.vuejs.org/zh/api/#router-view-s-v-slot target=_blank>v-slot API</a>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>router-view</span> <span class=err>#</span><span class=na>default</span><span class=o>=</span><span class=s>&#34;{route,Component}&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>transition</span>  <span class=o>:</span><span class=na>enter</span><span class=nt>-active-class</span><span class=err>=&#34;`</span><span class=na>animate__animated</span> <span class=err>$</span><span class=p>{</span><span class=na>route.meta.transition</span><span class=p>}</span><span class=err>`&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>component</span> <span class=nt>:is</span><span class=o>=</span><span class=s>&#34;Component&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>component</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>transition</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>router-view</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>上面的用法会对所有的路由使用相同的过渡。如果你想让每个路由的组件有不同的过渡，你可以将
<a href=https://router.vuejs.org/zh/guide/advanced/meta.html target=_blank>元信息</a>和动态的 <code>name</code> 结合在一起，放在<code>&lt;transition></code> 上：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/custom-transition&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=nx>PanelLeft</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>meta</span><span class=o>:</span> <span class=p>{</span> <span class=nx>transition</span><span class=o>:</span> <span class=s1>&#39;slide-left&#39;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/other-transition&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=nx>PanelRight</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>meta</span><span class=o>:</span> <span class=p>{</span> <span class=nx>transition</span><span class=o>:</span> <span class=s1>&#39;slide-right&#39;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>router-view</span> <span class=na>v-slot</span><span class=o>=</span><span class=s>&#34;{ Component, route }&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=c>&lt;!-- 使用任何自定义过渡和回退到 `fade` --&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>transition</span> <span class=na>:name</span><span class=o>=</span><span class=s>&#34;route.meta.transition || &#39;fade&#39;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>component</span> <span class=na>:is</span><span class=o>=</span><span class=s>&#34;Component&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>transition</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>router-view</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>也可以根据目标路由和当前路由之间的关系，动态地确定使用的过渡。使用和刚才非常相似的片段：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=c>&lt;!--</span> <span class=nx>使用动态过渡名称</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>router-view</span> <span class=nt>v-slot</span><span class=o>=</span><span class=s>&#34;{ Component, route }&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>transition</span> <span class=nt>:name</span><span class=o>=</span><span class=s>&#34;route.meta.transition&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>component</span> <span class=nt>:is</span><span class=o>=</span><span class=s>&#34;Component&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>transition</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>router-view</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>我们可以添加一个
<a href=https://router.vuejs.org/zh/guide/advanced/navigation-guards.html#%e5%85%a8%e5%b1%80%e5%90%8e%e7%bd%ae%e9%92%a9%e5%ad%90 target=_blank>after navigation hook</a>，根据路径的深度动态添加信息到 <code>meta</code> 字段。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>afterEach</span><span class=p>((</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>toDepth</span> <span class=o>=</span> <span class=nx>to</span><span class=p>.</span><span class=nx>path</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>).</span><span class=nx>length</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>fromDepth</span> <span class=o>=</span> <span class=nx>from</span><span class=p>.</span><span class=nx>path</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>).</span><span class=nx>length</span>
</span></span><span class=line><span class=cl>  <span class=nx>to</span><span class=p>.</span><span class=nx>meta</span><span class=p>.</span><span class=nx>transition</span> <span class=o>=</span> <span class=nx>toDepth</span> <span class=o>&lt;</span> <span class=nx>fromDepth</span> <span class=o>?</span> <span class=s1>&#39;slide-right&#39;</span> <span class=o>:</span> <span class=s1>&#39;slide-left&#39;</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>Vue 可能会自动复用看起来相似的组件，从而忽略了任何过渡。幸运的是，可以
<a href=https://cn.vuejs.org/api/built-in-special-attributes.html#key target=_blank>添加一个 <code>key</code> 属性</a>来强制过渡。这也允许你在相同路由上使用不同的参数触发过渡：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>router-view</span> <span class=nt>v-slot</span><span class=o>=</span><span class=s>&#34;{ Component, route }&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>transition</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;fade&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>component</span> <span class=nt>:is</span><span class=o>=</span><span class=s>&#34;Component&#34;</span> <span class=nt>:key</span><span class=o>=</span><span class=s>&#34;route.path&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>transition</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>router-view</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=滚动行为>滚动行为<a hidden class=anchor aria-hidden=true href=#滚动行为>#</a></h3><p>使用前端路由，当切换到新路由时，想要页面滚到顶部，或者是保持原先的滚动位置，就像重新加载页面那样。 vue-router 能做到，而且更好，它让你可以自定义路由切换时页面如何滚动。</p><p><strong>注意: 这个功能只在支持 history.pushState 的浏览器中可用。</strong></p><p>当创建一个 Router 实例，你可以提供一个 <code>scrollBehavior</code> 方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>history</span><span class=o>:</span> <span class=nx>createWebHashHistory</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>  <span class=nx>routes</span><span class=o>:</span> <span class=p>[...],</span>
</span></span><span class=line><span class=cl>  <span class=nx>scrollBehavior</span> <span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>,</span> <span class=nx>savedPosition</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// return 期望滚动到哪个的位置
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p><code>scrollBehavior</code> 函数接收 <code>to</code>和<code>from</code> 路由对象，如
<a href=https://router.vuejs.org/zh/guide/advanced/navigation-guards.html target=_blank>Navigation Guards</a>。第三个参数 <code>savedPosition</code>，只有当这是一个 <code>popstate</code> 导航时才可用（由浏览器的后退/前进按钮触发）。</p><p>该函数可以返回一个
<a href=https://developer.mozilla.org/en-US/docs/Web/API/ScrollToOptions target=_blank><code>ScrollToOptions</code></a> 位置对象:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>scrollBehavior</span><span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>,</span> <span class=nx>savedPosition</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 始终滚动到顶部
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=p>{</span> <span class=nx>top</span><span class=o>:</span> <span class=mi>0</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>你也可以通过 <code>el</code> 传递一个 CSS 选择器或一个 DOM 元素。在这种情况下，<code>top</code> 和 <code>left</code> 将被视为该元素的相对偏移量。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>scrollBehavior</span><span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>,</span> <span class=nx>savedPosition</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 始终在元素 #main 上方滚动 10px
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 也可以这么写
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>// el: document.getElementById(&#39;main&#39;),
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>el</span><span class=o>:</span> <span class=s1>&#39;#main&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 在元素上 10 像素
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>top</span><span class=o>:</span> <span class=mi>10</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>如果返回一个 falsy 的值，或者是一个空对象，那么不会发生滚动。</p><p>返回 <code>savedPosition</code>，在按下 后退/前进 按钮时，就会像浏览器的原生表现那样：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>scrollBehavior</span><span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>,</span> <span class=nx>savedPosition</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>savedPosition</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>savedPosition</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>{</span> <span class=nx>top</span><span class=o>:</span> <span class=mi>0</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>如果你要模拟 “滚动到锚点” 的行为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>scrollBehavior</span><span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>,</span> <span class=nx>savedPosition</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>to</span><span class=p>.</span><span class=nx>hash</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>el</span><span class=o>:</span> <span class=nx>to</span><span class=p>.</span><span class=nx>hash</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>如果你的浏览器支持
<a href=https://developer.mozilla.org/en-US/docs/Web/API/ScrollToOptions/behavior target=_blank>滚动行为</a>，你可以让它变得更流畅：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>scrollBehavior</span><span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>,</span> <span class=nx>savedPosition</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>to</span><span class=p>.</span><span class=nx>hash</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>el</span><span class=o>:</span> <span class=nx>to</span><span class=p>.</span><span class=nx>hash</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>behavior</span><span class=o>:</span> <span class=s1>&#39;smooth&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>有时候，我们需要在页面中滚动之前稍作等待。例如，当处理过渡时，我们希望等待过渡结束后再滚动。要做到这一点，你可以返回一个 Promise，它可以返回所需的位置描述符。下面是一个例子，我们在滚动前等待 500ms：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>scrollBehavior</span><span class=p>(</span><span class=nx>to</span><span class=p>,</span> <span class=nx>from</span><span class=p>,</span> <span class=nx>savedPosition</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>resolve</span><span class=p>({</span> <span class=nx>left</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>top</span><span class=o>:</span> <span class=mi>0</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span> <span class=mi>500</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>我们可以将其与页面级过渡组件的事件挂钩，以使滚动行为与你的页面过渡很好地结合起来，但由于使用场景可能存在的差异和复杂性，我们只是提供了这个基础来实现特定的用户场景。</p><h3 id=动态路由>动态路由<a hidden class=anchor aria-hidden=true href=#动态路由>#</a></h3><p>对路由的添加通常是通过 <code>routes</code> 选项来完成的，但是在某些情况下，你可能想在应用程序已经运行的时候添加或删除路由。具有可扩展接口(如
<a href=https://cli.vuejs.org/dev-guide/ui-api.html target=_blank>Vue CLI UI</a> )这样的应用程序可以使用它来扩展应用程序。</p><h4 id=添加路由>添加路由<a hidden class=anchor aria-hidden=true href=#添加路由>#</a></h4><p>动态路由主要通过两个函数实现。<code>router.addRoute()</code> 和 <code>router.removeRoute()</code>。它们<strong>只</strong>注册一个新的路由，也就是说，如果新增加的路由与当前位置相匹配，就需要你用 <code>router.push()</code> 或 <code>router.replace()</code> 来<strong>手动导航</strong>，才能显示该新路由。我们来看一个例子：</p><p>想象一下，只有一个路由的以下路由：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>history</span><span class=o>:</span> <span class=nx>createWebHistory</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>  <span class=nx>routes</span><span class=o>:</span> <span class=p>[{</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/:articleName&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>Article</span> <span class=p>}],</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>进入任何页面，<code>/about</code>，<code>/store</code>，或者 <code>/3-tricks-to-improve-your-routing-code</code> 最终都会呈现 <code>Article</code> 组件。如果我们在 <code>/about</code> 上添加一个新的路由：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>addRoute</span><span class=p>({</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/about&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>About</span> <span class=p>})</span>
</span></span></code></pre></div><p>页面仍然会显示 <code>Article</code> 组件，我们需要手动调用 <code>router.replace()</code> 来改变当前的位置，并覆盖我们原来的位置（而不是添加一个新的路由，最后在我们的历史中两次出现在同一个位置）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>addRoute</span><span class=p>({</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/about&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>About</span> <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=c1>// 我们也可以使用 this.$route 或 route = useRoute() （在 setup 中）
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=nx>router</span><span class=p>.</span><span class=nx>currentRoute</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>fullPath</span><span class=p>)</span>
</span></span></code></pre></div><p>记住，如果你需要等待新的路由显示，可以使用 <code>await router.replace()</code>。</p><h4 id=删除路由>删除路由<a hidden class=anchor aria-hidden=true href=#删除路由>#</a></h4><p>有几个不同的方法来删除现有的路由：</p><ul><li><p>通过添加一个名称冲突的路由。如果添加与现有途径名称相同的途径，会先删除路由，再添加路由：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>addRoute</span><span class=p>({</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/about&#39;</span><span class=p>,</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;about&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>About</span> <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=c1>// 这将会删除之前已经添加的路由，因为他们具有相同的名字且名字必须是唯一的
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>addRoute</span><span class=p>({</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/other&#39;</span><span class=p>,</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;about&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>Other</span> <span class=p>})</span>
</span></span></code></pre></div></li><li><p>通过调用 <code>router.addRoute()</code> 返回的回调：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>removeRoute</span> <span class=o>=</span> <span class=nx>router</span><span class=p>.</span><span class=nx>addRoute</span><span class=p>(</span><span class=nx>routeRecord</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>removeRoute</span><span class=p>()</span> <span class=c1>// 删除路由如果存在的话
</span></span></span></code></pre></div><p>当路由没有名称时，这很有用。</p></li><li><p>通过使用 <code>router.removeRoute()</code> 按名称删除路由：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>addRoute</span><span class=p>({</span> <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/about&#39;</span><span class=p>,</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;about&#39;</span><span class=p>,</span> <span class=nx>component</span><span class=o>:</span> <span class=nx>About</span> <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=c1>// 删除路由
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>removeRoute</span><span class=p>(</span><span class=s1>&#39;about&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>需要注意的是，如果你想使用这个功能，但又想避免名字的冲突，可以在路由中使用 <code>Symbol</code> 作为名字。</p></li></ul><p>当路由被删除时，<strong>所有的别名和子路由也会被同时删除</strong></p><h4 id=查看现有路由>查看现有路由<a hidden class=anchor aria-hidden=true href=#查看现有路由>#</a></h4><p>Vue Router 提供了两个功能来查看现有的路由：</p><ul><li><a href=https://router.vuejs.org/zh/api/interfaces/Router.html#Methods-hasRoute target=_blank><code>router.hasRoute()</code></a>：检查路由是否存在。</li><li><a href=https://router.vuejs.org/zh/api/interfaces/Router.html#Methods-getRoutes target=_blank><code>router.getRoutes()</code></a>：获取一个包含所有路由记录的数组。</li></ul><h3 id=动态路由案例>动态路由案例<a hidden class=anchor aria-hidden=true href=#动态路由案例>#</a></h3><h4 id=后端代码---python-flask>后端代码 -> Python Flask<a hidden class=anchor aria-hidden=true href=#后端代码---python-flask>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask_cors</span> <span class=kn>import</span> <span class=n>CORS</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>CORS</span><span class=p>()</span><span class=o>.</span><span class=n>init_app</span><span class=p>(</span><span class=n>app</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>json</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>json</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>username</span> <span class=o>==</span> <span class=s1>&#39;admin&#39;</span> <span class=ow>and</span> <span class=n>password</span> <span class=o>==</span> <span class=s1>&#39;123456&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;routes&#39;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=s2>&#34;/articles&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s2>&#34;articles&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;parent&#39;</span><span class=p>:</span> <span class=s2>&#34;subviews&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;component&#39;</span><span class=p>:</span> <span class=s1>&#39;Articles.vue&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=s2>&#34;/hot&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s2>&#34;hot&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;parent&#39;</span><span class=p>:</span> <span class=s2>&#34;subviews&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;component&#39;</span><span class=p>:</span> <span class=s1>&#39;Hot.vue&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=s2>&#34;/author&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s2>&#34;author&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;parent&#39;</span><span class=p>:</span> <span class=s2>&#34;subviews&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;component&#39;</span><span class=p>:</span> <span class=s1>&#39;Author.vue&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;code&#39;</span><span class=p>:</span> <span class=mi>400</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=s2>&#34;账号密码错误&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/menus&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>menus</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;routes&#39;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=s1>&#39;/login&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;login&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;component&#39;</span><span class=p>:</span> <span class=s1>&#39;Login.vue&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=s1>&#39;/main&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;main&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;component&#39;</span><span class=p>:</span> <span class=s1>&#39;Main.vue&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;routes&#39;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=s1>&#39;/login&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;login&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;component&#39;</span><span class=p>:</span> <span class=s1>&#39;./views/Login.vue&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>debug</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>host</span><span class=o>=</span><span class=s1>&#39;127.0.0.1&#39;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>5000</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=前端代码>前端代码<a hidden class=anchor aria-hidden=true href=#前端代码>#</a></h4><ul><li>App.vue</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>setup</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span><span class=nx>onMounted</span><span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;vue&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>axios</span> <span class=nx>from</span> <span class=s2>&#34;axios&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span><span class=nx>useRouter</span><span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;vue-router&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>useRouter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 启动项目之后才加载登录路由
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>onMounted</span><span class=p>(</span><span class=nx>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=nx>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;http://127.0.0.1:5000/menus&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>response</span><span class=p>.</span><span class=nx>data</span>
</span></span><span class=line><span class=cl>  <span class=nx>data</span><span class=p>.</span><span class=nx>routes</span><span class=p>.</span><span class=nx>forEach</span><span class=p>((</span><span class=nx>v</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>router</span><span class=p>.</span><span class=nx>addRoute</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>path</span><span class=o>:</span> <span class=nx>v</span><span class=p>.</span><span class=nx>path</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>name</span><span class=o>:</span> <span class=nx>v</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=cm>/* @vite-ignore */</span> <span class=sb>`./components/</span><span class=si>${</span><span class=nx>v</span><span class=p>.</span><span class=nx>component</span><span class=si>}</span><span class=sb>`</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>await</span> <span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>router-view</span><span class=p>&gt;&lt;/</span><span class=nt>router-view</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>*</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>margin</span><span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>padding</span><span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>box</span><span class=o>-</span><span class=nx>sizing</span><span class=o>:</span> <span class=nx>border</span><span class=o>-</span><span class=nx>box</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>html</span><span class=p>,</span> <span class=nx>body</span><span class=p>,</span> <span class=err>#</span><span class=nx>app</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>width</span><span class=o>:</span> <span class=mi>100</span><span class=o>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>height</span><span class=o>:</span> <span class=mi>100</span><span class=o>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span></code></pre></div><ul><li>router.js</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>createRouter</span><span class=p>,</span> <span class=nx>createWebHistory</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue-router&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// @ 路径
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=kr>import</span><span class=p>.</span><span class=nx>meta</span><span class=p>.</span><span class=nx>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/login&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;login&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;@/components/login.vue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/main&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;main&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;@/components/main.vue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>history</span><span class=o>:</span> <span class=nx>createWebHistory</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>  <span class=nx>routes</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>router</span>
</span></span></code></pre></div><ul><li>login.vue</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;login&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>el-form</span> <span class=nt>:model</span><span class=o>=</span><span class=s>&#34;formInline&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;demo-form-inline&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>el-form-item</span> <span class=na>label</span><span class=o>=</span><span class=s>&#34;用户名：&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>el-input</span> <span class=nt>v-model</span><span class=o>=</span><span class=s>&#34;formInline.username&#34; placeholder=&#34;请输入用户名&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=err>&lt;/</span><span class=na>el</span><span class=nt>-form-item</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>el-form-item</span> <span class=na>label</span><span class=o>=</span><span class=s>&#34;密&amp;nbsp;&amp;nbsp;&amp;nbsp;码：&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>el-input</span> <span class=nt>v-model</span><span class=o>=</span><span class=s>&#34;formInline.password&#34; placeholder=&#34;请输入密码&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=err>&lt;/</span><span class=na>el</span><span class=nt>-input</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>el-form-item</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>el-form-item</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>el-button</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;primary&#34;</span> <span class=nt>@click</span><span class=s>=&#34;onSubmit&#34;</span><span class=p>&gt;</span><span class=na>提交登录</span><span class=err>&lt;/</span><span class=na>el</span><span class=nt>-button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>el-form-item</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>el-form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>setup</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>axios</span> <span class=nx>from</span> <span class=s1>&#39;axios&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span><span class=nx>reactive</span><span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span><span class=nx>useRouter</span><span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;vue-router&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>useRouter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>formInline</span> <span class=o>=</span> <span class=nx>reactive</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>username</span><span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>password</span><span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>onSubmit</span> <span class=o>=</span> <span class=nx>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>  
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=nx>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;http://127.0.0.1:5000/login&#39;</span><span class=p>,</span> <span class=nx>formInline</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>response</span><span class=p>.</span><span class=nx>data</span>  
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>data</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 登录成功之后, 解析后端返回的路由数据  
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>data</span><span class=o>?</span><span class=p>.</span><span class=nx>routes</span><span class=p>)</span> <span class=p>{</span>  
</span></span><span class=line><span class=cl>    <span class=nx>data</span><span class=p>.</span><span class=nx>routes</span><span class=p>.</span><span class=nx>forEach</span><span class=p>((</span><span class=nx>v</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>  
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>path</span> <span class=o>=</span> <span class=nx>v</span><span class=o>?</span><span class=p>.</span><span class=nx>parent</span> <span class=o>?</span> <span class=sb>`./</span><span class=si>${</span><span class=nx>v</span><span class=p>.</span><span class=nx>parent</span><span class=si>}</span><span class=sb>/</span><span class=si>${</span><span class=nx>v</span><span class=p>.</span><span class=nx>component</span><span class=si>}</span><span class=sb>`</span> <span class=o>:</span> <span class=sb>`./</span><span class=si>${</span><span class=nx>v</span><span class=p>.</span><span class=nx>component</span><span class=si>}</span><span class=sb>`</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>      <span class=nx>router</span><span class=p>.</span><span class=nx>addRoute</span><span class=p>(</span><span class=s1>&#39;main&#39;</span><span class=p>,</span> <span class=p>{</span>  
</span></span><span class=line><span class=cl>        <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;/main&#39;</span> <span class=o>+</span> <span class=nx>v</span><span class=p>.</span><span class=nx>path</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>        <span class=nx>name</span><span class=o>:</span> <span class=nx>v</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>        <span class=nx>component</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=cm>/* @vite-ignore */</span> <span class=nx>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>})</span>  
</span></span><span class=line><span class=cl>    <span class=p>})</span>  
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>router</span><span class=p>.</span><span class=nx>getRoutes</span><span class=p>())</span>  
</span></span><span class=line><span class=cl>    <span class=nx>await</span> <span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;/main&#39;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>  <span class=p>}</span>  
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>style</span> <span class=na>scoped</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>login</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>width</span><span class=o>:</span> <span class=mi>30</span><span class=o>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>margin</span><span class=o>:</span> <span class=mi>100</span><span class=nx>px</span> <span class=nx>auto</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span></code></pre></div><ul><li>main.js</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span><span class=nx>Main</span><span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;nav&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>router-link</span> <span class=na>to</span><span class=o>=</span><span class=s>&#34;/main/articles&#34;</span><span class=p>&gt;</span><span class=nx>阅读文章</span><span class=p>&lt;/</span><span class=nt>router-link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>router-link</span> <span class=na>to</span><span class=o>=</span><span class=s>&#34;/main/hot&#34;</span><span class=p>&gt;</span><span class=nx>排行热榜</span><span class=p>&lt;/</span><span class=nt>router-link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>router-link</span> <span class=na>to</span><span class=o>=</span><span class=s>&#34;/main/author&#34;</span><span class=p>&gt;</span><span class=nx>作者排行</span><span class=p>&lt;/</span><span class=nt>router-link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;subview&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>router-view</span><span class=p>&gt;&lt;/</span><span class=nt>router-view</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>setup</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>style</span> <span class=na>scoped</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>nav</span> <span class=nx>a</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>margin</span><span class=o>:</span> <span class=mi>20</span><span class=nx>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://waite.wang/tags/vue/>Vue</a></li></ul><nav class=paginav><a class=prev href=https://waite.wang/posts/vue/system-learn-vue-3-cli/><span class=title>« 上一页</span><br><span>系统学习 Vue -- 3-脚手架学习</span>
</a><a class=next href=https://waite.wang/posts/mini-program/learn-wechat-minipro-1/><span class=title>下一页 »</span><br><span>微信小程序入门</span></a></nav></footer><script src=https://utteranc.es/client.js repo=Waite0603/HugoBlog issue-term=pathname theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span><a href=https://beian.miit.gov.cn/ target=_blank rel="noopener noreferrer">粤ICP备2022028437号-1</a></span><br><span>Copyright &copy; 2018 - 2025 By <a href=https://waite.wang/>Waite</a>, All Rights
Reserved.</span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script src=/js/jquery-3.5.1.min.js></script><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery.fancybox.min.js></script></body></html>