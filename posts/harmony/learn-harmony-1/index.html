<!doctype html><html lang=zh-cn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>鸿蒙学习笔记1 | 隶笔难书</title>
<meta name=keywords content="Harmony"><meta name=description content="编辑器安装
安装


下载安装包
正常安装包, 下一步安装



  
    
  



配置开发环境



  
    
  


选择 Agree, 进入配置选择页面, 选择不导入配置


  
    
  


选择要安装的Node.is和hpm位置，其中ohpm是Open Harmony Package Management的缩写，也就是类似npm的包管理工具。这里有几点注意事项:"><meta name=author content><link rel=canonical href=https://waite.wang/posts/harmony/learn-harmony-1/><link crossorigin=anonymous href=/assets/css/stylesheet.c23d77c650f3aa02a79bbe7e1c00a00447db4f6603c968933ce8bb126f330334.css integrity="sha256-wj13xlDzqgKnm75+HACgBEfbT2YDyWiTPOi7Em8zAzQ=" rel="preload stylesheet" as=style><link rel=icon href=https://waite.wang/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://waite.wang/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://waite.wang/favicon-32x32.png><link rel=apple-touch-icon href=https://waite.wang/apple-touch-icon.png><link rel=mask-icon href=https://waite.wang/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-cn href=https://waite.wang/posts/harmony/learn-harmony-1/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://waite.wang/posts/harmony/learn-harmony-1/"><meta property="og:site_name" content="隶笔难书"><meta property="og:title" content="鸿蒙学习笔记1"><meta property="og:description" content="编辑器安装 安装 下载安装包 正常安装包, 下一步安装 配置开发环境 选择 Agree, 进入配置选择页面, 选择不导入配置
选择要安装的Node.is和hpm位置，其中ohpm是Open Harmony Package Management的缩写，也就是类似npm的包管理工具。这里有几点注意事项:"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-23T16:04:23+08:00"><meta property="article:modified_time" content="2024-03-23T16:04:23+08:00"><meta property="article:tag" content="Harmony"><meta name=twitter:card content="summary"><meta name=twitter:title content="鸿蒙学习笔记1"><meta name=twitter:description content="编辑器安装
安装


下载安装包
正常安装包, 下一步安装



  
    
  



配置开发环境



  
    
  


选择 Agree, 进入配置选择页面, 选择不导入配置


  
    
  


选择要安装的Node.is和hpm位置，其中ohpm是Open Harmony Package Management的缩写，也就是类似npm的包管理工具。这里有几点注意事项:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://waite.wang/posts/"},{"@type":"ListItem","position":2,"name":"鸿蒙学习笔记1","item":"https://waite.wang/posts/harmony/learn-harmony-1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"鸿蒙学习笔记1","name":"鸿蒙学习笔记1","description":"编辑器安装 安装 下载安装包 正常安装包, 下一步安装 配置开发环境 选择 Agree, 进入配置选择页面, 选择不导入配置\n选择要安装的Node.is和hpm位置，其中ohpm是Open Harmony Package Management的缩写，也就是类似npm的包管理工具。这里有几点注意事项:\n","keywords":["Harmony"],"articleBody":"编辑器安装 安装 下载安装包 正常安装包, 下一步安装 配置开发环境 选择 Agree, 进入配置选择页面, 选择不导入配置\n选择要安装的Node.is和hpm位置，其中ohpm是Open Harmony Package Management的缩写，也就是类似npm的包管理工具。这里有几点注意事项:\n如果电脑上已经有Node.js，但是版本不一致，建议选择让工具重新安装 如果电脑上已经有Node.js，并且版本一致，可以选择Local，指定node目录即可 如果电脑上对Node.is做了一些特殊的options配置，建议先移除 配置目录中不要出现中文、特殊字符，建议用默认路径 选择Next后，进入HarmonyOs的SDK安装目录选择页面以及同意协议, 配置目录/ 同意协议后下一步即可\n环境错误处理 在安装的过程中，如果出现类似下面的错误\n一般就是因为你本地原本的Node.is配置异常导致的，建议清理环境变量中对于Node.is的配置之后再重试 重试时无需重新安装，而是再次打开DevEco Studio，点击界面左下方的 ? 按钮: 选择第一个 Diagnose Development Environment 进入诊断页面, 这里会提示安装出现问题的选项，点击异常项后面的set it up now即可重新安装 如果所有问题都已经解决，最终重试后等待所有项都是 √即可\n中文设置 设置-\u003e插件-\u003e已安装-\u003e其他工具-\u003echinese-\u003e启用即可\n创建项目 Create Project -\u003e Empty Ability -\u003e 按要求填写目录即可\n此时项目内已有 Hello World 基础代码, 点右侧预览器即可预览效果\n模拟器安装 我们也可以利用设备模拟器来查看更真实的效果。不过需要先配置模拟器\n首先，选择主菜单中的Tools，找到其中的Device Manager，即设备管理\n设备可以是 远端设备 ，也可以是 本地设备 ，我们以本地设备为例。\n默认本地没有任何设备，选择install来安装一个\n首次点击时，会弹出一个窗口，下载必要的SDK依赖, 安装完下一步即可\n进入创建模拟器页面，选择New Emulator:\n选择api9版本，不过需要注意，首次进入此页面，需要下载手机设备需要的系统，大概2.2G，需要耐心等待:\n创建完成后，在设备列表中会出现一个本地设备，点击后面的运行按钮即可启动设备模拟器\n启动后如下\n然后，在应用启动位置选择刚刚添加的模拟器, 然后点击启动即可\n效果如下\nStage 与 FA 模型的区别 FA模型：早期的探索 FA模型是HarmonyOS早期版本开始支持的应用模型。它通过PageAbility、ServiceAbility和DataAbility三种组件，为开发者提供了构建应用的基础。FA模型的特点是每个组件运行在自己的进程中，拥有独立的JS VM引擎实例，这使得组件之间相互隔离，但也带来了一定的内存占用。\n随着HarmonyOS的演进，特别是1+8+N的战略被提出，多设备和多窗口形态成为主流，此时FA模型在处理复杂应用时存在一定的局限性， FA模型逐渐不再被主推。\nStage模型：未来的主流 为了更好地适应复杂应用的开发需求，HarmonyOS 3.1 Developer Preview版本引入了Stage模型。Stage模型通过AbilityStage、WindowStage等类，将应用组件和Window窗口作为“舞台”进行管理，从而提供了更加灵活和高效的开发方式。\nStage模型的设计出发点是为了复杂应用而设计，它通过以下几个方面实现了对复杂应用的优化：\n共享ArkTS引擎实例：在Stage模型中，多个应用组件共享同一个ArkTS引擎实例，这使得组件之间可以方便地共享对象和状态，同时减少了内存占用。\n面向对象的开发方式：Stage模型采用面向对象的开发方式，提高了代码的可读性、易维护性和可扩展性。\n支持多设备和多窗口形态：应用组件管理和窗口管理在架构层面解耦，使得应用组件可以在不同设备上使用同一套生命周期，便于系统扩展窗口形态。\n平衡应用能力和系统管控成本：Stage模型重新定义了应用能力的边界，提供了特定场景的应用组件，规范化了后台进程管理，防止了恶意应用行为。\n（Stage模型）目录结构 AppScope \u003e app.json5：应用的全局配置信息。 entry：HarmonyOS工程模块，编译构建生成一个HAP包。 src \u003e main \u003e ets：用于存放ArkTS源码。 src \u003e main \u003e ets \u003e entryability：应用/服务的入口。 src \u003e main \u003e ets \u003e pages：应用/服务包含的页面 src \u003e main \u003e resources：用于存放应用/服务所用到的资源文件，如图形、多媒体、字符串、布局文件等。关于资源文件，详见资源分类与访问。 src \u003e main \u003e module.json5：Stage模型模块配置文件。主要包含HAP包的配置信息、应用/服务在具体设备上的配置信息以及应用/服务的全局配置信息。具体的配置文件说明，详见 module.json5配置文件。 build-profile.json5：当前的模块信息、编译信息配置项，包括buildOption、targets配置等。其中targets中可配置当前运行环境，默认为HarmonyOS。 hvigorfile.ts：模块级编译构建任务脚本，开发者可以自定义相关任务和代码实现。 oh_modules：用于存放三方库依赖信息。关于原npm工程适配ohpm操作，请参考历史工程迁移。 build-profile.json5：应用级配置信息，包括签名、产品配置等。 hvigorfile.ts：应用级编译构建任务脚本。 ArkUI 组件 基础组件 Text Text($r(\"app.string.module_desc\")) 文本会先在对应国家的资源文件中查找，如果没有找到，会在 base 全局资源文件中查找。\nTextInput Button 方法1： Button(options?: {type?: ButtonType, stateEffect?: boolean})\n方法2： Button(label?: ResourceStr, options?: { type?: ButtonType, stateEffect?: boolean })\n使用文本内容创建相应的按钮组件，此时Button无法包含子组件。\nImage 图片组件，支持本地图片和网络图片的渲染展示。\nImage(src: string | PixelMap | Resource) 图片的数据源，支持本地图片和网络图片。当使用相对路径引用图片资源时，例如Image(“common/test.jpg”)，不支持该Image组件被跨包/跨模块调用，建议使用$r方式来管理需全局使用的图片资源。\n支持的图片格式包括png、jpg、bmp、svg和gif。 支持Base64字符串。格式data:image/[png|jpeg|bmp|webp];base64,[base64 data], 其中[base64 data]为Base64字符串数据。 支持dataability://路径前缀的字符串，用于访问通过data ability提供的图片路径。 从网络加载图片 使用网络图片时，需要申请权限ohos.permission.INTERNET。具体申请方式请参考 权限申请声明。\n// entry/src/main/module.json5 { \"module\": { \"reqPermissions\": [ { \"name\": \"ohos.permission.INTERNET\", } ] } } 通过以下代码，可以加载网络图片：\nImage(\"https://example.com/image.jpg\") 从本地加载 Image($r(\"app.media.icon\")) Image($rawfile(\"abstract.png\")) Slider Slider({ min: 0, // 最小值 max: 100, // 最大值 value: 40, // 当前值 step: 10, // 步长 style: SliderStyle.InSet, // Outer Slider direction: Axis.Horizontal, // 方向 reverse: false // 方向滑动 }) .showTips(true) // 展示 value 百分比 .margin({ top: 20 }) 容器组件 https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V3/arkui-ts-container-components-0000001334734185-V3\nColumn 沿垂直方向布局的容器。\n@Entry @Component struct ColumnExample { build() { Column() { Text('space').fontSize(9).fontColor(0xCCCCCC).width('90%') Column({ space: 5 }) { Column().width('100%').height(30).backgroundColor(0xAFEEEE) Column().width('100%').height(30).backgroundColor(0x00FFFF) }.width('90%').height(100).border({ width: 1 }) Text('alignItems(Start)').fontSize(9).fontColor(0xCCCCCC).width('90%') Column() { Column().width('50%').height(30).backgroundColor(0xAFEEEE) Column().width('50%').height(30).backgroundColor(0x00FFFF) }.alignItems(HorizontalAlign.Start).width('90%').border({ width: 1 }) Text('alignItems(End)').fontSize(9).fontColor(0xCCCCCC).width('90%') Column() { Column().width('50%').height(30).backgroundColor(0xAFEEEE) Column().width('50%').height(30).backgroundColor(0x00FFFF) }.alignItems(HorizontalAlign.End).width('90%').border({ width: 1 }) Text('justifyContent(Center)').fontSize(9).fontColor(0xCCCCCC).width('90%') Column() { Column().width('30%').height(30).backgroundColor(0xAFEEEE) Column().width('30%').height(30).backgroundColor(0x00FFFF) }.height('15%').border({ width: 1 }).justifyContent(FlexAlign.Center) Text('justifyContent(End)').fontSize(9).fontColor(0xCCCCCC).width('90%') Column() { Column().width('30%').height(30).backgroundColor(0xAFEEEE) Column().width('30%').height(30).backgroundColor(0x00FFFF) }.height('15%').border({ width: 1 }).justifyContent(FlexAlign.End) }.width('100%').padding({ top: 5 }) } } Row 沿水平方向布局容器。\n// xxx.ets @Entry @Component struct RowExample { build() { Column({ space: 5 }) { Text('space').fontSize(9).fontColor(0xCCCCCC).width('90%') Row({ space: 5 }) { Row().width('30%').height(50).backgroundColor(0xAFEEEE) Row().width('30%').height(50).backgroundColor(0x00FFFF) }.width('90%').height(107).border({ width: 1 }) Text('alignItems(Top)').fontSize(9).fontColor(0xCCCCCC).width('90%') Row() { Row().width('30%').height(50).backgroundColor(0xAFEEEE) Row().width('30%').height(50).backgroundColor(0x00FFFF) }.alignItems(VerticalAlign.Top).height('15%').border({ width: 1 }) Text('alignItems(Center)').fontSize(9).fontColor(0xCCCCCC).width('90%') Row() { Row().width('30%').height(50).backgroundColor(0xAFEEEE) Row().width('30%').height(50).backgroundColor(0x00FFFF) }.alignItems(VerticalAlign.Center).height('15%').border({ width: 1 }) Text('justifyContent(End)').fontSize(9).fontColor(0xCCCCCC).width('90%') Row() { Row().width('30%').height(50).backgroundColor(0xAFEEEE) Row().width('30%').height(50).backgroundColor(0x00FFFF) }.width('90%').border({ width: 1 }).justifyContent(FlexAlign.End) Text('justifyContent(Center)').fontSize(9).fontColor(0xCCCCCC).width('90%') Row() { Row().width('30%').height(50).backgroundColor(0xAFEEEE) Row().width('30%').height(50).backgroundColor(0x00FFFF) }.width('90%').border({ width: 1 }).justifyContent(FlexAlign.Center) }.width('100%') } } 案例 // xxx.ets @Entry @Component struct Index { @State imgWidth: number = 30 build() { Row() { Column() { Image($r(\"app.media.icon\")) .width(this.imgWidth) .interpolation(ImageInterpolation.High) Text(`图片宽度: ${this.imgWidth}`) .margin(20) TextInput({ placeholder: \"请输入图片宽度\", text: this.imgWidth.toString() }) .width(200) .type(InputType.Number) .onChange(value =\u003e { this.imgWidth = parseInt(value) }) Row() { Button(\"缩小\") .width(80) .onClick(() =\u003e { if (this.imgWidth \u003e= 10) { this.imgWidth -= 10 } }) Button(\"放大\") .width(80) .onClick(() =\u003e { if (this.imgWidth \u003c= 300) { this.imgWidth += 10 } }) } .margin({ top: 20 }) Slider({ min: 0, // 最小值 max: 100, // 最大值 value: 40, // 当前值 step: 10, // 步长 style: SliderStyle.InSet, // Outer Slider direction: Axis.Horizontal, // 方向 reverse: false // 方向滑动 }) .showTips(true) // 展示 value 百分比 .margin({ top: 20 }) .width(\"80%\") } .width(\"100%\") } .height(\"100%\") } } 循环控制 https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/arkts-rendering-control-foreach-0000001524537153-V2\nForEach( arr: Array, itemGenerator: (item: any, index: number) =\u003e void, keyGenerator?: (item: any, index: number) =\u003e string ) 在ForEach循环渲染过程中，系统会为每个数组元素生成一个唯一且持久的键值，用于标识对应的组件。当这个键值变化时，ArkUI框架将视为该数组元素已被替换或修改，并会基于新的键值创建一个新的组件。\nForEach提供了一个名为keyGenerator的参数，这是一个函数，开发者可以通过它自定义键值的生成规则。如果开发者没有定义keyGenerator函数，则ArkUI框架会使用默认的键值生成函数，即(item: any, index: number) =\u003e { return index + ‘__’ + JSON.stringify(item); }。\nArkUI框架对于ForEach的键值生成有一套特定的判断规则，这主要与itemGenerator函数的第二个参数index以及keyGenerator函数的第二个参数index有关，具体的键值生成规则判断逻辑如下图所示。\n以下是一个简单例子, 具体可以到官方文档查看\nclass Item { name: string image: string price: number discount: number constructor(name: string, image: string, price: number, discount: number = 0) { this.name = name this.image = image this.price = price this.discount = discount } } @Entry @Component struct Second { private items: Array\u003cItem\u003e = [ new Item(\"华为Mate1\", \"https://qiniu.waite.wang/202404182317729.png\", 1666, 1000), new Item(\"华为Mate2\", \"https://qiniu.waite.wang/202404182317729.png\", 1999), new Item(\"华为Mate3\", \"https://qiniu.waite.wang/202404182317729.png\", 2666), new Item(\"华为Mate4\", \"https://qiniu.waite.wang/202404182317729.png\", 2999), new Item(\"华为Mate5\", \"https://qiniu.waite.wang/202404182317729.png\", 3666), new Item(\"华为Mate6\", \"https://qiniu.waite.wang/202404182317729.png\", 3999), ] @State message: string = 'Hi there' build() { Column({ space: 10 }) { Row() { Text(\"商品列表\") .fontSize(30) .fontWeight(FontWeight.Bold) } .width(\"100%\") ForEach( this.items, (item: Item) =\u003e { Row({ space: 10 }) { Image(item.image) .width(100) Column() { Text(item.name) .fontSize(20) .fontWeight(FontWeight.Bold) if (item.discount) { Text(`原价$ ${item.price}`) .fontColor(\"#ccc\") .fontSize(18) .decoration({ type: TextDecorationType.LineThrough }) Text(`折扣价$ ${item.discount}`) .fontColor(\"red\") .fontSize(18) } else { Text(`$ ${item.price}`) .fontColor(\"red\") .fontSize(18) } } .height(\"100%\") .alignItems(HorizontalAlign.Start) } .width(\"100%\") .backgroundColor(\"#f8f8f8\") .borderRadius(20) .height(120) .padding(10) } ) } .padding(20) } } 注意 当不同数组项按照键值生成规则生成的键值相同时，框架的行为是未定义的。例如，在以下代码中，ForEach渲染相同的数据项two时，只创建了一个ChildItem组件，而没有创建多个具有相同键值的组件。\n@Entry @Component struct Parent { @State simpleList: Array\u003cstring\u003e = ['one', 'two', 'two', 'three']; build() { Row() { Column() { ForEach(this.simpleList, (item: string) =\u003e { ChildItem({ 'item': item } as Record\u003cstring, string\u003e) }, (item: string) =\u003e item) } .width('100%') .height('100%') } .height('100%') .backgroundColor(0xF1F3F5) } } @Component struct ChildItem { @Prop item: string; build() { Text(this.item) .fontSize(50) } } 补充: List/ ListItem 在以上案例中, 超出屏幕的内容无法滚动查看(会隐藏), 可以使用 List/ ListItem 组件来实现\n// xxx.ets @Entry @Component struct ListItemExample { private arr: number[] = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] @State editFlag: boolean = false build() { Column() { List({ space: 20, initialIndex: 0 }) { ForEach(this.arr, (item) =\u003e { ListItem() { Text('' + item) .width('100%').height(100).fontSize(16) .textAlign(TextAlign.Center).borderRadius(10).backgroundColor(0xFFFFFF) } }, item =\u003e item) } }.width('100%').height('100%').backgroundColor(0xDCDCDC).padding({ top: 5 }) } } ArkUI 自定义组件 自定义组件的基本结构 struct：自定义组件基于struct实现，struct + 自定义组件名 + {…}的组合构成自定义组件，不能有继承关系。对于struct的实例化，可以省略new。\n自定义组件名、类名、函数名不能和系统组件名相同。\n@Component：@Component装饰器仅能装饰struct关键字声明的数据结构。struct被@Component装饰后具备组件化的能力，需要实现build方法描述UI，一个struct只能被一个@Component装饰。\n从API version 9开始，该装饰器支持在ArkTS卡片中使用。\n@Component struct MyComponent { } build()函数：build()函数用于定义自定义组件的声明式UI描述，自定义组件必须定义build()函数。\n@Component struct MyComponent { build() { } } @Entry：@Entry装饰的自定义组件将作为UI页面的入口。在单个UI页面中，最多可以使用@Entry装饰一个自定义组件。@Entry可以接受一个可选的LocalStorage的参数。\n从API version 9开始，该装饰器支持在ArkTS卡片中使用。\n@Entry @Component struct MyComponent { } 自定义组件的基本用法 @Entry @Component struct ParentComponent { build() { Column() { Text('ArkUI message') HelloComponent({ message: 'Hello, World!' }); HelloComponent({ message: '你好!' }); } } } @Component struct HelloComponent { @State message: string = 'Hello, World!'; build() { // HelloComponent自定义组件组合系统组件Row和Text Row() { Text(this.message) .onClick(() =\u003e { // 状态变量message的改变驱动UI刷新，UI从'Hello, World!'刷新为'Hello, ArkUI!' this.message = 'Hello, ArkUI!'; }) } } } 如果在另外的文件中引用该自定义组件，需要使用export关键字导出，并在使用的页面import该自定义组件。\n@Component export struct HelloComponent { @State message: string = 'Hello, World!'; build() { // HelloComponent自定义组件组合系统组件Row和Text Row() { Text(this.message) .onClick(() =\u003e { // 状态变量message的改变驱动UI刷新，UI从'Hello, World!'刷新为'Hello, ArkUI!' this.message = 'Hello, ArkUI!'; }) } } } import { HelloComponent } from './HelloComponent' @Entry @Component struct ParentComponent { build() { Column() { Text('ArkUI message') HelloComponent({ message: 'Hello, World!' }); HelloComponent({ message: '你好!' }); } } } 自定义组件的参数规定 从上文的示例中，我们已经了解到，可以在build方法里创建自定义组件，在创建自定义组件的过程中，根据装饰器的规则来初始化自定义组件的参数。\n@Component struct MyComponent { private countDownFrom: number = 0; private color: Color = Color.Blue; build() { } } @Entry @Component struct ParentComponent { private someColor: Color = Color.Pink; build() { Column() { // 创建MyComponent实例，并将创建MyComponent成员变量countDownFrom初始化为10，将成员变量color初始化为this.someColor MyComponent({ countDownFrom: 10, color: this.someColor }) } } } build()函数 所有声明在build()函数的语言，我们统称为UI描述，UI描述需要遵循以下规则：\n@Entry装饰的自定义组件，其build()函数下的根节点唯一且必要，且必须为容器组件，其中ForEach禁止作为根节点。 @Component装饰的自定义组件，其build()函数下的根节点唯一且必要，可以为非容器组件，其中ForEach禁止作为根节点。 @Entry @Component struct MyComponent { build() { // 根节点唯一且必要，必须为容器组件 Row() { ChildComponent() } } } @Component struct ChildComponent { build() { // 根节点唯一且必要，可为非容器组件 Image('test.jpg') } } 不允许声明本地变量，反例如下。 build() { // 反例：不允许声明本地变量 let a: number = 1; } 不允许在UI描述里直接使用console.info，但允许在方法或者函数里使用，反例如下。 build() { // 反例：不允许console.info console.info('print debug log'); } 不允许创建本地的作用域，反例如下。 build() { // 反例：不允许本地作用域 { ... } } 不允许调用没有用@Builder装饰的方法，允许系统组件的参数是TS方法的返回值。 @Component struct ParentComponent { doSomeCalculations() { } calcTextValue(): string { return 'Hello World'; } @Builder doSomeRender() { Text(`Hello World`) } build() { Column() { // 反例：不能调用没有用@Builder装饰的方法 this.doSomeCalculations(); // 正例：可以调用 this.doSomeRender(); // 正例：参数可以为调用TS方法的返回值 Text(this.calcTextValue()) } } } 不允许switch语法，如果需要使用条件判断，请使用if。反例如下。 build() { Column() { // 反例：不允许使用switch语法 switch (expression) { case 1: Text('...') break; case 2: Image('...') break; default: Text('...') break; } } } 不允许使用表达式，反例如下。 build() { Column() { // 反例：不允许使用表达式 (this.aVar \u003e 10) ? Text('...') : Image('...') } } 自定义组件通用样式 自定义组件通过“.”链式调用的形式设置通用样式。\n@Component struct MyComponent2 { build() { Button(`Hello World`) } } @Entry @Component struct MyComponent { build() { Row() { MyComponent2() .width(200) .height(300) .backgroundColor(Color.Red) } } } ArkUI 入门 ArkTS语言 ArkTS是HarmonyOS优选的主力应用开发语言。ArkTS围绕应用开发在TypeScript（简称TS）生态基础上做了进一步扩展，继承了TS的所有特性，是TS的超集。因此，在学习ArkTS语言之前，建议开发者具备TS语言开发能力。\n当前，ArkTS在TS的基础上主要扩展了如下能力：\n基本语法：ArkTS定义了声明式UI描述、自定义组件和动态扩展UI元素的能力，再配合ArkUI开发框架中的系统组件及其相关的事件方法、属性方法等共同构成了UI开发的主体。 状态管理：ArkTS提供了多维度的状态管理机制。在UI开发框架中，与UI相关联的数据可以在组件内使用，也可以在不同组件层级间传递，比如父子组件之间、爷孙组件之间，还可以在应用全局范围内传递或跨设备传递。另外，从数据的传递形式来看，可分为只读的单向传递和可变更的双向传递。开发者可以灵活地利用这些能力来实现数据和UI的联动。 渲染控制：ArkTS提供了渲染控制的能力。条件渲染可根据应用的不同状态，渲染对应状态下的UI内容。循环渲染可从数据源中迭代获取数据，并在每次迭代过程中创建相应的组件。数据懒加载从数据源中按需迭代数据，并在每次迭代过程中创建相应的组件。 未来，ArkTS会结合应用开发/运行的需求持续演进，逐步提供并行和并发能力增强、系统类型增强、分布式开发范式等更多特性。\n基本语法 ArkTS 基本组成 自定义变量不能与基础通用属性/事件名重复。\n装饰器： 用于装饰类、结构、方法以及变量，并赋予其特殊的含义。如上述示例中@Entry、@Component和@State都是装饰器，@Component表示自定义组件，@Entry表示该自定义组件为入口组件，@State表示组件中的状态变量，状态变量变化会触发UI刷新。 UI描述：以声明式的方式来描述UI的结构，例如build()方法中的代码块。 自定义组件：可复用的UI单元，可组合其他组件，如上述被@Component装饰的struct Hello。 系统组件：ArkUI框架中默认内置的基础和容器组件，可直接被开发者调用，比如示例中的Column、Text、Divider、Button。 属性方法：组件可以通过链式调用配置多项属性，如fontSize()、width()、height()、backgroundColor()等。 事件方法：组件可以通过链式调用设置多个事件的响应逻辑，如跟随在Button后面的onClick()。 系统组件、属性方法、事件方法具体使用可参考基于ArkTS的声明式开发范式。 ","wordCount":"6823","inLanguage":"zh-cn","datePublished":"2024-03-23T16:04:23+08:00","dateModified":"2024-03-23T16:04:23+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://waite.wang/posts/harmony/learn-harmony-1/"},"publisher":{"@type":"Organization","name":"隶笔难书","logo":{"@type":"ImageObject","url":"https://waite.wang/images/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://waite.wang/ accesskey=h title="隶笔难书 (Alt + H)">隶笔难书</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://waite.wang/ title=首页><span>首页</span></a></li><li><a href=https://waite.wang/search title=搜索><span>搜索</span></a></li><li><a href=https://waite.wang/categories title=分类><span>分类</span></a></li><li><a href=https://waite.wang/tags title=标签><span>标签</span></a></li><li><a href=https://waite.wang/archives title=归档><span>归档</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">鸿蒙学习笔记1</h1><div class=post-meta>Created: &nbsp;<span title='2024-03-23 16:04:23 +0800 +0800'>2024-03-23</span>&nbsp;·&nbsp;14 min&nbsp;·&nbsp;6823 words&nbsp;|&nbsp;<a href=https://github.com/Waite0603/HugoBlog/edit/main/content/posts/harmony/learn-harmony-1.md rel="noopener noreferrer" target=_blank>在 GitHub 编辑</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e7%bc%96%e8%be%91%e5%99%a8%e5%ae%89%e8%a3%85 aria-label=编辑器安装>编辑器安装</a><ul><li><a href=#%e5%ae%89%e8%a3%85 aria-label=安装>安装</a></li><li><a href=#%e7%8e%af%e5%a2%83%e9%94%99%e8%af%af%e5%a4%84%e7%90%86 aria-label=环境错误处理>环境错误处理</a></li><li><a href=#%e4%b8%ad%e6%96%87%e8%ae%be%e7%bd%ae aria-label=中文设置>中文设置</a></li><li><a href=#%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae aria-label=创建项目>创建项目</a></li><li><a href=#%e6%a8%a1%e6%8b%9f%e5%99%a8%e5%ae%89%e8%a3%85 aria-label=模拟器安装>模拟器安装</a></li><li><a href=#stage-%e4%b8%8e-fa-%e6%a8%a1%e5%9e%8b%e7%9a%84%e5%8c%ba%e5%88%ab aria-label="Stage 与 FA 模型的区别">Stage 与 FA 模型的区别</a><ul><li><a href=#fa%e6%a8%a1%e5%9e%8b%e6%97%a9%e6%9c%9f%e7%9a%84%e6%8e%a2%e7%b4%a2 aria-label=FA模型：早期的探索>FA模型：早期的探索</a></li><li><a href=#stage%e6%a8%a1%e5%9e%8b%e6%9c%aa%e6%9d%a5%e7%9a%84%e4%b8%bb%e6%b5%81 aria-label=Stage模型：未来的主流>Stage模型：未来的主流</a></li></ul></li><li><a href=#stage%e6%a8%a1%e5%9e%8b%e7%9b%ae%e5%bd%95%e7%bb%93%e6%9e%84 aria-label=（Stage模型）目录结构>（Stage模型）目录结构</a></li></ul></li><li><a href=#arkui-%e7%bb%84%e4%bb%b6 aria-label="ArkUI 组件">ArkUI 组件</a><ul><li><a href=#%e5%9f%ba%e7%a1%80%e7%bb%84%e4%bb%b6 aria-label=基础组件>基础组件</a><ul><li><a href=#text aria-label=Text>Text</a></li><li><a href=#textinput aria-label=TextInput>TextInput</a></li><li><a href=#button aria-label=Button>Button</a></li><li><a href=#image aria-label=Image>Image</a><ul><li><a href=#%e4%bb%8e%e7%bd%91%e7%bb%9c%e5%8a%a0%e8%bd%bd%e5%9b%be%e7%89%87 aria-label=从网络加载图片>从网络加载图片</a></li><li><a href=#%e4%bb%8e%e6%9c%ac%e5%9c%b0%e5%8a%a0%e8%bd%bd aria-label=从本地加载>从本地加载</a></li></ul></li><li><a href=#slider aria-label=Slider>Slider</a></li></ul></li><li><a href=#%e5%ae%b9%e5%99%a8%e7%bb%84%e4%bb%b6 aria-label=容器组件>容器组件</a><ul><li><a href=#column aria-label=Column>Column</a></li><li><a href=#row aria-label=Row>Row</a></li></ul></li><li><a href=#%e6%a1%88%e4%be%8b aria-label=案例>案例</a></li><li><a href=#%e5%be%aa%e7%8e%af%e6%8e%a7%e5%88%b6 aria-label=循环控制>循环控制</a><ul><li><a href=#%e8%a1%a5%e5%85%85-list-listitem aria-label="补充: List/ ListItem">补充: List/ ListItem</a></li></ul></li></ul></li><li><a href=#arkui-%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6 aria-label="ArkUI 自定义组件">ArkUI 自定义组件</a><ul><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e7%9a%84%e5%9f%ba%e6%9c%ac%e7%bb%93%e6%9e%84 aria-label=自定义组件的基本结构>自定义组件的基本结构</a></li><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e7%9a%84%e5%9f%ba%e6%9c%ac%e7%94%a8%e6%b3%95 aria-label=自定义组件的基本用法>自定义组件的基本用法</a></li><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e7%9a%84%e5%8f%82%e6%95%b0%e8%a7%84%e5%ae%9a aria-label=自定义组件的参数规定>自定义组件的参数规定</a></li><li><a href=#build%e5%87%bd%e6%95%b0 aria-label=build()函数>build()函数</a></li><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e9%80%9a%e7%94%a8%e6%a0%b7%e5%bc%8f aria-label=自定义组件通用样式>自定义组件通用样式</a></li></ul></li><li><a href=#arkui-%e5%85%a5%e9%97%a8 aria-label="ArkUI 入门">ArkUI 入门</a><ul><li><a href=#arkts%e8%af%ad%e8%a8%80 aria-label=ArkTS语言>ArkTS语言</a></li><li><a href=#%e5%9f%ba%e6%9c%ac%e8%af%ad%e6%b3%95 aria-label=基本语法>基本语法</a><ul><li><a href=#arkts-%e5%9f%ba%e6%9c%ac%e7%bb%84%e6%88%90 aria-label="ArkTS 基本组成">ArkTS 基本组成</a></li></ul></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=编辑器安装>编辑器安装<a hidden class=anchor aria-hidden=true href=#编辑器安装>#</a></h2><h3 id=安装>安装<a hidden class=anchor aria-hidden=true href=#安装>#</a></h3><ol><li><a href=https://developer.huawei.com/consumer/cn/deveco-studio/#download target=_blank>下载安装包</a></li><li>正常安装包, 下一步安装</li></ol><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171217774.png><img src=https://qiniu.waite.wang/202404171217774.png alt=image-20240417121723826></a></div></p><ol start=3><li>配置开发环境</li></ol><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171218425.png><img src=https://qiniu.waite.wang/202404171218425.png alt=image-20240417121810196></a></div></p><p>选择 Agree, 进入配置选择页面, 选择不导入配置</p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171218109.png><img src=https://qiniu.waite.wang/202404171218109.png alt=image-20240417121841096></a></div></p><p>选择要安装的Node.is和hpm位置，其中ohpm是Open Harmony Package Management的缩写，也就是类似npm的包管理工具。这里有几点注意事项:</p><ul><li>如果电脑上已经有Node.js，但是版本不一致，建议选择让工具重新安装</li><li>如果电脑上已经有Node.js，并且版本一致，可以选择Local，指定node目录即可</li><li>如果电脑上对Node.is做了一些特殊的options配置，建议先移除</li><li>配置目录中不要出现中文、特殊字符，建议用默认路径</li></ul><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171219038.png><img src=https://qiniu.waite.wang/202404171219038.png alt=image-20240417121951184></a></div></p><p>选择Next后，进入HarmonyOs的SDK安装目录选择页面以及同意协议, 配置目录/ 同意协议后下一步即可</p><h3 id=环境错误处理>环境错误处理<a hidden class=anchor aria-hidden=true href=#环境错误处理>#</a></h3><p>在安装的过程中，如果出现类似下面的错误</p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171221142.png><img src=https://qiniu.waite.wang/202404171221142.png alt=image-20240417122147373></a></div></p><p>一般就是因为你本地原本的Node.is配置异常导致的，建议清理环境变量中对于Node.is的配置之后再重试
重试时无需重新安装，而是再次打开DevEco Studio，点击界面左下方的 ? 按钮: 选择第一个 Diagnose Development Environment 进入诊断页面, 这里会提示安装出现问题的选项，点击异常项后面的set it up now即可重新安装
如果所有问题都已经解决，最终重试后等待所有项都是 √即可</p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171222747.png><img src=https://qiniu.waite.wang/202404171222747.png alt=image-20240417122238577></a></div></p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171223032.png><img src=https://qiniu.waite.wang/202404171223032.png alt=image-20240417122305876></a></div></p><h3 id=中文设置>中文设置<a hidden class=anchor aria-hidden=true href=#中文设置>#</a></h3><p>设置->插件->已安装->其他工具->chinese->启用即可</p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171224670.png><img src=https://qiniu.waite.wang/202404171224670.png alt=image-20240417122439395></a></div></p><h3 id=创建项目>创建项目<a hidden class=anchor aria-hidden=true href=#创建项目>#</a></h3><p>Create Project -> Empty Ability -> 按要求填写目录即可</p><p>此时项目内已有 Hello World 基础代码, 点右侧预览器即可预览效果</p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171229268.png><img src=https://qiniu.waite.wang/202404171229268.png alt=image-20240417122904349></a></div></p><h3 id=模拟器安装>模拟器安装<a hidden class=anchor aria-hidden=true href=#模拟器安装>#</a></h3><p>我们也可以利用设备模拟器来查看更真实的效果。不过需要先配置模拟器</p><p>首先，选择主菜单中的Tools，找到其中的Device Manager，即设备管理</p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171229476.png><img src=https://qiniu.waite.wang/202404171229476.png alt=image-20240417122932610></a></div></p><p>设备可以是 远端设备 ，也可以是 本地设备 ，我们以本地设备为例。</p><p>默认本地没有任何设备，选择install来安装一个</p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171229123.png><img src=https://qiniu.waite.wang/202404171229123.png alt=image-20240417122953229></a></div></p><p>首次点击时，会弹出一个窗口，下载必要的SDK依赖, 安装完下一步即可</p><p>进入创建模拟器页面，选择New Emulator:</p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171230423.png><img src=https://qiniu.waite.wang/202404171230423.png alt=image-20240417123032281></a></div></p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171230731.png><img src=https://qiniu.waite.wang/202404171230731.png alt=image-20240417123043858></a></div></p><p>选择api9版本，不过需要注意，首次进入此页面，需要下载手机设备需要的系统，大概2.2G，需要耐心等待:</p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171231835.png><img src=https://qiniu.waite.wang/202404171231835.png alt=image-20240417123103057></a></div></p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171231885.png><img src=https://qiniu.waite.wang/202404171231885.png alt=image-20240417123115419></a></div></p><p>创建完成后，在设备列表中会出现一个本地设备，点击后面的运行按钮即可启动设备模拟器</p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171231949.png><img src=https://qiniu.waite.wang/202404171231949.png alt=image-20240417123136573></a></div></p><p>启动后如下</p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171231029.png><img src=https://qiniu.waite.wang/202404171231029.png alt=image-20240417123155182></a></div></p><p>然后，在应用启动位置选择刚刚添加的模拟器, 然后点击启动即可</p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171232015.png><img src=https://qiniu.waite.wang/202404171232015.png alt=image-20240417123220059></a></div></p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171232136.png><img src=https://qiniu.waite.wang/202404171232136.png alt=image-20240417123227197></a></div></p><p>效果如下</p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404171232051.png><img src=https://qiniu.waite.wang/202404171232051.png alt=image-20240417123240912></a></div></p><h3 id=stage-与-fa-模型的区别>Stage 与 FA 模型的区别<a hidden class=anchor aria-hidden=true href=#stage-与-fa-模型的区别>#</a></h3><h4 id=fa模型早期的探索>FA模型：早期的探索<a hidden class=anchor aria-hidden=true href=#fa模型早期的探索>#</a></h4><p>FA模型是HarmonyOS早期版本开始支持的应用模型。它通过PageAbility、ServiceAbility和DataAbility三种组件，为开发者提供了构建应用的基础。FA模型的特点是每个组件运行在自己的进程中，拥有独立的JS VM引擎实例，这使得组件之间相互隔离，但也带来了一定的内存占用。</p><p>随着HarmonyOS的演进，特别是1+8+N的战略被提出，多设备和多窗口形态成为主流，此时FA模型在处理复杂应用时存在一定的局限性， FA模型逐渐不再被主推。</p><h4 id=stage模型未来的主流>Stage模型：未来的主流<a hidden class=anchor aria-hidden=true href=#stage模型未来的主流>#</a></h4><p>为了更好地适应复杂应用的开发需求，HarmonyOS 3.1 Developer Preview版本引入了Stage模型。Stage模型通过AbilityStage、WindowStage等类，将应用组件和Window窗口作为“舞台”进行管理，从而提供了更加灵活和高效的开发方式。</p><p>Stage模型的设计出发点是为了复杂应用而设计，它通过以下几个方面实现了对复杂应用的优化：</p><ol><li><p>共享ArkTS引擎实例：在Stage模型中，多个应用组件共享同一个ArkTS引擎实例，这使得组件之间可以方便地共享对象和状态，同时减少了内存占用。</p></li><li><p>面向对象的开发方式：Stage模型采用面向对象的开发方式，提高了代码的可读性、易维护性和可扩展性。</p></li><li><p>支持多设备和多窗口形态：应用组件管理和窗口管理在架构层面解耦，使得应用组件可以在不同设备上使用同一套生命周期，便于系统扩展窗口形态。</p></li><li><p>平衡应用能力和系统管控成本：Stage模型重新定义了应用能力的边界，提供了特定场景的应用组件，规范化了后台进程管理，防止了恶意应用行为。</p></li></ol><h3 id=stage模型目录结构>（Stage模型）目录结构<a hidden class=anchor aria-hidden=true href=#stage模型目录结构>#</a></h3><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404181340550.png><img src=https://qiniu.waite.wang/202404181340550.png alt></a></div></p><ul><li>AppScope > app.json5：应用的全局配置信息。</li><li>entry：HarmonyOS工程模块，编译构建生成一个HAP包。<ul><li>src > main > ets：用于存放ArkTS源码。
src > main > ets > entryability：应用/服务的入口。</li><li>src > main > ets > pages：应用/服务包含的页面</li><li>src > main > resources：用于存放应用/服务所用到的资源文件，如图形、多媒体、字符串、布局文件等。关于资源文件，详见资源分类与访问。</li><li>src > main > module.json5：Stage模型模块配置文件。主要包含HAP包的配置信息、应用/服务在具体设备上的配置信息以及应用/服务的全局配置信息。具体的配置文件说明，详见
<a href=https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/module-configuration-file-0000001427744540-V2 target=_blank>module.json5配置文件</a>。</li><li>build-profile.json5：当前的模块信息、编译信息配置项，包括buildOption、targets配置等。其中targets中可配置当前运行环境，默认为HarmonyOS。</li><li>hvigorfile.ts：模块级编译构建任务脚本，开发者可以自定义相关任务和代码实现。</li></ul></li><li>oh_modules：用于存放三方库依赖信息。关于原npm工程适配ohpm操作，请参考历史工程迁移。</li><li>build-profile.json5：应用级配置信息，包括签名、产品配置等。</li><li>hvigorfile.ts：应用级编译构建任务脚本。</li></ul><h2 id=arkui-组件>ArkUI 组件<a hidden class=anchor aria-hidden=true href=#arkui-组件>#</a></h2><h3 id=基础组件>基础组件<a hidden class=anchor aria-hidden=true href=#基础组件>#</a></h3><h4 id=text>Text<a hidden class=anchor aria-hidden=true href=#text>#</a></h4><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404181859349.png><img src=https://qiniu.waite.wang/202404181859349.png alt></a></div></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=nx>Text</span><span class=p>(</span><span class=nx>$r</span><span class=p>(</span><span class=s2>&#34;app.string.module_desc&#34;</span><span class=p>))</span>
</span></span></code></pre></div><blockquote><p>文本会先在对应国家的资源文件中查找，如果没有找到，会在 base 全局资源文件中查找。</p></blockquote><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404181902495.png><img src=https://qiniu.waite.wang/202404181902495.png alt></a></div></p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404181903070.png><img src=https://qiniu.waite.wang/202404181903070.png alt></a></div></p><h4 id=textinput>TextInput<a hidden class=anchor aria-hidden=true href=#textinput>#</a></h4><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404182154723.png><img src=https://qiniu.waite.wang/202404182154723.png alt></a></div></p><h4 id=button>Button<a hidden class=anchor aria-hidden=true href=#button>#</a></h4><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404182156605.png><img src=https://qiniu.waite.wang/202404182156605.png alt></a></div></p><p>方法1： Button(options?: {type?: ButtonType, stateEffect?: boolean})</p><p>方法2： Button(label?: ResourceStr, options?: { type?: ButtonType, stateEffect?: boolean })</p><p>使用文本内容创建相应的按钮组件，此时Button无法包含子组件。</p><h4 id=image>Image<a hidden class=anchor aria-hidden=true href=#image>#</a></h4><p>图片组件，支持本地图片和网络图片的渲染展示。</p><blockquote><p>Image(src: string | PixelMap | Resource)
图片的数据源，支持本地图片和网络图片。当使用相对路径引用图片资源时，例如Image(&ldquo;common/test.jpg&rdquo;)，不支持该Image组件被跨包/跨模块调用，建议使用$r方式来管理需全局使用的图片资源。</p><ul><li>支持的图片格式包括png、jpg、bmp、svg和gif。</li><li>支持Base64字符串。格式data:image/[png|jpeg|bmp|webp];base64,[base64 data], 其中[base64 data]为Base64字符串数据。</li><li>支持dataability://路径前缀的字符串，用于访问通过data ability提供的图片路径。</li></ul></blockquote><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404181838112.png><img src=https://qiniu.waite.wang/202404181838112.png alt></a></div></p><h5 id=从网络加载图片>从网络加载图片<a hidden class=anchor aria-hidden=true href=#从网络加载图片>#</a></h5><p>使用网络图片时，需要申请权限ohos.permission.INTERNET。具体申请方式请参考
<a href=https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V3/accesstoken-guidelines-0000001333800609-V3#ZH-CN_TOPIC_0000001333800609__%E6%9D%83%E9%99%90%E7%94%B3%E8%AF%B7%E5%A3%B0%E6%98%8E target=_blank>权限申请声明</a>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=c1>// entry/src/main/module.json5
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;module&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;reqPermissions&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;ohos.permission.INTERNET&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>通过以下代码，可以加载网络图片：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=nx>Image</span><span class=p>(</span><span class=s2>&#34;https://example.com/image.jpg&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h5 id=从本地加载>从本地加载<a hidden class=anchor aria-hidden=true href=#从本地加载>#</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=nx>Image</span><span class=p>(</span><span class=nx>$r</span><span class=p>(</span><span class=s2>&#34;app.media.icon&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Image</span><span class=p>(</span><span class=nx>$rawfile</span><span class=p>(</span><span class=s2>&#34;abstract.png&#34;</span><span class=p>))</span>
</span></span></code></pre></div><h4 id=slider>Slider<a hidden class=anchor aria-hidden=true href=#slider>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=nx>Slider</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>min</span>: <span class=kt>0</span><span class=p>,</span> <span class=c1>// 最小值
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>max</span>: <span class=kt>100</span><span class=p>,</span> <span class=c1>// 最大值
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>value</span>: <span class=kt>40</span><span class=p>,</span> <span class=c1>// 当前值
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>step</span>: <span class=kt>10</span><span class=p>,</span> <span class=c1>// 步长
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>style</span>: <span class=kt>SliderStyle.InSet</span><span class=p>,</span> <span class=c1>// Outer Slider
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>direction</span>: <span class=kt>Axis.Horizontal</span><span class=p>,</span> <span class=c1>// 方向
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>reverse</span>: <span class=kt>false</span> <span class=c1>// 方向滑动
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>showTips</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span> <span class=c1>// 展示 value 百分比
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>.</span><span class=nx>margin</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>top</span>: <span class=kt>20</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span></code></pre></div><h3 id=容器组件>容器组件<a hidden class=anchor aria-hidden=true href=#容器组件>#</a></h3><p><a href=https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V3/arkui-ts-container-components-0000001334734185-V3 target=_blank>https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V3/arkui-ts-container-components-0000001334734185-V3</a></p><h4 id=column>Column<a hidden class=anchor aria-hidden=true href=#column>#</a></h4><p>沿垂直方向布局的容器。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kd>@Entry</span>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>ColumnExample</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>        <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;space&#39;</span><span class=p>).</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>9</span><span class=p>).</span><span class=nx>fontColor</span><span class=p>(</span><span class=mh>0xCCCCCC</span><span class=p>).</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>Column</span><span class=p>({</span> <span class=nx>space</span>: <span class=kt>5</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>Column</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;100%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>30</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0xAFEEEE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nx>Column</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;100%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>30</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0x00FFFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}.</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>100</span><span class=p>).</span><span class=nx>border</span><span class=p>({</span> <span class=nx>width</span>: <span class=kt>1</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;alignItems(Start)&#39;</span><span class=p>).</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>9</span><span class=p>).</span><span class=nx>fontColor</span><span class=p>(</span><span class=mh>0xCCCCCC</span><span class=p>).</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>          <span class=nx>Column</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;50%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>30</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0xAFEEEE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nx>Column</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;50%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>30</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0x00FFFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}.</span><span class=nx>alignItems</span><span class=p>(</span><span class=nx>HorizontalAlign</span><span class=p>.</span><span class=nx>Start</span><span class=p>).</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>).</span><span class=nx>border</span><span class=p>({</span> <span class=nx>width</span>: <span class=kt>1</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;alignItems(End)&#39;</span><span class=p>).</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>9</span><span class=p>).</span><span class=nx>fontColor</span><span class=p>(</span><span class=mh>0xCCCCCC</span><span class=p>).</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>          <span class=nx>Column</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;50%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>30</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0xAFEEEE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nx>Column</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;50%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>30</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0x00FFFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}.</span><span class=nx>alignItems</span><span class=p>(</span><span class=nx>HorizontalAlign</span><span class=p>.</span><span class=nx>End</span><span class=p>).</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>).</span><span class=nx>border</span><span class=p>({</span> <span class=nx>width</span>: <span class=kt>1</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;justifyContent(Center)&#39;</span><span class=p>).</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>9</span><span class=p>).</span><span class=nx>fontColor</span><span class=p>(</span><span class=mh>0xCCCCCC</span><span class=p>).</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>          <span class=nx>Column</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;30%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>30</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0xAFEEEE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nx>Column</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;30%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>30</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0x00FFFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}.</span><span class=nx>height</span><span class=p>(</span><span class=s1>&#39;15%&#39;</span><span class=p>).</span><span class=nx>border</span><span class=p>({</span> <span class=nx>width</span>: <span class=kt>1</span> <span class=p>}).</span><span class=nx>justifyContent</span><span class=p>(</span><span class=nx>FlexAlign</span><span class=p>.</span><span class=nx>Center</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;justifyContent(End)&#39;</span><span class=p>).</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>9</span><span class=p>).</span><span class=nx>fontColor</span><span class=p>(</span><span class=mh>0xCCCCCC</span><span class=p>).</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>          <span class=nx>Column</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;30%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>30</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0xAFEEEE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nx>Column</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;30%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>30</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0x00FFFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}.</span><span class=nx>height</span><span class=p>(</span><span class=s1>&#39;15%&#39;</span><span class=p>).</span><span class=nx>border</span><span class=p>({</span> <span class=nx>width</span>: <span class=kt>1</span> <span class=p>}).</span><span class=nx>justifyContent</span><span class=p>(</span><span class=nx>FlexAlign</span><span class=p>.</span><span class=nx>End</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}.</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;100%&#39;</span><span class=p>).</span><span class=nx>padding</span><span class=p>({</span> <span class=nx>top</span>: <span class=kt>5</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404182315467.png><img src=https://qiniu.waite.wang/202404182315467.png alt></a></div></p><h4 id=row>Row<a hidden class=anchor aria-hidden=true href=#row>#</a></h4><p>沿水平方向布局容器。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=c1>// xxx.ets
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>@Entry</span>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>RowExample</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=nx>Column</span><span class=p>({</span> <span class=nx>space</span>: <span class=kt>5</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;space&#39;</span><span class=p>).</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>9</span><span class=p>).</span><span class=nx>fontColor</span><span class=p>(</span><span class=mh>0xCCCCCC</span><span class=p>).</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>Row</span><span class=p>({</span> <span class=nx>space</span>: <span class=kt>5</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>Row</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;30%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>50</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0xAFEEEE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nx>Row</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;30%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>50</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0x00FFFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}.</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>107</span><span class=p>).</span><span class=nx>border</span><span class=p>({</span> <span class=nx>width</span>: <span class=kt>1</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;alignItems(Top)&#39;</span><span class=p>).</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>9</span><span class=p>).</span><span class=nx>fontColor</span><span class=p>(</span><span class=mh>0xCCCCCC</span><span class=p>).</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>Row() {</span>
</span></span><span class=line><span class=cl>          <span class=nx>Row</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;30%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>50</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0xAFEEEE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nx>Row</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;30%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>50</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0x00FFFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}.</span><span class=nx>alignItems</span><span class=p>(</span><span class=nx>VerticalAlign</span><span class=p>.</span><span class=nx>Top</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=s1>&#39;15%&#39;</span><span class=p>).</span><span class=nx>border</span><span class=p>({</span> <span class=nx>width</span>: <span class=kt>1</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;alignItems(Center)&#39;</span><span class=p>).</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>9</span><span class=p>).</span><span class=nx>fontColor</span><span class=p>(</span><span class=mh>0xCCCCCC</span><span class=p>).</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>Row() {</span>
</span></span><span class=line><span class=cl>          <span class=nx>Row</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;30%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>50</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0xAFEEEE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nx>Row</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;30%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>50</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0x00FFFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}.</span><span class=nx>alignItems</span><span class=p>(</span><span class=nx>VerticalAlign</span><span class=p>.</span><span class=nx>Center</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=s1>&#39;15%&#39;</span><span class=p>).</span><span class=nx>border</span><span class=p>({</span> <span class=nx>width</span>: <span class=kt>1</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;justifyContent(End)&#39;</span><span class=p>).</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>9</span><span class=p>).</span><span class=nx>fontColor</span><span class=p>(</span><span class=mh>0xCCCCCC</span><span class=p>).</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>Row() {</span>
</span></span><span class=line><span class=cl>          <span class=nx>Row</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;30%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>50</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0xAFEEEE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nx>Row</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;30%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>50</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0x00FFFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}.</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>).</span><span class=nx>border</span><span class=p>({</span> <span class=nx>width</span>: <span class=kt>1</span> <span class=p>}).</span><span class=nx>justifyContent</span><span class=p>(</span><span class=nx>FlexAlign</span><span class=p>.</span><span class=nx>End</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;justifyContent(Center)&#39;</span><span class=p>).</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>9</span><span class=p>).</span><span class=nx>fontColor</span><span class=p>(</span><span class=mh>0xCCCCCC</span><span class=p>).</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>Row() {</span>
</span></span><span class=line><span class=cl>          <span class=nx>Row</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;30%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>50</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0xAFEEEE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nx>Row</span><span class=p>().</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;30%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>50</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0x00FFFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}.</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;90%&#39;</span><span class=p>).</span><span class=nx>border</span><span class=p>({</span> <span class=nx>width</span>: <span class=kt>1</span> <span class=p>}).</span><span class=nx>justifyContent</span><span class=p>(</span><span class=nx>FlexAlign</span><span class=p>.</span><span class=nx>Center</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}.</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;100%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404182315827.png><img src=https://qiniu.waite.wang/202404182315827.png alt></a></div></p><h3 id=案例>案例<a hidden class=anchor aria-hidden=true href=#案例>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=c1>// xxx.ets
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>@Entry</span>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>Index</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>@State</span> <span class=nx>imgWidth</span>: <span class=kt>number</span> <span class=o>=</span> <span class=mi>30</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=nx>Row() {</span>
</span></span><span class=line><span class=cl>      <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>        <span class=nx>Image</span><span class=p>(</span><span class=nx>$r</span><span class=p>(</span><span class=s2>&#34;app.media.icon&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=nx>width</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>imgWidth</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=nx>interpolation</span><span class=p>(</span><span class=nx>ImageInterpolation</span><span class=p>.</span><span class=nx>High</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>Text</span><span class=p>(</span><span class=sb>`图片宽度: </span><span class=si>${</span><span class=k>this</span><span class=p>.</span><span class=nx>imgWidth</span><span class=si>}</span><span class=sb>`</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=nx>margin</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>TextInput</span><span class=p>({</span>
</span></span><span class=line><span class=cl>          <span class=nx>placeholder</span><span class=o>:</span> <span class=s2>&#34;请输入图片宽度&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>text</span>: <span class=kt>this.imgWidth.toString</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=nx>width</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=kr>type</span><span class=p>(</span><span class=nx>InputType</span><span class=p>.</span><span class=nb>Number</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=nx>onChange</span><span class=p>(</span><span class=nx>value</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>imgWidth</span> <span class=o>=</span> <span class=nb>parseInt</span><span class=p>(</span><span class=nx>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=nx>Row() {</span>
</span></span><span class=line><span class=cl>          <span class=nx>Button</span><span class=p>(</span><span class=s2>&#34;缩小&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>width</span><span class=p>(</span><span class=mi>80</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>onClick</span><span class=p>(()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>imgWidth</span> <span class=o>&gt;=</span> <span class=mi>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>imgWidth</span> <span class=o>-=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          <span class=nx>Button</span><span class=p>(</span><span class=s2>&#34;放大&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>width</span><span class=p>(</span><span class=mi>80</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>onClick</span><span class=p>(()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>imgWidth</span> <span class=o>&lt;=</span> <span class=mi>300</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>imgWidth</span> <span class=o>+=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nx>margin</span><span class=p>({</span>
</span></span><span class=line><span class=cl>          <span class=nx>top</span>: <span class=kt>20</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>Slider</span><span class=p>({</span>
</span></span><span class=line><span class=cl>          <span class=nx>min</span>: <span class=kt>0</span><span class=p>,</span> <span class=c1>// 最小值
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=nx>max</span>: <span class=kt>100</span><span class=p>,</span> <span class=c1>// 最大值
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=nx>value</span>: <span class=kt>40</span><span class=p>,</span> <span class=c1>// 当前值
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=nx>step</span>: <span class=kt>10</span><span class=p>,</span> <span class=c1>// 步长
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=nx>style</span>: <span class=kt>SliderStyle.InSet</span><span class=p>,</span> <span class=c1>// Outer Slider
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=nx>direction</span>: <span class=kt>Axis.Horizontal</span><span class=p>,</span> <span class=c1>// 方向
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=nx>reverse</span>: <span class=kt>false</span> <span class=c1>// 方向滑动
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>})</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=nx>showTips</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span> <span class=c1>// 展示 value 百分比
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=p>.</span><span class=nx>margin</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>top</span>: <span class=kt>20</span>
</span></span><span class=line><span class=cl>          <span class=p>})</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=nx>width</span><span class=p>(</span><span class=s2>&#34;80%&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>width</span><span class=p>(</span><span class=s2>&#34;100%&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>height</span><span class=p>(</span><span class=s2>&#34;100%&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404182317729.png><img src=https://qiniu.waite.wang/202404182317729.png alt></a></div></p><h3 id=循环控制>循环控制<a hidden class=anchor aria-hidden=true href=#循环控制>#</a></h3><p><a href=https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/arkts-rendering-control-foreach-0000001524537153-V2 target=_blank>https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/arkts-rendering-control-foreach-0000001524537153-V2</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=nx>ForEach</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=nx>arr</span>: <span class=kt>Array</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>itemGenerator</span><span class=o>:</span> <span class=p>(</span><span class=nx>item</span>: <span class=kt>any</span><span class=p>,</span> <span class=nx>index</span>: <span class=kt>number</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=k>void</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>keyGenerator</span><span class=o>?:</span> <span class=p>(</span><span class=nx>item</span>: <span class=kt>any</span><span class=p>,</span> <span class=nx>index</span>: <span class=kt>number</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><p>在ForEach循环渲染过程中，系统会为每个数组元素生成一个唯一且持久的键值，用于标识对应的组件。当这个键值变化时，ArkUI框架将视为该数组元素已被替换或修改，并会基于新的键值创建一个新的组件。</p><p>ForEach提供了一个名为keyGenerator的参数，这是一个函数，开发者可以通过它自定义键值的生成规则。如果开发者没有定义keyGenerator函数，则ArkUI框架会使用默认的键值生成函数，即(item: any, index: number) => { return index + &lsquo;__&rsquo; + JSON.stringify(item); }。</p><p>ArkUI框架对于ForEach的键值生成有一套特定的判断规则，这主要与itemGenerator函数的第二个参数index以及keyGenerator函数的第二个参数index有关，具体的键值生成规则判断逻辑如下图所示。</p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404191757732.png><img src=https://qiniu.waite.wang/202404191757732.png alt></a></div></p><blockquote><p>以下是一个简单例子, 具体可以到官方文档查看</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kr>class</span> <span class=nx>Item</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span>: <span class=kt>string</span>
</span></span><span class=line><span class=cl>  <span class=nx>image</span>: <span class=kt>string</span>
</span></span><span class=line><span class=cl>  <span class=nx>price</span>: <span class=kt>number</span>
</span></span><span class=line><span class=cl>  <span class=nx>discount</span>: <span class=kt>number</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>constructor</span><span class=p>(</span><span class=nx>name</span>: <span class=kt>string</span><span class=p>,</span> <span class=nx>image</span>: <span class=kt>string</span><span class=p>,</span> <span class=nx>price</span>: <span class=kt>number</span><span class=p>,</span> <span class=nx>discount</span>: <span class=kt>number</span> <span class=o>=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=nx>name</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>image</span> <span class=o>=</span> <span class=nx>image</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>price</span> <span class=o>=</span> <span class=nx>price</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>discount</span> <span class=o>=</span> <span class=nx>discount</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>@Entry</span>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>Second</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>items</span>: <span class=kt>Array</span><span class=p>&lt;</span><span class=nt>Item</span><span class=p>&gt;</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=nx>Item</span><span class=p>(</span><span class=s2>&#34;华为Mate1&#34;</span><span class=p>,</span> <span class=s2>&#34;https://qiniu.waite.wang/202404182317729.png&#34;</span><span class=p>,</span> <span class=mi>1666</span><span class=p>,</span> <span class=mi>1000</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=nx>Item</span><span class=p>(</span><span class=s2>&#34;华为Mate2&#34;</span><span class=p>,</span> <span class=s2>&#34;https://qiniu.waite.wang/202404182317729.png&#34;</span><span class=p>,</span> <span class=mi>1999</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=nx>Item</span><span class=p>(</span><span class=s2>&#34;华为Mate3&#34;</span><span class=p>,</span> <span class=s2>&#34;https://qiniu.waite.wang/202404182317729.png&#34;</span><span class=p>,</span> <span class=mi>2666</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=nx>Item</span><span class=p>(</span><span class=s2>&#34;华为Mate4&#34;</span><span class=p>,</span> <span class=s2>&#34;https://qiniu.waite.wang/202404182317729.png&#34;</span><span class=p>,</span> <span class=mi>2999</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=nx>Item</span><span class=p>(</span><span class=s2>&#34;华为Mate5&#34;</span><span class=p>,</span> <span class=s2>&#34;https://qiniu.waite.wang/202404182317729.png&#34;</span><span class=p>,</span> <span class=mi>3666</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=nx>Item</span><span class=p>(</span><span class=s2>&#34;华为Mate6&#34;</span><span class=p>,</span> <span class=s2>&#34;https://qiniu.waite.wang/202404182317729.png&#34;</span><span class=p>,</span> <span class=mi>3999</span><span class=p>),</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=kd>@State</span> <span class=nx>message</span>: <span class=kt>string</span> <span class=o>=</span> <span class=s1>&#39;Hi there&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=nx>Column</span><span class=p>({</span> <span class=nx>space</span>: <span class=kt>10</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>Row() {</span>
</span></span><span class=line><span class=cl>        <span class=nx>Text</span><span class=p>(</span><span class=s2>&#34;商品列表&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=nx>fontWeight</span><span class=p>(</span><span class=nx>FontWeight</span><span class=p>.</span><span class=nx>Bold</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>width</span><span class=p>(</span><span class=s2>&#34;100%&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>ForEach</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>items</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nx>item</span>: <span class=kt>Item</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>Row</span><span class=p>({</span> <span class=nx>space</span>: <span class=kt>10</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>Image</span><span class=p>(</span><span class=nx>item</span><span class=p>.</span><span class=nx>image</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>.</span><span class=nx>width</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>              <span class=nx>Text</span><span class=p>(</span><span class=nx>item</span><span class=p>.</span><span class=nx>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>.</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>.</span><span class=nx>fontWeight</span><span class=p>(</span><span class=nx>FontWeight</span><span class=p>.</span><span class=nx>Bold</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>              <span class=k>if</span> <span class=p>(</span><span class=nx>item</span><span class=p>.</span><span class=nx>discount</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>Text</span><span class=p>(</span><span class=sb>`原价$ </span><span class=si>${</span><span class=nx>item</span><span class=p>.</span><span class=nx>price</span><span class=si>}</span><span class=sb>`</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=p>.</span><span class=nx>fontColor</span><span class=p>(</span><span class=s2>&#34;#ccc&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=p>.</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=p>.</span><span class=nx>decoration</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=kr>type</span><span class=o>:</span> <span class=nx>TextDecorationType</span><span class=p>.</span><span class=nx>LineThrough</span>
</span></span><span class=line><span class=cl>                  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=nx>Text</span><span class=p>(</span><span class=sb>`折扣价$ </span><span class=si>${</span><span class=nx>item</span><span class=p>.</span><span class=nx>discount</span><span class=si>}</span><span class=sb>`</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=p>.</span><span class=nx>fontColor</span><span class=p>(</span><span class=s2>&#34;red&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=p>.</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span>
</span></span><span class=line><span class=cl>              <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>Text</span><span class=p>(</span><span class=sb>`$ </span><span class=si>${</span><span class=nx>item</span><span class=p>.</span><span class=nx>price</span><span class=si>}</span><span class=sb>`</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=p>.</span><span class=nx>fontColor</span><span class=p>(</span><span class=s2>&#34;red&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=p>.</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>height</span><span class=p>(</span><span class=s2>&#34;100%&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>alignItems</span><span class=p>(</span><span class=nx>HorizontalAlign</span><span class=p>.</span><span class=nx>Start</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=nx>width</span><span class=p>(</span><span class=s2>&#34;100%&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=s2>&#34;#f8f8f8&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=nx>borderRadius</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=nx>height</span><span class=p>(</span><span class=mi>120</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>.</span><span class=nx>padding</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>padding</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404191800166.png><img src=https://qiniu.waite.wang/202404191800166.png alt></a></div></p><blockquote><p>注意 当不同数组项按照键值生成规则生成的键值相同时，框架的行为是未定义的。例如，在以下代码中，ForEach渲染相同的数据项two时，只创建了一个ChildItem组件，而没有创建多个具有相同键值的组件。</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kd>@Entry</span>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>Parent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>@State</span> <span class=nx>simpleList</span>: <span class=kt>Array</span><span class=p>&lt;</span><span class=nt>string</span><span class=p>&gt;</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;one&#39;</span><span class=p>,</span> <span class=s1>&#39;two&#39;</span><span class=p>,</span> <span class=s1>&#39;two&#39;</span><span class=p>,</span> <span class=s1>&#39;three&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=nx>Row() {</span>
</span></span><span class=line><span class=cl>      <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>        <span class=nx>ForEach</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>simpleList</span><span class=p>,</span> <span class=p>(</span><span class=nx>item</span>: <span class=kt>string</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>ChildItem</span><span class=p>({</span> <span class=s1>&#39;item&#39;</span><span class=o>:</span> <span class=nx>item</span> <span class=p>}</span> <span class=kr>as</span> <span class=nx>Record</span><span class=p>&lt;</span><span class=nt>string</span><span class=p>,</span> <span class=na>string</span><span class=p>&gt;)</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span> <span class=p>(</span><span class=nx>item</span>: <span class=kt>string</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=nx>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;100%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>height</span><span class=p>(</span><span class=s1>&#39;100%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>height</span><span class=p>(</span><span class=s1>&#39;100%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0xF1F3F5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>ChildItem</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>@Prop</span> <span class=nx>item</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=nx>Text</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404191801029.png><img src=https://qiniu.waite.wang/202404191801029.png alt></a></div></p><h4 id=补充-list-listitem>补充: List/ ListItem<a hidden class=anchor aria-hidden=true href=#补充-list-listitem>#</a></h4><blockquote><p>在以上案例中, 超出屏幕的内容无法滚动查看(会隐藏), 可以使用 List/ ListItem 组件来实现</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=c1>// xxx.ets
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>@Entry</span>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>ListItemExample</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>arr</span>: <span class=kt>number</span><span class=p>[]</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=kd>@State</span> <span class=nx>editFlag</span>: <span class=kt>boolean</span> <span class=o>=</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>      <span class=nx>List</span><span class=p>({</span> <span class=nx>space</span>: <span class=kt>20</span><span class=p>,</span> <span class=nx>initialIndex</span>: <span class=kt>0</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>ForEach</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>arr</span><span class=p>,</span> <span class=p>(</span><span class=nx>item</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>ListItem() {</span>
</span></span><span class=line><span class=cl>            <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;&#39;</span> <span class=o>+</span> <span class=nx>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>.</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;100%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=mi>100</span><span class=p>).</span><span class=nx>fontSize</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>.</span><span class=nx>textAlign</span><span class=p>(</span><span class=nx>TextAlign</span><span class=p>.</span><span class=nx>Center</span><span class=p>).</span><span class=nx>borderRadius</span><span class=p>(</span><span class=mi>10</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0xFFFFFF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span> <span class=nx>item</span> <span class=o>=&gt;</span> <span class=nx>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}.</span><span class=nx>width</span><span class=p>(</span><span class=s1>&#39;100%&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(</span><span class=s1>&#39;100%&#39;</span><span class=p>).</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=mh>0xDCDCDC</span><span class=p>).</span><span class=nx>padding</span><span class=p>({</span> <span class=nx>top</span>: <span class=kt>5</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404201343460.png><img src=https://qiniu.waite.wang/202404201343460.png alt></a></div></p><h2 id=arkui-自定义组件>ArkUI 自定义组件<a hidden class=anchor aria-hidden=true href=#arkui-自定义组件>#</a></h2><h3 id=自定义组件的基本结构>自定义组件的基本结构<a hidden class=anchor aria-hidden=true href=#自定义组件的基本结构>#</a></h3><p>struct：自定义组件基于struct实现，struct + 自定义组件名 + {&mldr;}的组合构成自定义组件，不能有继承关系。对于struct的实例化，可以省略new。</p><blockquote><p>自定义组件名、类名、函数名不能和系统组件名相同。</p></blockquote><p>@Component：@Component装饰器仅能装饰struct关键字声明的数据结构。struct被@Component装饰后具备组件化的能力，需要实现build方法描述UI，一个struct只能被一个@Component装饰。</p><blockquote><p>从API version 9开始，该装饰器支持在ArkTS卡片中使用。</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>MyComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>build()函数：build()函数用于定义自定义组件的声明式UI描述，自定义组件必须定义build()函数。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>MyComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>@Entry：@Entry装饰的自定义组件将作为UI页面的入口。在单个UI页面中，最多可以使用@Entry装饰一个自定义组件。@Entry可以接受一个可选的LocalStorage的参数。</p><blockquote><p>从API version 9开始，该装饰器支持在ArkTS卡片中使用。</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kd>@Entry</span>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>MyComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=自定义组件的基本用法>自定义组件的基本用法<a hidden class=anchor aria-hidden=true href=#自定义组件的基本用法>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kd>@Entry</span>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>ParentComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>      <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;ArkUI message&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nx>HelloComponent</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;Hello, World!&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=nx>HelloComponent</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;你好!&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>HelloComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>@State</span> <span class=nx>message</span>: <span class=kt>string</span> <span class=o>=</span> <span class=s1>&#39;Hello, World!&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=c1>// HelloComponent自定义组件组合系统组件Row和Text
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>Row() {</span>
</span></span><span class=line><span class=cl>      <span class=nx>Text</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nx>onClick</span><span class=p>(()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=c1>// 状态变量message的改变驱动UI刷新，UI从&#39;Hello, World!&#39;刷新为&#39;Hello, ArkUI!&#39;
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=k>this</span><span class=p>.</span><span class=nx>message</span> <span class=o>=</span> <span class=s1>&#39;Hello, ArkUI!&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><blockquote><p>如果在另外的文件中引用该自定义组件，需要使用export关键字导出，并在使用的页面import该自定义组件。</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=nx>struct</span> <span class=nx>HelloComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>@State</span> <span class=nx>message</span>: <span class=kt>string</span> <span class=o>=</span> <span class=s1>&#39;Hello, World!&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=c1>// HelloComponent自定义组件组合系统组件Row和Text
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>Row() {</span>
</span></span><span class=line><span class=cl>      <span class=nx>Text</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nx>onClick</span><span class=p>(()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=c1>// 状态变量message的改变驱动UI刷新，UI从&#39;Hello, World!&#39;刷新为&#39;Hello, ArkUI!&#39;
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=k>this</span><span class=p>.</span><span class=nx>message</span> <span class=o>=</span> <span class=s1>&#39;Hello, ArkUI!&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>HelloComponent</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;./HelloComponent&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>@Entry</span>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>ParentComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>      <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;ArkUI message&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nx>HelloComponent</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;Hello, World!&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=nx>HelloComponent</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;你好!&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=自定义组件的参数规定>自定义组件的参数规定<a hidden class=anchor aria-hidden=true href=#自定义组件的参数规定>#</a></h3><p>从上文的示例中，我们已经了解到，可以在build方法里创建自定义组件，在创建自定义组件的过程中，根据装饰器的规则来初始化自定义组件的参数。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>MyComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>countDownFrom</span>: <span class=kt>number</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>color</span>: <span class=kt>Color</span> <span class=o>=</span> <span class=nx>Color</span><span class=p>.</span><span class=nx>Blue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>@Entry</span>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>ParentComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>someColor</span>: <span class=kt>Color</span> <span class=o>=</span> <span class=nx>Color</span><span class=p>.</span><span class=nx>Pink</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 创建MyComponent实例，并将创建MyComponent成员变量countDownFrom初始化为10，将成员变量color初始化为this.someColor
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>MyComponent</span><span class=p>({</span> <span class=nx>countDownFrom</span>: <span class=kt>10</span><span class=p>,</span> <span class=nx>color</span>: <span class=kt>this.someColor</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=build函数>build()函数<a hidden class=anchor aria-hidden=true href=#build函数>#</a></h3><p>所有声明在build()函数的语言，我们统称为UI描述，UI描述需要遵循以下规则：</p><ul><li>@Entry装饰的自定义组件，其build()函数下的根节点唯一且必要，且必须为容器组件，其中ForEach禁止作为根节点。</li><li>@Component装饰的自定义组件，其build()函数下的根节点唯一且必要，可以为非容器组件，其中ForEach禁止作为根节点。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kd>@Entry</span>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>MyComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 根节点唯一且必要，必须为容器组件
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>Row() {</span>
</span></span><span class=line><span class=cl>      <span class=nx>ChildComponent</span><span class=p>()</span> 
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>ChildComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 根节点唯一且必要，可为非容器组件
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>Image</span><span class=p>(</span><span class=s1>&#39;test.jpg&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>不允许声明本地变量，反例如下。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=nx>build() {</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 反例：不允许声明本地变量
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>let</span> <span class=nx>a</span>: <span class=kt>number</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>不允许在UI描述里直接使用console.info，但允许在方法或者函数里使用，反例如下。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=nx>build() {</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 反例：不允许console.info
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>console</span><span class=p>.</span><span class=nx>info</span><span class=p>(</span><span class=s1>&#39;print debug log&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>不允许创建本地的作用域，反例如下。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=nx>build() {</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 反例：不允许本地作用域
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>不允许调用没有用@Builder装饰的方法，允许系统组件的参数是TS方法的返回值。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>ParentComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>doSomeCalculations() {</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>calcTextValue</span><span class=p>()</span><span class=o>:</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;Hello World&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>@Builder</span> <span class=nx>doSomeRender() {</span>
</span></span><span class=line><span class=cl>    <span class=nx>Text</span><span class=p>(</span><span class=sb>`Hello World`</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 反例：不能调用没有用@Builder装饰的方法
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>this</span><span class=p>.</span><span class=nx>doSomeCalculations</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 正例：可以调用
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>this</span><span class=p>.</span><span class=nx>doSomeRender</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 正例：参数可以为调用TS方法的返回值
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>Text</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>calcTextValue</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>不允许switch语法，如果需要使用条件判断，请使用if。反例如下。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=nx>build() {</span>
</span></span><span class=line><span class=cl>  <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 反例：不允许使用switch语法
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>switch</span> <span class=p>(</span><span class=nx>expression</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>case</span> <span class=nx>1</span>:
</span></span><span class=line><span class=cl>        <span class=kt>Text</span><span class=p>(</span><span class=s1>&#39;...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>case</span> <span class=nx>2</span>:
</span></span><span class=line><span class=cl>        <span class=kt>Image</span><span class=p>(</span><span class=s1>&#39;...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>        <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>不允许使用表达式，反例如下。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=nx>build() {</span>
</span></span><span class=line><span class=cl>  <span class=nx>Column() {</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 反例：不允许使用表达式
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>aVar</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>)</span> <span class=o>?</span> <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;...&#39;</span><span class=p>)</span> <span class=o>:</span> <span class=nx>Image</span><span class=p>(</span><span class=s1>&#39;...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=自定义组件通用样式>自定义组件通用样式<a hidden class=anchor aria-hidden=true href=#自定义组件通用样式>#</a></h3><p>自定义组件通过“.”链式调用的形式设置通用样式。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>MyComponent2</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=nx>Button</span><span class=p>(</span><span class=sb>`Hello World`</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>@Entry</span>
</span></span><span class=line><span class=cl><span class=kd>@Component</span>
</span></span><span class=line><span class=cl><span class=nx>struct</span> <span class=nx>MyComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>build() {</span>
</span></span><span class=line><span class=cl>    <span class=nx>Row() {</span>
</span></span><span class=line><span class=cl>      <span class=nx>MyComponent2</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nx>width</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nx>height</span><span class=p>(</span><span class=mi>300</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=nx>backgroundColor</span><span class=p>(</span><span class=nx>Color</span><span class=p>.</span><span class=nx>Red</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=arkui-入门>ArkUI 入门<a hidden class=anchor aria-hidden=true href=#arkui-入门>#</a></h2><h3 id=arkts语言>ArkTS语言<a hidden class=anchor aria-hidden=true href=#arkts语言>#</a></h3><p>ArkTS是HarmonyOS优选的主力应用开发语言。ArkTS围绕应用开发在TypeScript（简称TS）生态基础上做了进一步扩展，继承了TS的所有特性，是TS的超集。因此，在学习ArkTS语言之前，建议开发者具备TS语言开发能力。</p><p>当前，ArkTS在TS的基础上主要扩展了如下能力：</p><ul><li>基本语法：ArkTS定义了声明式UI描述、自定义组件和动态扩展UI元素的能力，再配合ArkUI开发框架中的系统组件及其相关的事件方法、属性方法等共同构成了UI开发的主体。</li><li>状态管理：ArkTS提供了多维度的状态管理机制。在UI开发框架中，与UI相关联的数据可以在组件内使用，也可以在不同组件层级间传递，比如父子组件之间、爷孙组件之间，还可以在应用全局范围内传递或跨设备传递。另外，从数据的传递形式来看，可分为只读的单向传递和可变更的双向传递。开发者可以灵活地利用这些能力来实现数据和UI的联动。</li><li>渲染控制：ArkTS提供了渲染控制的能力。条件渲染可根据应用的不同状态，渲染对应状态下的UI内容。循环渲染可从数据源中迭代获取数据，并在每次迭代过程中创建相应的组件。数据懒加载从数据源中按需迭代数据，并在每次迭代过程中创建相应的组件。</li></ul><p>未来，ArkTS会结合应用开发/运行的需求持续演进，逐步提供并行和并发能力增强、系统类型增强、分布式开发范式等更多特性。</p><h3 id=基本语法>基本语法<a hidden class=anchor aria-hidden=true href=#基本语法>#</a></h3><h4 id=arkts-基本组成>ArkTS 基本组成<a hidden class=anchor aria-hidden=true href=#arkts-基本组成>#</a></h4><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404181345776.png><img src=https://qiniu.waite.wang/202404181345776.png alt></a></div></p><p><div class=post-img-view><a data-fancybox=gallery href=https://qiniu.waite.wang/202404181347607.png><img src=https://qiniu.waite.wang/202404181347607.png alt></a></div></p><blockquote><p>自定义变量不能与基础通用属性/事件名重复。</p></blockquote><ul><li>装饰器： 用于装饰类、结构、方法以及变量，并赋予其特殊的含义。如上述示例中@Entry、@Component和@State都是装饰器，@Component表示自定义组件，@Entry表示该自定义组件为入口组件，@State表示组件中的状态变量，状态变量变化会触发UI刷新。</li><li>UI描述：以声明式的方式来描述UI的结构，例如build()方法中的代码块。</li><li>自定义组件：可复用的UI单元，可组合其他组件，如上述被@Component装饰的struct Hello。</li><li>系统组件：ArkUI框架中默认内置的基础和容器组件，可直接被开发者调用，比如示例中的Column、Text、Divider、Button。</li><li>属性方法：组件可以通过链式调用配置多项属性，如fontSize()、width()、height()、backgroundColor()等。</li><li>事件方法：组件可以通过链式调用设置多个事件的响应逻辑，如跟随在Button后面的onClick()。</li><li>系统组件、属性方法、事件方法具体使用可参考基于ArkTS的声明式开发范式。</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://waite.wang/tags/harmony/>Harmony</a></li></ul><nav class=paginav><a class=prev href=https://waite.wang/posts/harmony/learn-harmony-2/><span class=title>« 上一页</span><br><span>鸿蒙学习笔记2</span>
</a><a class=next href=https://waite.wang/posts/mini-program/learn-uniapp-1/><span class=title>下一页 »</span><br><span>UniApp 入门</span></a></nav></footer><script src=https://utteranc.es/client.js repo=Waite0603/HugoBlog issue-term=pathname theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span><a href=https://beian.miit.gov.cn/ target=_blank rel="noopener noreferrer">粤 ICP 备 2022028437 号</a></span><br><span>Copyright &copy; 2018 - 2025 By <a href=https://waite.wang/>Waite</a>, All Rights
Reserved.</span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script src=/js/jquery-3.5.1.min.js></script><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery.fancybox.min.js></script></body></html>